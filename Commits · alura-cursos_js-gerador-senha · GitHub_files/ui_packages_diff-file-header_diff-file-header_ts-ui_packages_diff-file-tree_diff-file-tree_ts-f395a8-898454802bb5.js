"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_diff-file-header_diff-file-header_ts-ui_packages_diff-file-tree_diff-file-tree_ts-f395a8"],{40578:(e,t,n)=>{let i;function r(){if(!i)throw Error("Client env was requested before it was loaded. This likely means you are attempting to use client env at the module level in SSR, which is not supported. Please move your client env usage into a function.");return i}function a(){return i?.locale??"en-US"}n.d(t,{Kd:()=>a,dU:()=>r}),function(){if("undefined"!=typeof document){let e=document.getElementById("client-env");if(e)try{i=JSON.parse(e.textContent||"")}catch(e){console.error("Error parsing client-env",e)}}}()},8152:(e,t,n)=>{n.d(t,{J:()=>r});var i=n(12008);function r(){return(0,i.M)()}},24167:(e,t,n)=>{n.d(t,{Q:()=>i});function i(e){return e.slice(0,7)}},34996:(e,t,n)=>{n.d(t,{Rm:()=>O,hA:()=>b,dc:()=>y,sR:()=>eO,Kg:()=>eE,sf:()=>eC,VM:()=>eP,am:()=>eI,uN:()=>m});var i=n(85893),r=n(87250),a=n(42483),l=n(67294),s=n(56363);let{getItem:o,removeItem:d,setItem:c}=(0,s._)("localStorage"),u=(e,t)=>{let{diffSide:n,filePath:i,line:r,subjectId:a}=e;if(t)return`PullRequest:${a}-File:${i}`;if(void 0!==r&&void 0!==n)return`PullRequest:${a}-File:${i}-Line:${r}-DiffSide:${n}`;throw Error("Cannot build diff line comment cache key for a comment without a line number or diff side")};function m({diffSide:e,filePath:t,handlePersistedCommentExists:n,line:i,subjectId:r,threadId:a,fileLevelComment:s}){let m,f;let h=(0,l.useMemo)(()=>a||(a??u({diffSide:e,filePath:t,line:i,subjectId:r},s)),[e,t,i,r,a,s]),{hasPersistedComment:g,removePersistedCommentFromStorage:p}=(m=o(h),f=!!m?.text?.trim(),(0,l.useEffect)(()=>{f&&n?.(m)},[f]),{hasPersistedComment:f,removePersistedCommentFromStorage:()=>{d(h),f=!1,m=null}});return{hasPersistedComment:g,persistCommentToStorage:e=>{let t={text:e.text};e.startLine&&e.startSide&&(t={...t,startLine:e.startLine,startSide:e.startSide}),c(h,t)},removePersistedCommentFromStorage:p}}function f(e,t){let n=function e(t,n=[]){if(""===t)return n;let i=t.match(h());if(!i)return n;let r=i.groups.fence;if(!r)return n;let a=r.includes("~")?"~":"`",l=t.match(function(e,t){let n=h([e],t);return RegExp(`${n.source}(?:\r?
)(?<suggestion>.*?)(?:\r?
)^ {0,3}${e}{${t},}[ 	]*$`,"ms")}(a,r.length));if(!l)return n;let s=0,o=i.groups.indent;""!==o&&(s=o.length);let d=l.groups.suggestion;if(s>0){let e=RegExp(`^ {0,${s}}`,"m");d=d.replace(e,"")}n.push(d);let c=t.slice(l.index+l[0].length);return e(c,n)}(e);for(let e of n)if(e===t)return{isValid:!1,errorMessage:"Suggested change cannot be the same as the original line"};return{isValid:!0,errorMessage:""}}function h(e=["`","~"],t){let n=t?`{${t}}`:"{3,}",i=e.map(e=>`${e}${n}`);return RegExp(`^(?<indent> {0,3})(?<fence>${i.join("|")})suggestion[ 	]*$`,"m")}var g=n(5833);let p=(0,l.createContext)(null),x=()=>(0,l.useContext)(p),y=p.Provider;try{p.displayName||(p.displayName="ConversationMarkdownSubjectContext")}catch{}let b=(0,l.forwardRef)(({children:e,...t},n)=>{let r=x();return(0,i.jsx)(g.q,{...t,ref:n,placeholder:"Leave a comment",actions:e,subject:r??void 0,showLabel:!1})});function C({batchPending:e,batchingEnabled:t,commentBoxConfig:n,condensed:s,fileLevelComment:o,filePath:d,focusOnMount:c,isReplying:u,lineNumber:h,onAddComment:g,onCancelComment:p,onPersistedCommentExists:x,side:y,subjectId:C,threadId:j,suggestedChangesConfig:N}){let[v,S]=(0,l.useState)(""),[L,k]=(0,l.useState)(!1),[w,I]=(0,l.useState)(),E=(0,l.useRef)(null),{persistCommentToStorage:D,removePersistedCommentFromStorage:T}=m({diffSide:y,filePath:d,line:h,subjectId:C,threadId:j,handlePersistedCommentExists:({text:e})=>{e&&(S(e),x?.())},fileLevelComment:!!o});(0,l.useEffect)(()=>{c&&setTimeout(()=>E.current?.focus(),100)},[c]);let R=({submitBatch:e})=>{k(!0),I(void 0);let t=f(v,N?.sourceContentFromDiffLines??"");if(!t.isValid){I(t.errorMessage),k(!1);return}g?.({commentText:v,onCompleted(){k(!1),_()},onError(e){k(!1);let t="Failed to save comment";e.message&&(t=`${t}: ${e.message}`),I(t)},submitBatch:e})},O=()=>R({submitBatch:!1}),A=()=>R({submitBatch:!0}),_=()=>{T(),S(""),p?.()},F={footer:{justifyContent:u?"end":"space-between","> div:first-child":{display:s||u?"none":"flex"},...s&&{"> div:last-child":{display:"flex",flexDirection:"column",width:"100%"}}}};return(0,i.jsx)(a.Z,{sx:{display:"flex",flexDirection:"column",fieldset:{minWidth:0,width:["100%"]}},children:(0,i.jsxs)(b,{ref:E,label:"Add diff comment",sx:F,value:v,onChange:e=>{I(void 0),D({text:e}),S(e)},onPrimaryAction:t?O:A,userSettings:n,suggestedChangesConfig:N,markdownErrorMessage:w,children:[p&&(0,i.jsx)(r.n,{disabled:L,sx:{py:1,px:2},variant:"default",onClick:_,children:"Cancel"}),!e&&(0,i.jsx)(r.n,{disabled:L||!v.length,sx:{py:1,px:2},variant:t?"default":"primary",onClick:A,children:u?"Reply":"Add comment"}),t&&(0,i.jsx)(r.n,{disabled:L||!v.length,sx:{py:1,px:2},variant:"primary",onClick:O,children:e?"Add review comment":"Start a review"})]})})}b.displayName="ConversationCommentBox";try{C.displayName||(C.displayName="AddCommentEditor")}catch{}var j=n(59434),N=n(44459),v=n(48542),S=n(17840),L=n(74121),k=n(9770),w=n(51526),I=n(17791),E=n(59148);function D({children:e,footerButtons:t}){let{containerRef:n}=(0,S.v)({bindKeys:v.Qw.ArrowHorizontal|v.Qw.Tab,focusInStrategy:"closest"});return t?(0,i.jsx)(E.V.Footer,{ref:n,children:(0,i.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"column"},children:[(0,i.jsx)(a.Z,{sx:{display:"flex",flexDirection:"row",gap:2,justifyContent:"flex-end"},children:(0,i.jsx)(E.V.Buttons,{buttons:t})}),e]})}):null}let T={CHANGE_COMMIT_MESSAGE:"CHANGE_COMMIT_MESSAGE",CHANGE_EXTENDED_DESCRIPTION:"CHANGE_EXTENDED_DESCRIPTION"};function R(e,t){switch(t.type){case T.CHANGE_COMMIT_MESSAGE:return{...e,commitMessage:t.payload};case T.CHANGE_EXTENDED_DESCRIPTION:return{...e,extendedDescription:t.payload};default:return console.error("Unknown suggested change action."),e}}function O({authorLogins:e,batchSize:t,onClose:n,onCommit:r}){let s=(0,N.Z)(),{sendAnalyticsEvent:o}=(0,j.z)(),[d,c]=(0,l.useState)(!1),[u,m]=(0,l.useState)(),[f,h]=(0,l.useReducer)(R,{commitMessage:1===e.length?`Apply suggestion from @${e[0]}`:1===new Set(e).size?`Apply suggestions from @${e[0]}`:"Apply suggestions from code review",extendedDescription:""}),g=(0,l.useCallback)((e,t,n)=>{if(!s())return;let i="There was an error trying to commit changes";n?i+=`: ${n}`:i+=".",c(!1),m(i)},[s]),p=(0,l.useCallback)(()=>{s()&&(c(!1),u&&m(void 0))},[u,s]),x=(0,l.useCallback)(()=>{d||(c(!0),o("comments.commit_suggestion","COMMIT_SUGGESTION_DIALOG_BUTTON",{batchSize:t}),r(`${f.commitMessage}

${f.extendedDescription}`,g,p))},[t,f.commitMessage,f.extendedDescription,p,g,d,r,o]);return(0,i.jsxs)(E.V,{title:"Apply suggestion",renderFooter:()=>(0,i.jsx)(D,{footerButtons:[{content:"Cancel",onClick:n},{content:(0,i.jsxs)(a.Z,{as:"span",sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:["Commit changes",d&&(0,i.jsx)(L.Z,{size:"small",sx:{ml:1}})]}),onClick:x,buttonType:"primary"}],children:u&&(0,i.jsx)(k.Z.Validation,{sx:{mt:2,pt:1,justifyContent:"flex-end"},variant:"error",children:u})}),onClose:n,children:[(0,i.jsxs)(k.Z,{sx:{mb:2},children:[(0,i.jsx)(k.Z.Label,{children:"Commit message"}),(0,i.jsx)(w.Z,{block:!0,name:"commit_message",onChange:e=>h({type:T.CHANGE_COMMIT_MESSAGE,payload:e.target.value}),value:f.commitMessage})]}),(0,i.jsxs)(k.Z,{children:[(0,i.jsx)(k.Z.Label,{children:"Extended description (optional)"}),(0,i.jsx)(I.ZP,{block:!0,rows:3,placeholder:"Add an optional description...",onChange:e=>h({type:T.CHANGE_EXTENDED_DESCRIPTION,payload:e.target.value}),value:f.extendedDescription})]})]})}try{D.displayName||(D.displayName="DialogFooter")}catch{}try{O.displayName||(O.displayName="ApplySuggestionDialog")}catch{}var A=n(32458),_=n(2708);let F=(0,l.createContext)({});function P({children:e}){let[t,n]=(0,l.useState)(!1),r=(0,l.useMemo)(()=>({isDialogOpen:t,setIsDialogOpen:n}),[t,n]);return(0,i.jsx)(F.Provider,{value:r,children:e})}let M=()=>(0,l.useContext)(F);try{F.displayName||(F.displayName="DialogStateContext")}catch{}try{P.displayName||(P.displayName="DialogStateProvider")}catch{}var $=n(85529),B=n(50919),U=n(98399),Z=n(97011);function H({markerId:e,markers:t}){let n=t.findIndex(t=>t.id===e);return(0,i.jsxs)(Z.Z,{sx:{color:"fg.muted"},children:[(0,i.jsx)(Z.Z,{sx:{fontWeight:500,color:"fg.default"},children:n+1})," of"," ",(0,i.jsx)(Z.Z,{sx:{fontWeight:500,color:"fg.default"},children:t.length})]})}function V({markerId:e,markerNavigationImplementation:t,onNavigate:n}){let{incrementActiveMarker:r,decrementActiveMarker:l,filteredMarkers:s}=t,o=s.find(t=>t.id===e)&&s.length>1;return o?(0,i.jsxs)(a.Z,{sx:{pr:1,display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,i.jsx)(B.h,{"aria-label":"Load previous marker",icon:$.ChevronLeftIcon,variant:"invisible",onClick:()=>{l(e),n()}}),(0,i.jsx)(B.h,{"aria-label":"Load next marker",icon:$.ChevronRightIcon,variant:"invisible",onClick:()=>{r(e),n()}}),(0,i.jsx)(a.Z,{sx:{ml:1},children:(0,i.jsx)(H,{markerId:e,markers:s})})]}):null}try{H.displayName||(H.displayName="MarkerPosition")}catch{}try{V.displayName||(V.displayName="GlobalMarkerNavigation")}catch{}function G({annotation:e,markerNavigationImplementation:t,onClose:n,ghostUser:r}){return(0,i.jsxs)(a.Z,{sx:{width:"clamp(240px, 100vw, 540px)"},children:[(0,i.jsx)(a.Z,{sx:{borderBottom:"1px solid",borderBottomColor:"border.default",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",p:1,background:"canvas.default"},children:(0,i.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"row",width:"100%",alignItems:"center"},children:[(0,i.jsx)(V,{markerId:e.id,markerNavigationImplementation:t,onNavigate:n}),(0,i.jsx)(a.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center",justifyContent:"right",flexGrow:1},children:(0,i.jsx)(B.h,{"aria-label":"Close annotation",icon:$.XIcon,variant:"invisible",onClick:n})})]})}),(0,i.jsx)(U.q,{annotation:e,ghostUser:r})]})}try{G.displayName||(G.displayName="AnnotationDialog")}catch{}var K=n(12159),z=n(79804),q=n(45677),W=n(14786),Q=n(98833),X=n(26004);function J({anchorRef:e,annotations:t,handleOpenChange:n,threads:r,onShowAnnotation:l,onShowCommentThread:s,ghostUser:o=K.H.ghostUser}){function d(e){return{display:"-webkit-box",overflow:"hidden","-webkit-box-orient":"vertical","-webkit-line-clamp":e.toString(),maxWidth:"unset"}}return(0,i.jsx)(q.P,{anchorRef:e,open:!0,onOpenChange:n,children:(0,i.jsx)(q.P.Overlay,{width:"small",children:(0,i.jsx)("div",{children:(0,i.jsxs)(W.S,{children:[t.map(e=>(0,i.jsxs)(W.S.Item,{onSelect:()=>l(e.id),children:[(0,i.jsx)(W.S.LeadingVisual,{sx:{mr:2},children:(0,i.jsx)(X.rD,{annotationLevel:e.annotationLevel},e.id)}),(0,i.jsxs)(a.Z,{sx:{...d(2)},children:[e.checkSuite.name," /"," ",(0,i.jsx)(Z.Z,{sx:{fontWeight:400,color:"fg.muted"},children:e.checkRun.name})]}),(0,i.jsx)(W.S.Description,{variant:"block",children:(0,i.jsx)(a.Z,{sx:{...d(1)},children:e.title})}),(0,i.jsx)(W.S.TrailingVisual,{children:(0,i.jsx)(Q.Z,{icon:$.ArrowRightIcon})})]},e.id)),r.map(e=>(0,i.jsxs)(W.S.Item,{onSelect:()=>s(e.id),children:[(0,i.jsx)(W.S.LeadingVisual,{sx:{mr:2},children:(0,i.jsx)(z.O,{alt:e.author.login,size:20,src:e.author.avatarUrl??o.avatarUrl})}),"Thread by ",e.author.login,(0,i.jsxs)(W.S.Description,{variant:"block",children:[e.commentCount," comment",e.commentCount>1?"s":""]}),(0,i.jsx)(W.S.TrailingVisual,{children:(0,i.jsx)(Q.Z,{icon:$.ArrowRightIcon})})]},e.id))]})})})})}try{J.displayName||(J.displayName="MarkersListActionMenu")}catch{}var Y=n(88049),ee=n(63309),et=n(41436);let en=({onClick:e,id:t,children:n})=>(0,i.jsx)(a.Z,{as:"button",type:"button",id:t,sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"left",fontWeight:400,color:"fg.muted",width:"100%",backgroundColor:"canvas.default",border:"1px solid",borderColor:"border.default",cursor:"text",borderRadius:2,height:"var(--control-medium-size)",lineHeight:"var(--text-body-lineHeight-medium)",px:2},onClick:e,children:n});try{en.displayName||(en.displayName="CompactCommentButton")}catch{}function ei(e,t="r"){history.replaceState(null,"",`#${t}${e}`)}var er=n(79295),ea=n(50156),el=n(94470),es=n(75299),eo=n(71207),ed=n(63451),ec=n(73935),eu=n(88216);function em({commentingImplementation:e,suggestedChange:t}){let{sendAnalyticsEvent:n}=(0,j.z)();return(0,i.jsx)(a.Z,{sx:{display:"flex",flexDirection:"row-reverse"},children:(0,i.jsx)(eu.r,{variant:"primary",onClick:()=>{n("comments.add_suggested_change_to_batch","ADD_SUGGESTED_CHANGE_TO_BATCH_BUTTON"),e.addSuggestedChangeToPendingBatch(t)},children:"Add suggestion to batch"})})}try{em.displayName||(em.displayName="AddToExistingBatch")}catch{}var ef=n(33831);let eh={addSuggestionToBatch:{text:"Add suggestion to batch"},applySuggestion:{text:"Apply suggestion"}};function eg({commentingImplementation:e,onOpenDialog:t,suggestedChange:n}){let{sendAnalyticsEvent:r}=(0,j.z)(),[s,o]=(0,l.useState)(eh.addSuggestionToBatch),[d,c]=(0,l.useState)(!1),u=(0,l.useRef)(null),m=(0,l.useRef)(null),f=()=>c(!d),{addSuggestedChangeToPendingBatch:h}=e,g=(0,l.useCallback)(()=>{s===eh.addSuggestionToBatch&&(h(n),r("comments.add_suggested_change_to_batch","ADD_SUGGESTED_CHANGE_TO_BATCH_BUTTON")),s===eh.applySuggestion&&t(m)},[h,t,s,r,n]);return(0,i.jsx)(a.Z,{sx:{display:"flex",flexDirection:"row-reverse"},children:(0,i.jsxs)(ef.Z,{children:[(0,i.jsx)(eu.r,{variant:"primary",onClick:g,ref:m,children:s.text}),(0,i.jsx)(B.h,{ref:u,"aria-haspopup":"true","aria-label":"More suggestion batching options",icon:$.TriangleDownIcon,size:"medium",variant:"primary",onClick:f}),(0,i.jsx)(q.P,{anchorRef:u,open:d,onOpenChange:f,children:(0,i.jsx)(q.P.Overlay,{width:"medium",children:(0,i.jsx)(W.S,{selectionVariant:"single",children:Object.keys(eh).map(e=>{let t=eh[e];return(0,i.jsx)(W.S.Item,{selected:s===t,onSelect:()=>o(t),children:t.text},e)})})})})]})})}try{eg.displayName||(eg.displayName="ApplyOrAddToBatch")}catch{}function ep({reason:e,sx:t}){return(0,i.jsx)(a.Z,{sx:{m:2,...t},children:(0,i.jsx)(Z.Z,{as:"small",sx:{color:"fg.muted"},children:e})})}try{ep.displayName||(ep.displayName="CodeSuggestionUnavailable")}catch{}function ex({commentingImplementation:e,onOpenDialog:t,suggestedChange:n}){let r=(0,l.useRef)(null),s=(0,l.useCallback)(()=>{t(r)},[t]),o=e.pendingSuggestedChangesBatch.length,{sendAnalyticsEvent:d}=(0,j.z)();return(0,i.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"space-between",flexDirection:"row"},children:[(0,i.jsx)(ee.Z,{variant:"attention",sx:{my:"auto"},children:"Pending in batch"}),(0,i.jsxs)(a.Z,{sx:{display:"flex",gap:2},children:[(0,i.jsx)(eu.r,{size:"medium",variant:"danger",onClick:()=>{e.removeSuggestedChangeFromPendingBatch(n),d("comments.remove_suggested_change_from_batch","REMOVE_SUGGESTED_CHANGE_FROM_BATCH_BUTTON")},children:"Remove from batch"}),(0,i.jsx)(eu.r,{ref:r,size:"medium",count:o,variant:"primary",onClick:s,children:`Apply suggestion${o>1?"s":""}`})]})]})}try{ex.displayName||(ex.displayName="CommitOrRemoveFromBatch")}catch{}function ey({commentingImplementation:e,suggestedChange:t}){let{setIsDialogOpen:n}=M(),[r,s]=(0,l.useState)(!1),o=(0,l.useRef)(),{pendingSuggestedChangesBatch:d,submitSuggestedChanges:c}=e,u=(0,er.MM)(t,d),m=0===d.length,{isValid:f,reason:h}=(0,er.RN)(t,d),g=(0,l.useMemo)(()=>u?d:[t],[u,d,t]),p=(0,l.useCallback)(e=>{s(e),n?.(e)},[n]),x=(0,l.useCallback)(()=>{if(p(!1),o.current){let e=o.current.current;setTimeout(()=>e?.focus())}},[p]),y=(0,l.useCallback)(e=>{p(!0),o.current=e},[p,o]),b=(0,l.useCallback)((e,t,n)=>{c({suggestedChanges:g,commitMessage:e,onCompleted:()=>{x(),n()},onError:t})},[x,c,g]);return(0,i.jsxs)(a.Z,{sx:{p:2,borderTop:"1px solid",borderColor:"border.default"},children:[u&&(0,i.jsx)(ex,{commentingImplementation:e,suggestedChange:t,onOpenDialog:y}),!u&&!f&&h&&(0,i.jsx)(ep,{reason:h,sx:{m:0}}),!u&&m&&(0,i.jsx)(eg,{commentingImplementation:e,suggestedChange:t,onOpenDialog:y}),!u&&f&&!m&&(0,i.jsx)(em,{commentingImplementation:e,suggestedChange:t}),r&&(0,i.jsx)(O,{authorLogins:g.map(e=>e.authorLogin),batchSize:g.length,onClose:x,onCommit:b})]})}try{ey.displayName||(ey.displayName="CodeSuggestionActions")}catch{}function eb({applySuggestedChangesValidationData:e,comment:t,commentBodyRef:n,commentingImplementation:r,filePath:a,isOutdated:s,isThreadResolved:o,subject:d,suggestedChangesConfig:c,threadId:u,viewerData:m}){let f=function(e,t,n,i,r){let[a,s]=(0,l.useState)();return(0,ed.b)(()=>{if(!e.current||"LINE"!==t.subjectType)return;let a=[...e.current.getElementsByClassName("js-apply-changes")];if(a.length>0){let e=[];for(let l of a){let a=l?.closest("div.js-suggested-changes-blob");if(!a)continue;let s=[...a.querySelectorAll(".js-blob-code-addition")];r.lineRange&&e.push({authorLogin:t.author?.login??"ghost",commentId:t.id,path:n,ref:l,suggestion:s.map(e=>e.textContent),lineRange:r.lineRange,threadId:i})}s(e)}},[r.lineRange,t.author?.login,t.bodyHTML,t.id,t.subjectType,e,n,i]),a}(n,t,a,u,e);return(0,i.jsx)(i.Fragment,{children:f?.length&&f.map(n=>{let{isValid:a,reason:l}=(0,er.eE)({suggestedChange:n,isOutdated:s,isPending:"PENDING"===t.state,isResolved:o,pullRequestIsClosed:d?.state!=="OPEN",pullRequestIsInMergeQueue:!!d?.isInMergeQueue,userCanApplySuggestion:!!m?.viewerCanApplySuggestion,applySuggestedChangesValidationData:e,suggestedChangesConfig:c});return!a&&l?(0,ec.createPortal)((0,i.jsx)(ep,{reason:l}),n.ref):(0,ec.createPortal)((0,i.jsx)(ey,{commentingImplementation:r,suggestedChange:n}),n.ref)})})}try{eb.displayName||(eb.displayName="SuggestedChangeView")}catch{}function eC({isAnchorable:e=!1,index:t=0,isLastChild:n,isOutdated:r,isThreadResolved:s,anchorPrefix:o="r",comment:d,commentingImplementation:c,filePath:u,hideActions:h,onRefreshThread:p,subjectId:x,subject:y,threadCommentCount:C,threadId:j,threadsConnectionId:N,suggestedChangesConfig:v,applySuggestedChangesValidationData:S,viewerData:L,ghostUser:k=K.H.ghostUser}){let{addToast:w}=(0,Y.V6)(),[I,E]=(0,l.useState)(!1),[D,T]=(0,l.useState)(d.body),[R,O]=(0,l.useState)(!1),[_,F]=(0,l.useState)(),{persistCommentToStorage:P,removePersistedCommentFromStorage:M}=m({subjectId:x,filePath:u,fileLevelComment:"FILE"===d.subjectType,threadId:d.id,handlePersistedCommentExists:({text:e})=>{e&&T(e)}}),{editComment:$,deleteComment:B}=c,U=(0,l.useRef)(null),Z=(0,l.useRef)(null),H=()=>{U.current?.focus()};(0,l.useEffect)(()=>{I&&setTimeout(H)},[I]);let V=(0,l.useCallback)(()=>{O(!0);let e=f(D,v?.sourceContentFromDiffLines??"");if(!e.isValid){F(e.errorMessage),O(!1);return}$({text:D,comment:d,onCompleted:()=>{E(!1),O(!1),M(),p?.(j)},onError:()=>{O(!1),w({type:"error",message:"Failed to update comment"})}})},[w,D,d,$,p,M,v,j]),G=d.currentDiffResourcePath?.split("#r").pop(),z=G?`${o}${G}`:void 0,q=z&&eo.ssrSafeLocation?new URL(`${eo.ssrSafeLocation.pathname}#${z}`,eo.ssrSafeLocation.origin).toString():void 0,W=(0,l.useRef)(null);(0,l.useEffect)(()=>{e&&G&&z&&window.location.hash.split("#").pop()===z&&(ei(G,o),W.current?.focus())},[o,z,G,e]);let Q={outline:"2px solid",outlineColor:"accent.fg",outlineOffset:"-2px",boxShadow:"none"},X=t>0,J=t>1,ee=c.suggestedChangesEnabled;return(0,i.jsxs)(a.Z,{ref:W,id:e?z:void 0,tabIndex:-1,sx:{"&:not(:first-child)":{backgroundColor:"canvas.inset"},"&:first-child + div":{borderTop:"1px solid",borderColor:"border.muted"},":target":Q,":focus":Q,pb:X?0:2},children:[J&&(0,i.jsx)(a.Z,{sx:{display:"flex",pl:X?1:0},children:(0,i.jsx)(a.Z,{sx:{ml:4,height:8,borderLeft:"1px solid",borderColor:"border.default"}})}),(0,i.jsx)(a.Z,{sx:{px:3,pt:J?0:2,pb:0},children:(0,i.jsx)(ea.y,{headingProps:{as:"h5"},avatarUrl:d.author?.avatarUrl??k.avatarUrl,comment:{...d,url:q??""},commentRef:W,deleteComment:()=>{B({commentId:d.id,onCompleted:()=>{p?.(j)},onError:()=>{O(!1),w({type:"error",message:"Failed to delete comment"})},threadCommentCount:C,threadId:j,threadsConnectionId:N,filePath:u})},editComment:()=>{E(!0)},hideComment:A.Z,isMinimized:d.isHidden,commentAuthorLogin:d.author?.login??k.login,navigate:A.Z,commentSubjectAuthorLogin:d.reference?.author?.login??"",onReplySelect:A.Z,unhideComment:A.Z,hideActions:h,isReply:!0})}),(0,i.jsxs)(a.Z,{sx:{display:"flex",pl:X?1:0},children:[X&&(0,i.jsx)(a.Z,{sx:{ml:4,mr:1,pl:3,borderLeft:"1px solid",borderColor:"border.default",...n&&{borderImage:"linear-gradient(to bottom, var(--borderColor-default, var(--color-border-default)), rgba(0, 0, 0, 0)) 1 100%"}}}),I?(0,i.jsx)(a.Z,{sx:{pr:2,pl:X?0:2,pb:2,pt:1,flexGrow:1},children:(0,i.jsxs)(b,{ref:U,label:"Update comment",value:D,onChange:e=>{P({text:e}),T(e),F(void 0)},onPrimaryAction:V,userSettings:c.commentBoxConfig,suggestedChangesConfig:v,markdownErrorMessage:_,children:[(0,i.jsx)(g.n,{variant:"default",onClick:()=>{E(!1),M(),T(d.body)},children:"Cancel"}),(0,i.jsx)(g.n,{disabled:R||!D.length,variant:"primary",onClick:V,children:"Update"})]})}):(0,i.jsx)(a.Z,{sx:X?{pb:2,pr:2,overflowX:"auto",width:"100%"}:{px:3,pb:2,width:"100%"},children:d.bodyHTML&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(es.wB,{ref:Z,className:"markdown-body","comment-testid":`Comment body html for comment ${d.id}`,html:d.bodyHTML,sx:{mt:1,fontSize:1}}),(0,i.jsx)(a.Z,{sx:{display:"flex",flexDirection:"column",mt:3},children:(0,i.jsx)(el.ReactionViewer,{reactionGroups:d,subjectId:d.id})}),ee&&S&&(0,i.jsx)(eb,{comment:d,commentBodyRef:Z,commentingImplementation:c,filePath:u,isOutdated:r,isThreadResolved:s,threadId:j,suggestedChangesConfig:v,applySuggestedChangesValidationData:S,subject:y,viewerData:L})]})})]})]})}try{eC.displayName||(eC.displayName="ReviewThreadComment")}catch{}var ej=n(46455),eN=n(6975),ev=n(86010);function eS({line:e,children:t}){return(0,i.jsx)("td",{className:"diff-line-number",style:{backgroundColor:(0,ej.dF)(e.type,!0),textAlign:"center"},children:(0,i.jsx)("code",{children:t})})}function eL({line:e}){return(0,i.jsx)("td",{colSpan:4,style:{backgroundColor:"var(--bgColor-accent-muted, var(--color-accent-subtle))",flexGrow:1},valign:"top",children:(0,i.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"row"},children:[(0,i.jsx)(eN.fx,{}),(0,i.jsx)("code",{className:"diff-text-cell hunk",children:(0,i.jsx)(es.sF,{className:"diff-text-inner color-fg-muted",html:e.html})})]})})}function ek({line:e,tabSize:t}){let n="HUNK"===e.type,r="ADDITION"!==e.type,a="DELETION"!==e.type,{getTextIndent:s,getPaddingLeft:o}=(0,l.useMemo)(()=>(0,eN.pE)(e.text,t),[e,t]),d="ADDITION"===e.type?"+":"DELETION"===e.type?"-":void 0;return(0,i.jsxs)("tr",{children:[n&&(0,i.jsx)(eL,{line:e}),!n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eS,{line:e,children:r&&e.left}),(0,i.jsx)(eS,{line:e,children:a&&e.right}),(0,i.jsx)("td",{className:"diff-text-cell",style:{backgroundColor:(0,ej.dF)(e.type,!1)},children:(0,i.jsxs)("code",{className:(0,ev.W)("diff-text syntax-highlighted-line",{addition:"ADDITION"===e.type,deletion:"DELETION"===e.type}),children:[!!d&&(0,i.jsx)("span",{className:"diff-text-marker",children:d}),(0,i.jsx)(es.sF,{className:"diff-text-inner",html:e.html,style:{backgroundColor:(0,ej.dF)(e.type,!1),paddingLeft:o(),textIndent:s()}})]})})]})]})}function ew({sx:e,lines:t,lineWidth:n,tabSize:r}){let l=t.map((e,t)=>(0,i.jsx)(ek,{line:e,tabSize:r},t));return(0,i.jsx)(a.Z,{as:"table",className:"tab-size","data-tab-size":r,sx:{borderTop:0,borderBottom:0,borderLeft:1,borderRight:1,borderStyle:"solid",borderColor:"border.muted",...e},children:(0,i.jsx)(eN.wj,{lineWidth:n,children:l})})}function eI({sx:e,tabSize:t,thread:n,hideHeaderDetails:r,diffTableSx:l}){if(!n.subject?.diffLines||n.subject?.diffLines.length<1)return null;let s=(0,ej.Gi)(n.subject.diffLines);return(0,i.jsxs)(a.Z,{sx:{m:3,border:0,borderBottomWidth:6,borderStyle:"solid",borderColor:"border.muted",borderBottomLeftRadius:2,borderBottomRightRadius:2,...e},children:[!r&&(0,i.jsx)(a.Z,{sx:{borderWidth:1,borderStyle:"solid",borderTopLeftRadius:2,borderTopRightRadius:2,borderColor:"border.muted",color:"fg.muted",px:2,py:1},children:(0,i.jsxs)(Z.Z,{sx:{fontSize:0,color:"fg.muted"},children:["Line"," ",(0,eN._2)({originalStartLine:n.subject.originalStartLine,originalEndLine:n.subject.originalEndLine,startDiffSide:n.subject.startDiffSide,endDiffSide:n.subject.endDiffSide}),", commit ",(0,i.jsx)("code",{children:n.subject.pullRequestCommit?.commit.abbreviatedOid})]})}),(0,i.jsx)(ew,{lineWidth:s,lines:n.subject.diffLines,tabSize:t,sx:l})]})}try{eS.displayName||(eS.displayName="StaticLineNumberCell")}catch{}try{eL.displayName||(eL.displayName="StaticHunkCell")}catch{}try{ek.displayName||(ek.displayName="StaticUnifiedDiffRow")}catch{}try{ew.displayName||(ew.displayName="StaticUnifiedDiffLines")}catch{}try{eI.displayName||(eI.displayName="StaticUnifiedDiffPreview")}catch{}function eE({batchingEnabled:e,batchPending:t,commentAnchorPrefix:n,commentingImplementation:r,commentsConnectionId:s,filePath:o,hideDiffPreview:d,onRefreshThread:c,repositoryId:u,subject:m,subjectId:f,tabSize:h,thread:g,threadsConnectionId:p,shouldLimitHeight:x=!0,suggestedChangesConfig:y,viewerData:b,ghostUser:N}){let[v,S]=(0,l.useState)(!1),{sendAnalyticsEvent:L}=(0,j.z)(),{addThreadReply:k}=r;if(null===g.commentsData.comments||g.commentsData.comments.length<1)return null;let w=(0,er.aF)(g),I="LINE"===g.subjectType?{lineRange:w}:void 0;return(0,i.jsx)(a.Z,{"data-testid":"review-thread",children:(0,i.jsxs)(a.Z,{sx:x?{maxHeight:"40vh",overflowY:"auto"}:{},children:[!d&&g.isOutdated&&(0,i.jsx)(eI,{tabSize:h??4,thread:g}),g.commentsData.comments.map((e,t)=>(0,i.jsx)(eC,{isAnchorable:!0,index:t,isLastChild:t===g.commentsData.comments.length-1,anchorPrefix:n,comment:e,commentConnectionId:g.commentsData.__id,commentingImplementation:r,filePath:o,isOutdated:g.isOutdated,repositoryId:u,subject:m,subjectId:f,threadId:g.id,onRefreshThread:c,threadCommentCount:g.commentsData.comments.length,threadsConnectionId:p,isThreadResolved:!!g.isResolved,suggestedChangesConfig:y,applySuggestedChangesValidationData:I,viewerData:b,ghostUser:N},e.id)),g.viewerCanReply&&(0,i.jsxs)(a.Z,{sx:{backgroundColor:"canvas.inset",borderBottomLeftRadius:2,borderBottomRightRadius:2,p:2},children:[v&&(0,i.jsx)(C,{batchingEnabled:e,batchPending:t,commentBoxConfig:r.commentBoxConfig,condensed:!1,fileLevelComment:!0,filePath:o,focusOnMount:!0,isReplying:!0,onCancelComment:()=>{S(!1),L("comments.cancel_thread_reply","CANCEL_REVIEW_THREAD_BUTTON")},repositoryId:u,subjectId:f,threadId:g.id,onAddComment:({commentText:e,onCompleted:t,onError:n,submitBatch:i})=>{let r=[];g.commentsData.__id&&r.push(g.commentsData.__id),s&&r.push(s),k({commentsConnectionIds:r,filePath:o,thread:g,text:e,submitBatch:i,onCompleted:e=>{e&&ei(e.toString()),t?.(),c?.(g.id)},onError:n,threadsConnectionId:p}),L("comments.add","ADD_COMMENT_BUTTON")},suggestedChangesConfig:y}),!v&&(0,i.jsx)(en,{onClick:()=>{L("comments.start_thread_reply","REPLY_TO_THREAD_INPUT_BUTTON"),S(!0)},children:"Write a reply"})]})]})})}try{eE.displayName||(eE.displayName="ReviewThread")}catch{}function eD({children:e}){return(0,i.jsx)(Z.Z,{sx:{fontWeight:500,color:"fg.default"},children:e})}function eT({thread:e}){if(!e?.diffSide||!e.line||!e.startLine||!e.startDiffSide)return null;let t="LEFT"===e.startDiffSide?"L":"R",n="LEFT"===e.diffSide?"L":"R";return(0,i.jsxs)(Z.Z,{sx:{color:"fg.muted"},children:["\xb7 Comment on lines"," ",(0,i.jsxs)(eD,{children:[t,e.startLine]})," ","to"," ",(0,i.jsxs)(eD,{children:[n,e.line]})]})}function eR({commentingImplementation:e,filePath:t,onClose:n,onRefreshThread:r,thread:s,threads:o,threadsConnectionId:d,markerNavigationImplementation:c,ghostUser:u,...m}){let{sendAnalyticsEvent:f}=(0,j.z)(),{resolveThread:h,unresolveThread:g}=e,p=o.find(e=>e.id===s.id),x=s.commentsData.comments.length>0,y=!!s.isResolved,{addToast:b}=(0,Y.V6)(),C=p?.commentsConnectionId;return x?(0,i.jsxs)(a.Z,{sx:{width:"clamp(240px, 100vw, 540px)"},children:[(0,i.jsx)(a.Z,{sx:{borderBottom:"1px solid",borderBottomColor:"border.default",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",p:1,background:"canvas.default"},children:(0,i.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"row",width:"100%",alignItems:"center"},children:[(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V,{markerId:s.id,markerNavigationImplementation:c,onNavigate:n}),(0,i.jsx)(eT,{thread:p})]}),(0,i.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center",justifyContent:"right",flexGrow:1},children:[y&&(0,i.jsx)(ee.Z,{variant:"done",size:"large",children:"Resolved"}),(0,i.jsx)(et.u,{text:y?"Unresolve conversation":"Resolve conversation",type:"label",direction:"w",id:"resolve-conversation",children:(0,i.jsx)(B.h,{"aria-labelledby":"resolve-conversation",icon:y?$.CheckCircleFillIcon:$.CheckCircleIcon,sx:{color:y?"var(--fgColor-done, var(--color-done-fg)) !important":void 0},variant:"invisible",onClick:y?()=>{g({thread:s,onCompleted:()=>r(s.id),onError:()=>{b({type:"error",message:"Failed to unresolve thread"})}}),f("comments.unresolve_thread","RESOLVE_CONVERSATION_BUTTON")}:()=>{h({thread:s,onCompleted:()=>r(s.id),onError:()=>{b({type:"error",message:"Failed to resolve thread"})}}),f("comments.resolve_thread","RESOLVE_CONVERSATION_BUTTON")}})}),(0,i.jsx)(B.h,{"aria-label":"Close thread",icon:$.XIcon,variant:"invisible",onClick:n})]})]})}),(0,i.jsx)(l.Suspense,{fallback:(0,i.jsxs)(a.Z,{sx:{height:"90px",alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",color:"fg.muted",fontSize:0},children:[(0,i.jsx)(L.Z,{}),(0,i.jsx)("p",{children:"Loading comments"})]}),children:(0,i.jsx)(eE,{commentingImplementation:e,commentsConnectionId:C,filePath:t,onRefreshThread:r,thread:s,threadsConnectionId:d,...m,ghostUser:u})})]}):null}try{eD.displayName||(eD.displayName="Emphasis")}catch{}try{eT.displayName||(eT.displayName="MultineLineThreadBanner")}catch{}try{eR.displayName||(eR.displayName="ReviewThreadDialog")}catch{}function eO(e){return(0,i.jsx)(P,{children:(0,i.jsx)(eA,{...e})})}function eA({annotations:e,commentingImplementation:t,conversationAnchorRef:n,conversationListAnchorRef:r,conversationListThreads:s,isMarkerListOpen:o,fileAnchor:d,filePath:c,onAnnotationSelected:u,onCloseConversationDialog:m,onCloseConversationList:f,onThreadSelected:h,returnFocusRef:g,selectedAnnotationId:p,selectedThreadId:x,threadsConnectionId:y,markerNavigationImplementation:b,suggestedChangesConfig:C,ghostUser:j,...N}){let{isDialogOpen:v}=M(),[S,k]=(0,l.useState)(),{fetchThread:w}=t,I=(0,l.useCallback)(()=>!v&&m(),[v,m]),E=async e=>{k(void 0);let t=s.find(t=>t.id===e)?.isOutdated,n=await w(e,t);k(n)},D=(0,l.useMemo)(()=>{if(d&&S&&S.subject?.startDiffSide&&S.subject?.endDiffSide&&S.subject?.startLine&&S.subject?.endLine&&C?.configureSuggestedChangesFromLineRange){let e=S.subject?.startLine??S?.subject?.endLine,t=S.subject?.startDiffSide??S?.subject?.endDiffSide,n={diffAnchor:d,endLineNumber:S?.subject?.endLine,endOrientation:S.subject?.endDiffSide==="LEFT"?"left":"right",startLineNumber:e,firstSelectedLineNumber:e,firstSelectedOrientation:"LEFT"===t?"left":"right",startOrientation:"LEFT"===t?"left":"right"};return C?.configureSuggestedChangesFromLineRange(n)}},[d,S,C]);(0,l.useEffect)(()=>{!x&&S?k(void 0):x&&x!==S?.id&&E(x)},[w,x]);let T=x||p,R=p?e.find(e=>e.id===p):void 0;return(0,i.jsx)(i.Fragment,{children:T?(0,i.jsx)(_.w,{align:"end",anchorRef:n,focusZoneSettings:{disabled:!0},open:!0,focusTrapSettings:{disabled:!0},renderAnchor:null,overlayProps:{anchorSide:"outside-right","aria-label":`${x?"Pull Request Review Thread":"Pull Request Check Annotation"}`,id:"conversation-dialog",returnFocusRef:g,role:"dialog",sx:{width:"clamp(240px, 100vw, 540px)",borderRadius:2},onClickOutside:A.Z,onKeyDown:e=>{"Escape"!==e.key&&e.stopPropagation()}},onClose:I,children:S?(0,i.jsx)(eR,{commentingImplementation:t,filePath:c,thread:S,threads:s,threadsConnectionId:y,onClose:I,onThreadSelected:h,onRefreshThread:E,markerNavigationImplementation:b,suggestedChangesConfig:D,ghostUser:j,...N}):R?(0,i.jsx)(G,{annotation:R,markerNavigationImplementation:b,onClose:I,ghostUser:j}):(0,i.jsxs)(a.Z,{sx:{height:"90px",alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",color:"fg.muted",fontSize:0},children:[(0,i.jsx)(L.Z,{}),(0,i.jsx)("p",{children:"Loading comments"})]})}):o&&(0,i.jsx)(J,{anchorRef:r,annotations:e,handleOpenChange:f,threads:s,onShowCommentThread:h,onShowAnnotation:u,ghostUser:j})})}try{eO.displayName||(eO.displayName="Markers")}catch{}try{eA.displayName||(eA.displayName="MarkersInternal")}catch{}var e_=n(75308);function eF({addCommentDialogTitle:e,isLeftSide:t,filePath:n,lineNumber:r,onAddComment:l,onClose:s,viewerData:o,threadsConnectionId:d,...c}){return(0,i.jsxs)(a.Z,{sx:{px:2,pb:2,pt:1},children:[(0,i.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)(e_.Z,{as:"h4",sx:{fontSize:1,ml:2,py:2},children:[(0,i.jsx)(z.O,{alt:o.login,size:24,src:o.avatarUrl||"",sx:{mr:2}}),(0,i.jsx)(Z.Z,{children:e??"Add a comment"})]}),s&&(0,i.jsx)(B.h,{variant:"invisible",icon:$.XIcon,onClick:s,"aria-label":"Cancel"})]}),(0,i.jsx)(C,{focusOnMount:!0,condensed:!1,fileLevelComment:!1,filePath:n,lineNumber:r,onAddComment:({commentText:e,onCompleted:t,onError:i,submitBatch:r})=>{l({text:e,onError:i,onCompleted:(e,n)=>{n&&ei(n.toString()),t?.(e,n)},submitBatch:r,filePath:n,threadsConnectionId:d})},onCancelComment:s,side:t?"LEFT":"RIGHT",...c})]})}try{eF.displayName||(eF.displayName="StartThreadComment")}catch{}function eP({align:e="end",anchorRef:t,isOpen:n,returnFocusRef:r,onCloseCommentDialog:a,suggestedChangesConfig:s,...o}){let{sendAnalyticsEvent:d}=(0,j.z)(),c=(0,l.useMemo)(()=>{if(n&&s?.configureSuggestedChangesFromLineRange)return s.configureSuggestedChangesFromLineRange(s?.selectedDiffRowRange,s?.shouldStartNewConversationWithSuggestedChange)},[n,s]);return n?(0,i.jsx)(_.w,{align:e,anchorRef:t,focusZoneSettings:{disabled:!0},open:n,renderAnchor:null,focusTrapSettings:{disabled:!0},overlayProps:{id:"conversation-dialog",role:"dialog",width:"xlarge",returnFocusRef:r,sx:{borderRadius:2},"aria-label":"Add a comment",onClickOutside:A.Z,onKeyDown:e=>{"Escape"!==e.key&&e.stopPropagation()}},onClose:a,children:(0,i.jsx)(eF,{onClose:()=>{a(),d("comments.cancel_thread_reply","CANCEL_REVIEW_THREAD_BUTTON")},suggestedChangesConfig:c,...o})}):null}try{eP.displayName||(eP.displayName="StartConversation")}catch{}n(43360),A.Z,A.Z,A.Z,A.Z,A.Z,A.Z,A.Z,A.Z,A.Z,A.Z,A.Z,A.Z,A.Z},79295:(e,t,n)=>{function i(e,t){return t.some(t=>r(t,e))}function r(e,t){return e.commentId===t.commentId&&e.path===t.path&&e.suggestion.length===t.suggestion.length&&a(e.suggestion,t.suggestion)}n.d(t,{MM:()=>i,RN:()=>o,aF:()=>d,eE:()=>s,l3:()=>r});let a=(e,t)=>e.length===t.length&&!e.some((e,n)=>e!==t[n]),l={USER_CANNOT_APPLY_SUGGESTION:"You do not have permission to apply this suggestion.",PULL_REQUEST_IS_CLOSED:"This suggestion cannot be applied because the pull request is closed.",PULL_REQUEST_IS_IN_MERGE_QUEUE:"This suggestion cannot be applied because the pull request is queued to merge.",IS_OUTDATED:"This suggestion is outdated and cannot be applied.",IS_PENDING:"This suggestion is part of a pending comment and cannot be applied.",IS_RESOLVED:"This suggestion is part of a resolved comment and cannot be applied.",UNCHANGED_CODE:"This suggestion is invalid because no changes were made to the code.",INVALID_RANGE:"Unable to commit due to other pending changes affecting this line.",BATCH_TOO_BIG:"Unable to commit due to too many changes in the batch.",DELETED_LINES:"Unable to apply suggestions on deleted lines.",RANGE_NOT_PROVIDED:"This suggestion does not have a valid line range.",UNABLE_TO_DETERMINE_VALIDITY:"Unable to determine the validity of this suggestion."};function s({suggestedChange:e,isOutdated:t,isPending:n,isResolved:i,pullRequestIsClosed:r,pullRequestIsInMergeQueue:a,userCanApplySuggestion:s,applySuggestedChangesValidationData:o,suggestedChangesConfig:d}){let{lineRange:c}=o;if(t)return{isValid:!1,reason:l.IS_OUTDATED};if(n)return{isValid:!1,reason:l.IS_PENDING};if(i)return{isValid:!1,reason:l.IS_RESOLVED};if(r)return{isValid:!1,reason:l.PULL_REQUEST_IS_CLOSED};if(a)return{isValid:!1,reason:l.PULL_REQUEST_IS_IN_MERGE_QUEUE};if(!s)return{isValid:!1,reason:l.USER_CANNOT_APPLY_SUGGESTION};if(!c)return{isValid:!1,reason:l.RANGE_NOT_PROVIDED};if(!d)return{isValid:!1,reason:l.UNABLE_TO_DETERMINE_VALIDITY};let u=d?.isValidSuggestionRange;if(!u)return{isValid:!1,reason:l.DELETED_LINES};let m=d?.sourceContentFromDiffLines,f=e.suggestion.join("\n"),h=0===e.suggestion.length;return h||f!==m?{isValid:!0}:{isValid:!1,reason:l.UNCHANGED_CODE}}function o(e,t){let n={isValid:!1,reason:l.INVALID_RANGE},i={isValid:!1,reason:l.BATCH_TOO_BIG};return t.length>=50?i:t.find(t=>t.threadId===e.threadId)||function(e,t){for(let r of t)if(e.path===r.path){var n,i;return n=e.lineRange,i=r.lineRange,n.endLineNumber>=i.startLineNumber&&n.startLineNumber<=i.endLineNumber}return!1}(e,t)?n:{isValid:!0}}function d(e){if(!e||"LINE"!==e.subjectType||!e.subject)return;let t=e.subject.startDiffSide??e.subject.endDiffSide;if(!t)return;if(e.isOutdated&&e.subject.originalStartLine&&e.subject.originalEndLine)return{endLineNumber:e.subject.originalEndLine,endOrientation:e.subject.endDiffSide||"RIGHT",startLineNumber:e.subject.originalStartLine,startOrientation:t};if(!e.subject.endLine||!e.subject.endDiffSide)return;let n=e.subject.startLine??e?.subject.endLine;return{endLineNumber:e.subject.endLine,endOrientation:e.subject.endDiffSide,startLineNumber:n,startOrientation:t||"RIGHT"}}},43360:(e,t,n)=>{var i;n.d(t,{A:()=>i}),function(e){e.Failure="FAILURE",e.Notice="NOTICE",e.Warning="WARNING"}(i||(i={}))},54734:(e,t,n)=>{n.d(t,{B:()=>i});function i(){let e=document.querySelector('#__primerPortalRoot__ div[role="dialog"]');e&&document.dispatchEvent(new KeyboardEvent("keydown",{key:"Escape",code:"Escape",ctrlKey:!0}))}},27010:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let i=function(){var e=[{alias:null,args:null,kind:"ScalarField",name:"oid",storageKey:null},{alias:null,args:null,concreteType:"Repository",kind:"LinkedField",name:"repository",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"databaseId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"login",storageKey:null}],storageKey:null}],storageKey:null}];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useFileDiffReference_Comparison",selections:[{alias:null,args:null,concreteType:"Commit",kind:"LinkedField",name:"oldCommit",plural:!1,selections:e,storageKey:null},{alias:null,args:null,concreteType:"Commit",kind:"LinkedField",name:"newCommit",plural:!1,selections:e,storageKey:null}],type:"PullRequestComparison",abstractKey:null}}();i.hash="fb70959c69497160ff44b9b0c7820e08";let r=i},72558:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let i=function(){var e={alias:null,args:null,kind:"ScalarField",name:"path",storageKey:null},t=[e,{alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null}];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useFileDiffReference_DiffEntry",selections:[{alias:null,args:null,kind:"ScalarField",name:"pathDigest",storageKey:null},e,{alias:null,args:null,kind:"ScalarField",name:"rawUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isBinary",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isSubmodule",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isLfsPointer",storageKey:null},{alias:null,args:null,concreteType:"TreeEntry",kind:"LinkedField",name:"oldTreeEntry",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"TreeEntry",kind:"LinkedField",name:"newTreeEntry",plural:!1,selections:t,storageKey:null}],type:"PullRequestDiffEntry",abstractKey:null}}();i.hash="f853615ae640634aad832da060f944cf";let r=i},93212:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let i=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"prId"}],t=[{kind:"Variable",name:"id",variableName:"prId"}],n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r=[{alias:null,args:null,kind:"ScalarField",name:"oid",storageKey:null},{alias:null,args:null,concreteType:"Repository",kind:"LinkedField",name:"repository",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"databaseId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"login",storageKey:null},i],storageKey:null},i],storageKey:null},i];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"DiffChatWrapper_ComparisonQuery",selections:[{alias:"pullRequest",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PullRequestComparison",kind:"LinkedField",name:"comparison",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useFileDiffReference_Comparison"}],storageKey:null}],type:"PullRequest",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"DiffChatWrapper_ComparisonQuery",selections:[{alias:"pullRequest",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PullRequestComparison",kind:"LinkedField",name:"comparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Commit",kind:"LinkedField",name:"oldCommit",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"Commit",kind:"LinkedField",name:"newCommit",plural:!1,selections:r,storageKey:null}],storageKey:null}],type:"PullRequest",abstractKey:null},i],storageKey:null}]},params:{id:"04e1dd6f2b56134ca0f7072f1b4e378d",metadata:{},name:"DiffChatWrapper_ComparisonQuery",operationKind:"query",text:null}}}();i.hash="d578419fae8b10b0e04ed1d6c518ea52";let r=i},19236:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let i=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"diffEntryId"}],t=[{kind:"Variable",name:"id",variableName:"diffEntryId"}],n={alias:null,args:null,kind:"ScalarField",name:"path",storageKey:null},i=[n,{alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"DiffChatWrapper_DiffEntryQuery",selections:[{alias:"diffEntry",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"useFileDiffReference_DiffEntry"}],type:"PullRequestDiffEntry",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"DiffChatWrapper_DiffEntryQuery",selections:[{alias:"diffEntry",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"pathDigest",storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"rawUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isBinary",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isSubmodule",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isLfsPointer",storageKey:null},{alias:null,args:null,concreteType:"TreeEntry",kind:"LinkedField",name:"oldTreeEntry",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:"TreeEntry",kind:"LinkedField",name:"newTreeEntry",plural:!1,selections:i,storageKey:null}],type:"PullRequestDiffEntry",abstractKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"7c9df64c41ef33594dd0882be84ef373",metadata:{},name:"DiffChatWrapper_DiffEntryQuery",operationKind:"query",text:null}}}();i.hash="064698bd6869b0c7d063a68d0b3666d8";let r=i},16790:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let i=function(){var e={alias:null,args:null,kind:"ScalarField",name:"isCopilotDotcomChatEnabled",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DiffChatWrapper_ViewerQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[e],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DiffChatWrapper_ViewerQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"16bed8244ee96ad06b6638dbb86dd0ff",metadata:{},name:"DiffChatWrapper_ViewerQuery",operationKind:"query",text:null}}}();i.hash="4d1f99d4dad28f392f7ea1a3cecbcfff";let r=i},75170:(e,t,n)=>{n.d(t,{U:()=>o});var i=n(67294),r=n(22578);let a=n(27010),l=n(72558),s=({oldCommit:e,newCommit:t},{oldTreeEntry:n,newTreeEntry:i,...r})=>{if(!(r.isBinary||r.isSubmodule||r.isLfsPointer||(n?.size??0)>1048576||(i?.size??0)>1048576))return{type:"file-diff",id:`diff-${r.pathDigest}`,url:r.rawUrl??"",baseFile:n?{type:"file",repoID:e.repository.databaseId??0,repoName:e.repository.name,repoOwner:e.repository.owner.login,path:n.path??"",commitOID:e.oid,url:`${e.repository.url}/raw/${e.oid}/${n.path}`,ref:e.oid}:null,headFile:i?{type:"file",repoID:t.repository.databaseId??0,repoName:t.repository.name,repoOwner:t.repository.owner.login,path:i.path??"",commitOID:t.oid,url:`${t.repository.url}/raw/${t.oid}/${i.path}`,ref:t.oid}:null,head:null,base:null}},o=(e,t)=>{let n=(0,r.useFragment)(a,e),o=(0,r.useFragment)(l,t);return(0,i.useMemo)(()=>s(n,o),[n,o])}},75677:(e,t,n)=>{n.d(t,{L:()=>h,X:()=>m});var i=n(85893),r=n(85529),a=n(42483),l=n(50919),s=n(73290),o=n(98833),d=n(41436),c=n(38495),u=n(14136);function m({children:e,isAddition:t,sx:n}){return(0,i.jsx)(a.Z,{sx:{color:t?"success.fg":"danger.fg",ml:1,fontWeight:"bold",fontSize:0,...n},children:e})}try{m.displayName||(m.displayName="LinesChangedCounterLabel")}catch{}function f({newPath:e,oldPath:t,status:n}){return"RENAMED"===n?(0,i.jsxs)("code",{children:[t," ",(0,i.jsx)(r.ArrowRightIcon,{})," ",e]}):"DELETED"===n?(0,i.jsx)("code",{children:t}):(0,i.jsx)("code",{children:e})}function h({additionalLeftSideContent:e,areLinesExpanded:t,canExpandOrCollapseLines:n,isCollapsed:h,linesAdded:g,linesDeleted:p,fileLinkHref:x,newMode:y,newPath:b,oldMode:C,oldPath:j,onCopyPath:N,onHeaderClick:v,onToggleExpandAllLines:S,onToggleFileCollapsed:L,patchStatus:k,path:w,rightSideContent:I}){return(0,i.jsxs)(a.Z,{sx:{position:"relative",alignItems:"center",bg:"canvas.subtle",border:"1px solid",borderColor:"border.default",borderRadius:2,borderBottomLeftRadius:h?2:0,borderBottomRightRadius:h?2:0,display:"flex",p:2,mb:"-1px"},children:[(0,i.jsx)(l.h,{"aria-label":h?`expand file: ${w}`:`collapse file: ${w}`,icon:h?r.ChevronRightIcon:r.ChevronDownIcon,variant:"invisible",onClick:L,sx:{flexShrink:0}}),e,(0,i.jsxs)(a.Z,{sx:{pl:1,pr:1,flexGrow:1,display:"flex",alignItems:"center",overflow:"hidden"},children:[(0,i.jsx)(a.Z,{as:"h3",sx:{fontSize:1,fontWeight:"unset",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",direction:"rtl"},children:(0,i.jsx)(s.Z,{className:"Link--primary",href:x,onClick:v,children:(0,i.jsx)(f,{newPath:b,oldPath:j,status:k})})}),(0,i.jsx)(u.m,{sx:{ml:1,flexShrink:0},textToCopy:b??j??"",ariaLabel:"Copy file name to clipboard",tooltipProps:{direction:"s"},onCopy:N}),(0,c.DC)(k,C,y)&&(0,i.jsxs)(a.Z,{sx:{p:2},children:[(0,i.jsx)("code",{children:C}),(0,i.jsx)(o.Z,{icon:r.ArrowRightIcon,sx:{mx:1}}),(0,i.jsx)("code",{children:y})]}),n&&S&&(0,i.jsx)(d.u,{text:t?`collapse non diff lines: ${w}`:`expand all lines: ${w}`,direction:"s",children:(0,i.jsx)(l.h,{"aria-label":t?`collapse non diff lines: ${w}`:`expand all lines: ${w}`,icon:t?r.FoldIcon:r.UnfoldIcon,variant:"invisible",className:t?"":"js-expand-all-difflines-button","data-file-path":w,onClick:S,sx:{flexShrink:0}})})]}),(0,i.jsxs)(a.Z,{sx:{display:"flex",flexGrow:1,justifyContent:"flex-end",mr:2},children:[g>0&&(0,i.jsxs)(m,{isAddition:!0,children:["+",g]}),p>0&&(0,i.jsxs)(m,{isAddition:!1,children:["-",p]})]}),I]})}try{f.displayName||(f.displayName="FileName")}catch{}try{h.displayName||(h.displayName="DiffFileHeader")}catch{}},38495:(e,t,n)=>{function i(e){return void 0!==e.linesChanged&&0!==e.linesChanged}function r(e,t,n){return"MODIFIED"===e&&t!==n}function a(e){return"COPIED"===e.status&&!i(e)}function l(e){return"RENAMED"===e.status&&!i(e)}function s(e){return!!e.oldTreeEntry&&null===e.newTreeEntry}function o(e){return!!e.truncatedReason}n.d(t,{DC:()=>r,PW:()=>l,V_:()=>o,_R:()=>f,eb:()=>s,l3:()=>m,vY:()=>a,zR:()=>u});let d=["maximum diff size exceeded.","maximum number of lines exceeded."],c=/^maximum file count exceeded/;function u(e){let t=e;return d.includes(e)?t="Sorry, we could not display the changes to this file because there were too many other changes to display.":c.test(e)&&(t="Sorry, we could not display the changes to this file because there were too many other files to display."),t}function m(e){return!!e.newTreeEntry?.isGenerated}function f(e){return 0===e.linesChanged}},39173:(e,t,n)=>{n.d(t,{rm:()=>S,mQ:()=>C,B_:()=>y});var i=n(85893),r=n(85529),a=n(67294),l=n(81455),s=n(24815);function o(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function d(e,t){var n=o(e,t,"get");return n.get?n.get.call(e):n.value}function c(e,t,n){!function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function u(e,t,n){var i=o(e,t,"set");return!function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(e,i,n),n}function m(e,t){return e.name.localeCompare(t.name)}function f(e,t){return e.fileName.localeCompare(t.fileName)}function h(e){return e.diff}var g=new WeakMap;let FileNode=class FileNode{constructor(e){c(this,g,{writable:!0,value:void 0}),this.diff=e,this.filePath=this.diff.path,u(this,g,this.filePath.split("/")),this.fileName=d(this,g)[d(this,g).length-1],this.directoryParts=d(this,g).slice(0,d(this,g).length-1)}};var p=new WeakMap;let DirectoryNode=class DirectoryNode{getOrCreateDirectory(e){let t=d(this,p).get(e);if(!t){let n=this.path?`${this.path}/`:"";t=new DirectoryNode(e,`${n}${e}`),this.directories.push(t),d(this,p).set(e,t)}return t}sort(){for(let e of(this.directories.sort(m),this.files.sort(f),this.directories))e.sort()}getOrderedDiffs(){let e=this.files.map(h);for(let t of this.directories)e.push(...t.getOrderedDiffs());return e}constructor(e,t){c(this,p,{writable:!0,value:void 0}),this.name=e,this.path=t,this.directories=[],this.files=[],u(this,p,new Map)}};function x(e){let t=new DirectoryNode("",""),n=e.map(e=>new FileNode(e));for(let e of n){let n=t;for(let t of e.directoryParts)n=n.getOrCreateDirectory(t);n.files.push(e)}return t.sort(),t}function y(e){let t=e.filter(e=>!!e),n=x(t);return n.getOrderedDiffs()}var b=n(98833);function C({status:e}){switch(e){case"ADDED":case"COPIED":return(0,i.jsx)(b.Z,{size:16,icon:r.FileAddedIcon,className:"fgColor-success"});case"DELETED":return(0,i.jsx)(b.Z,{size:16,icon:r.FileRemovedIcon,className:"fgColor-danger"});case"RENAMED":return(0,i.jsx)(b.Z,{size:16,icon:r.FileMovedIcon,className:"fgColor-attention"});default:return(0,i.jsx)(b.Z,{size:16,icon:r.FileIcon,className:"fgColor-muted"})}}try{C.displayName||(C.displayName="FileStatusIcon")}catch{}var j=n(29065);let N=(0,a.memo)(function({file:e,depth:t,isActive:n,onSelect:o}){let d=a.useRef(null),c=(0,j.a)({focusRowRef:d,mouseRowRef:d}),u=e.diff.totalCommentsCount??0,m=e.diff.totalAnnotationsCount??0,f=u+m;return(0,i.jsxs)(l.L.Item,{defaultExpanded:!0,"aria-level":t,current:n,id:e.diff.path,onSelect:()=>o?.(e.diff),ref:d,children:[(0,i.jsx)(l.L.LeadingVisual,{children:(0,i.jsx)(C,{status:e.diff.changeType})}),e.fileName,c&&(0,i.jsx)(s.u,{"data-testid":`${e.fileName}-item-tooltip`,id:`${e.fileName}-item-tooltip`,contentRef:d,"aria-label":e.fileName,open:!0,direction:"ne"}),!!f&&(0,i.jsx)(l.L.TrailingVisual,{children:(0,i.jsxs)("div",{className:"d-flex flex-items-center flex-row",children:[(0,i.jsx)(r.CommentIcon,{}),(0,i.jsx)("div",{className:"ml-1 text-bold fgColor-default f6",children:f<10?f:"9+"})]})})]})});function v({directory:e,depth:t=0,leadingPath:n="",activeFilePath:r,...o}){let d=n?`${n}/`:"",c=a.useRef(null),u=a.useRef(null),m=(0,j.a)({focusRowRef:u,mouseRowRef:c});if(!e.files.length&&1===e.directories.length)return(0,i.jsx)(i.Fragment,{children:e.directories.map(n=>(0,i.jsx)(v,{activeFilePath:r,depth:0===t?1:t,directory:n,leadingPath:`${d}${e.name}`,...o},n.path))});function f(){return(0,i.jsxs)(i.Fragment,{children:[e.files.map(e=>(0,i.jsx)(N,{depth:t+1,file:e,isActive:r===e.filePath,...o},e.filePath)),e.directories.map(e=>(0,i.jsx)(v,{activeFilePath:r,depth:t+1,directory:e,...o},e.path))]})}return 0===t?f():(0,i.jsxs)(l.L.Item,{ref:u,defaultExpanded:!0,id:e.path,children:[(0,i.jsx)(l.L.LeadingVisual,{children:(0,i.jsx)(l.L.DirectoryIcon,{})}),(0,i.jsx)("span",{ref:c,children:`${d}${e.name}`}),m&&(0,i.jsx)(s.u,{"data-testid":`${e.name}-directory-item-tooltip`,id:`${e.name}-directory-item-tooltip`,contentRef:u,"aria-label":`${d}${e.name}`,open:!0,direction:"ne"}),(0,i.jsx)(l.L.SubTree,{children:f()})]},e.path)}let S=(0,a.memo)(function({activeFilePath:e,diffs:t,...n}){let r=x(t);return(0,i.jsx)(l.L,{"aria-label":"File Tree",children:(0,i.jsx)(v,{activeFilePath:e,directory:r,...n})})});try{N.displayName||(N.displayName="File")}catch{}try{v.displayName||(v.displayName="Directory")}catch{}try{S.displayName||(S.displayName="DiffFileTree")}catch{}},54207:(e,t,n)=>{n.d(t,{Q6:()=>ta,jR:()=>c.j,qV:()=>tl.qV,Es:()=>tl.Es});var i=n(85893),r=n(38495),a=n(6975),l=n(46455),s=n(73290),o=n(67294),d=n(89250),c=n(18655),u=n(92086),m=n(86010),f=n(88216),h=n(97011);function g({children:e,helpText:t,helpUrl:n,onLoadDiff:r}){return(0,i.jsx)("div",{className:"px-3 py-4 fgColor-muted",children:(0,i.jsxs)("div",{className:(0,m.Z)("HiddenDiffPatch-module__gridColumnTemplate--3bEGq"),children:[(0,i.jsx)("svg",{"aria-hidden":!0,height:"84",style:{maxWidth:"340px"},viewBox:"0 0 340 84",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{clipPath:"url(#diff-placeholder)",d:"M0 0h340v84H0z",fillRule:"evenodd",style:{fill:"var(--bgColor-muted, var(--color-canvas-subtle))"}})})," ",(0,i.jsxs)("div",{className:"d-flex flex-justify-center flex-column flex-column text-center",children:[(0,i.jsx)(f.r,{className:"h4 mx-auto",variant:"invisible",onClick:()=>r(),children:"Load Diff"}),(0,i.jsxs)(h.Z,{className:"fgColor-muted mt-1",children:[e,n&&t&&(0,i.jsx)(s.Z,{inline:!0,href:n,children:t})]})]})]})})}try{g.displayName||(g.displayName="HiddenDiffPatch")}catch{}let p={finalLineId:"final-hunk-header-line"};function x(e,t){return e.startBlobLineNumber-t.startBlobLineNumber}function y(e,t){let n="HUNK"===e.type&&e.__id===p.finalLineId;if(n)return{currentHunk:t[t.length-1],previousHunk:t[t.length-2]};let i=t.sort(x).findIndex(t=>t.startBlobLineNumber<=e.blobLineNumber&&t.endBlobLineNumber>=e.blobLineNumber);return{currentHunk:t[i],nextHunk:t[i+1],previousHunk:t[i-1]}}function b(e){let t=[],n=0;for(let i=1;i<e.length;i++){let r=e[i],a=i===e.length-1;if(r&&!(0,u.Ok)(r)){if("HUNK"===r.type){let a;let l=e[n];if(!l||(0,u.Ok)(l))continue;let s=i-1;for(;(!a||(0,u.Ok)(a))&&(a=e[s],-1!=--s););a&&!(0,u.Ok)(a)&&t.push({startBlobLineNumber:l.blobLineNumber,endBlobLineNumber:a.blobLineNumber}),r.__id===p.finalLineId&&t.push({startBlobLineNumber:r.blobLineNumber,endBlobLineNumber:r.blobLineNumber+20}),n=i;continue}if(a){let i=e[n];i&&!(0,u.Ok)(i)&&t.push({startBlobLineNumber:i.blobLineNumber,endBlobLineNumber:r.blobLineNumber})}}}return t}var C=n(63451),j=n(8930);let N={overlay:"SelectedDiffLinesOverlay-module__overlay--mWvvK",overlayOpacity:"SelectedDiffLinesOverlay-module__overlayOpacity--B9iKM"};function v({selectedLineRange:e,tableRef:t}){let[n,r]=(0,o.useState)(null),a=(0,o.useCallback)(()=>{if(!t.current)return;let e=t.current.querySelectorAll('td[data-selected="true"]');if(0===e.length){r(null);return}let n=(function(e){let t=e.parentNode;for(;null!==t;){if(t instanceof HTMLElement&&"static"!==getComputedStyle(t).position)return t;t=t.parentNode}return document.body})(t.current).getBoundingClientRect(),i=0,a=Number.MAX_SAFE_INTEGER,l=0,s=Number.MAX_SAFE_INTEGER;for(let t of e){let e=t.getBoundingClientRect();i=Math.max(i,e.bottom-n.top),a=Math.min(a,e.left-n.left),l=Math.max(l,e.right-n.left),s=Math.min(s,e.top-n.top)}r({left:a-1,height:i-s+2,top:s-1,width:l-a+2})},[t]);return((0,C.b)(()=>{a()},[e,t,a]),(0,j.y)(a,t),n)?(0,i.jsx)("div",{className:(0,m.Z)("position-absolute","borderColor-accent-emphasis",N.overlay),style:n,children:(0,i.jsx)("div",{className:(0,m.Z)("width-full","height-full","bgColor-accent-emphasis",N.overlayOpacity)})}):null}try{v.displayName||(v.displayName="SelectedDiffLinesOverlay")}catch{}let S=(0,o.createContext)(null);function L({children:e,currentHunk:t,diffEntryId:n,diffLine:r,fileAnchor:a,fileLineCount:l,filePath:s,isLeftSide:d,isRowSelected:c,isSplit:u,modifiedLineThreads:m,modifiedLineThreadsConnectionId:f,nextHunk:h,originalLineThreads:g,originalLineThreadsConnectionId:p,previousHunk:x,rowId:y}){let b=(0,o.useMemo)(()=>({currentHunk:t,diffEntryId:n,diffLine:r,fileAnchor:a,fileLineCount:l,filePath:s,isLeftSide:d,isRowSelected:c,isSplit:u,modifiedLineThreads:m,modifiedLineHasThreads:m&&m.length>0,modifiedLineThreadsConnectionId:f,nextHunk:h,originalLineThreads:g,originalLineHasThreads:g&&g.length>0,originalLineThreadsConnectionId:p,previousHunk:x,rowId:y}),[t,n,r,a,l,s,d,c,u,m,f,h,g,p,x,y]);return(0,i.jsx)(S.Provider,{value:b,children:e})}function k(){let e=(0,o.useContext)(S);if(!e)throw Error("useDiffLineContext must be used within a DiffLineContextProvider");return e}try{S.displayName||(S.displayName="DiffLineContext")}catch{}try{L.displayName||(L.displayName="DiffLineContextProvider")}catch{}function w(e,t){let n=e?.threads?.flatMap(e=>{let n=e?.id,i=e?.commentsData?.comments?.[0]?.author??t,r=e?.commentsData.totalCount??0,a=e?.commentsData?.__id;return n&&i?[{id:n,author:i,commentCount:r,commentsConnectionId:a,diffSide:e.diffSide,isOutdated:e.isOutdated,line:e.line,startLine:e.startLine,startDiffSide:e.startDiffSide}]:[]})??[];return n}var I=n(8358),E=n(17840);let GridNavigator=class GridNavigator{moveToNextItem(e,t){let n;let i=this.cellIdToGridLocation.get(this.focusedGridCell?.cellId??"");if(!i)return;let[r]=i,[,a]=i;switch(("ArrowDown"===e||"ArrowUp"===e)&&this.isHunkRow(r)&&this.savedColumnIndex&&(a=this.savedColumnIndex,this.savedColumnIndex=void 0),!0){case t&&"Home"===e:this.focusFirstGridCell();break;case t&&"End"===e:{let e=this.grid.length-1,t=this.grid[e]?.length;t&&(n=this.grid[e]?.[t-1]);break}case"ArrowUp"===e:this.isHunkRow(r-1)?(this.saveColumnIndex(a),n=this.grid[r-1]?.[0]):n=this.grid[r-1]?.[a];break;case"ArrowDown"===e:this.isHunkRow(r+1)?(this.saveColumnIndex(a),n=this.grid[r+1]?.[0]):n=this.grid[r+1]?.[a];break;case"ArrowLeft"===e:n=this.grid[r]?.[a-1];break;case"ArrowRight"===e:n=this.grid[r]?.[a+1];break;case"PageUp"===e:{this.saveColumnIndex(a);let e=this.getPreviousHunkRowIndex(r);n=this.grid[e]?.[0];break}case"PageDown"===e:{this.saveColumnIndex(a);let e=this.getNextHunkRowIndex(r),t=0;e||(e=this.grid.length-1,t=a),n=this.grid[e]?.[t];break}case"Home"===e:n=this.grid[r]?.[0];break;case"End"===e:{let e=this.grid[r];if(e&&!this.isHunkRow(r)){let t=e.length-1;n=this.grid[r]?.[t]}}}return n&&(this.focusedGridCell=n),this.focusedGridCell}reinitializeGrid(e,t){this.initializeGrid(e,t)}focusFirstGridCell(e){e&&this.cellIdToGridLocation.get(e)?this.focusGridCell(e):this.focusedGridCell=this.grid[0]?.[0]}focusGridCell(e){if(this.focusedGridCell?.cellId===e)return;let t=this.cellIdToGridLocation.get(e);if(!t)return;let[n,i]=t;this.focusedGridCell=this.grid[n]?.[i]}getNextSelectableCell(e){let t;let n=this.lastSelectedGridCell||this.focusedGridCell,i=this.cellIdToGridLocation.get(n?.cellId??"");if(!i)return;let[r,a]=i;if(("ArrowUp"!==e||!(r<=1))&&("ArrowDown"!==e||r!==this.grid.length-1)){if("ArrowUp"===e){let e=r-1;for(;!t;)t=this.getNextSelectableCellFromRow({rowIndex:e,columnIndex:a}),e--}if("ArrowDown"===e){let e=r+1;for(;!t;)t=this.getNextSelectableCellFromRow({rowIndex:e,columnIndex:a}),e++}return t&&(this.lastSelectedGridCell=t),t}}getValidSelectableRowCell(){if(this.focusedGridCell?.isHunk)return;if(!this.focusedGridCell?.isEmpty)return this.focusedGridCell;let e=this.cellIdToGridLocation.get(this.focusedGridCell.cellId)?.[0];if(e)return this.focusedGridCell.columnIndex<2?this.grid[e]?.[this.focusedGridCell.columnIndex+2]:this.grid[e]?.[this.focusedGridCell.columnIndex-2]}clearLastSelectedCell(){this.lastSelectedGridCell=void 0}getFirstCodeCell(){let e=this.grid.find(e=>e[0]&&!e[0].isHunk);return e?.find(e=>!e.isEmpty)}getLastCodeCell(){let e=this.grid.slice().reverse().find(e=>e[0]&&!e[0].isHunk);return e?.slice().reverse().find(e=>!e.isEmpty)}hasLine(e,t,n){let i=(0,u.Re)(this.fileAnchor,e,t),r=(0,u.nb)(i,0),a=this.cellIdToGridLocation.get(r);if(!a)return!1;let[l]=a;return!!n===this.isHunkRow(l)}getNextSelectableCellFromRow({rowIndex:e,columnIndex:t}){let n=this.grid[e],i=n?.[t];switch(!0){case i?.isHunk:return;case i?.orientation==="left"&&i.isEmpty:return n?.[t+2];case i?.orientation==="right"&&i.isEmpty:return n?.[t-2];default:return n?.[t]}}getNextHunkRowIndex(e){let t=Array.from(this.hunkRowIndexes).sort((e,t)=>e-t);return t.find(t=>t>e)}getPreviousHunkRowIndex(e){let t=Array.from(this.hunkRowIndexes).sort((e,t)=>e-t);return t.reverse().find(t=>t<e)??0}initializeGrid(e,t){this.grid=[],this.cellIdToGridLocation=new Map,this.hunkRowIndexes=new Set;for(let n=0;n<e.length;n++){let i=[],r=e[n];if(void 0!==r){if(this.isSplitDiff){let e=(t||[])[n],a=(0,u.Re)(this.fileAnchor,r,e);(0,u.Ok)(r)||"HUNK"!==r.type?this.initializeSplitDiffCodeRow({leftLine:r,rightLine:e,row:i,rowIdentifier:a,rowIndex:n}):this.initializeHunkRow(i,a,n)}else{let e=(0,u.Re)(this.fileAnchor,r,r);(0,u.Ok)(r)||"HUNK"!==r.type?this.initializeUnifiedDiffCodeRow({diffLine:r,row:i,rowIdentifier:e,rowIndex:n}):this.initializeHunkRow(i,e,n)}this.grid.push(i)}}}initializeContentCell({cellIndex:e,diffLine:t,orientation:n,row:i,rowIdentifier:r,rowIndex:a}){let l;let s=(0,u.nb)(r,e);(0,u.Ok)(t)||"left"!==n||(l=t?.left),(0,u.Ok)(t)||"right"!==n||(l=t?.right),i.push({lineNumber:l,orientation:n,isHunk:!1,isEmpty:(0,u.Ok)(t),cellId:(0,u.nb)(r,e),columnIndex:e}),this.cellIdToGridLocation.set(s,[a,e])}initializeHunkRow(e,t,n){let i=(0,u.nb)(t,0);e.push({isHunk:!0,isEmpty:!1,cellId:i,columnIndex:0}),this.cellIdToGridLocation.set(i,[n,0]),this.hunkRowIndexes.add(n)}isHunkRow(e){return this.hunkRowIndexes.has(e)}initializeSplitDiffCodeRow({leftLine:e,rightLine:t,row:n,rowIdentifier:i,rowIndex:r}){this.initializeContentCell({cellIndex:0,diffLine:e,orientation:"left",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:1,diffLine:e,orientation:"left",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:2,diffLine:t,orientation:"right",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:3,diffLine:t,orientation:"right",row:n,rowIdentifier:i,rowIndex:r})}initializeUnifiedDiffCodeRow({diffLine:e,row:t,rowIdentifier:n,rowIndex:i}){let r=(0,u.Ok)(e)||"DELETION"!==e.type?"right":"left";this.initializeContentCell({cellIndex:0,diffLine:e,orientation:"left",row:t,rowIdentifier:n,rowIndex:i}),this.initializeContentCell({cellIndex:1,diffLine:e,orientation:"right",row:t,rowIdentifier:n,rowIndex:i}),this.initializeContentCell({cellIndex:2,diffLine:e,orientation:r,row:t,rowIdentifier:n,rowIndex:i})}saveColumnIndex(e){this.isHunkRow(e)||(this.savedColumnIndex=e)}constructor(e,t,n,i,r){this.fileAnchor=e,this.isSplitDiff=t,this.initializeGrid(n,i),this.focusFirstGridCell(r)}};function D(e){e&&setTimeout(()=>{0!==e.tabIndex&&(e.tabIndex=0)})}var T=n(48542);let R={ArrowLeft:T.Qw.ArrowHorizontal,ArrowDown:T.Qw.ArrowVertical,ArrowUp:T.Qw.ArrowVertical,ArrowRight:T.Qw.ArrowHorizontal,h:T.Qw.HL,j:T.Qw.JK,k:T.Qw.JK,l:T.Qw.HL,a:T.Qw.AD,s:T.Qw.WS,w:T.Qw.WS,d:T.Qw.AD,Tab:T.Qw.Tab,Home:T.Qw.HomeAndEnd,End:T.Qw.HomeAndEnd,PageUp:T.Qw.PageUpDown,PageDown:T.Qw.PageUpDown,Backspace:T.Qw.Backspace},O=T.Qw.ArrowAll|T.Qw.PageUpDown|T.Qw.HomeAndEnd|T.Qw.AD,A={ghostUser:{displayName:"Ghost",login:"ghost",avatarUrl:"https://avatars.githubusercontent.com/ghost",path:"/ghost",url:"/ghost"}};function _(e){if(!(e in R))return!1;let t=R[e];return(t&O)>0}function F({clearSelectedDiffRowRange:e,containerRef:t,fileAnchor:n,isSplitDiff:i,leftLines:r,replaceSelectedDiffRowRangeFromGridCells:a,rightLines:l,selectedDiffRowRange:s,updateSelectedDiffRowRange:d}){var c;let m=(0,o.useRef)(),f=(0,o.useMemo)(()=>new GridNavigator(n,i,r,l,m.current?.focusedGridCell?.cellId),[n,i,r,l]);(0,o.useEffect)(()=>{m.current=f},[f]),c=m.current,(0,o.useEffect)(()=>{if(c&&document.activeElement){let e=function(e,t,n){let i=[];for(let r=0;r<t.length;r++){let a=t[r],l=n?.[r]??a,s=!(0,u.Ok)(a)&&a?.type==="HUNK";a&&l&&!e.hasLine(a,l,s)&&i.push(a)}return i}(c,r,l);if(0!==e.length){if(t.current?.contains(document.activeElement)){if("BUTTON"===document.activeElement.tagName){let e=document.activeElement.closest("td");D(e)}else if("TD"===document.activeElement.tagName){let e=document.activeElement.getAttribute("data-grid-cell-id"),n=f.focusedGridCell?.cellId;if(e!==n){let e=t.current.querySelector(`[data-grid-cell-id=${n}]`);e?.focus()}}}else{let t,i,a;let l=r.indexOf(e[e.length-1]),s=r[l+1],o=e[0],d=s&&!(0,u.Ok)(s)&&"HUNK"===s.type;d&&(t=(0,u.nb)((0,u.Re)(n,s,s),0),i=document.querySelector(`[data-grid-cell-id=${t}]`),a=i?.querySelector("button[data-direction=down], button[data-direction=all]")),a||(t=(0,u.nb)((0,u.Re)(n,o,o),0),i=document.querySelector(`[data-grid-cell-id=${t}]`),a=i?.querySelector("button[data-direction=up], button[data-direction=all]")),t&&i&&(a?a.focus():i.focus(),f.focusGridCell(t),D(i))}}}},[n,r,f,l,c,t]),function(e,t){let n=(0,o.useCallback)(e=>{let n=e.target,i=n.getAttribute("data-grid-cell-id");i&&t.focusGridCell(i)},[t]);(0,o.useEffect)(()=>{let t=e.current;return t?.addEventListener("focusin",n),()=>t?.removeEventListener("focusin",n)},[e,n])}(t,f);let h=(0,o.useCallback)((t,i,r)=>{let l=f.getValidSelectableRowCell();switch(!0){case(r.metaKey||r.ctrlKey)&&"KeyA"===r.code:{let e=f.getFirstCodeCell(),t=f.getLastCodeCell();if(!e||!t)return i;return a({diffAnchor:n,focusedGridCell:e,startGridCell:e,endGridCell:t}),i}case r.shiftKey&&"ArrowDown"===r.key:{let e=f.getNextSelectableCell("ArrowDown");if(!e||!l)return i;return s?.firstSelectedLineNumber?d(n,e.lineNumber,e.orientation,!0):a({diffAnchor:n,focusedGridCell:l,startGridCell:l,endGridCell:e}),i}case r.shiftKey&&"ArrowUp"===r.key:{let e=f.getNextSelectableCell("ArrowUp");if(!e||!l)return i;return s?.firstSelectedLineNumber?d(n,e.lineNumber,e.orientation,!0):a({diffAnchor:n,focusedGridCell:l,startGridCell:e,endGridCell:l}),i}default:{let t=f.moveToNextItem(r.key,r.ctrlKey),n=t&&document.querySelector(`[data-grid-cell-id=${t.cellId}]`);return e(),f.clearLastSelectedCell(),n??void 0}}},[f,s,d,n,a,e]);return(0,E.v)({containerRef:t,bindKeys:O,getNextFocusable:h,focusableElementFilter:e=>"BUTTON"!==e.tagName,focusInStrategy:"previous"},[h]),{gridNavigator:f}}var P=n(10764);function M({leftLine:e,rightLine:t,currentSide:n}){let r=e.threadsData?.totalCount||0,a=t.threadsData?.totalCount||0,l=e.threadsData?.threads?.[0]?.commentsData.comments?.[0]?.author?.login||"",s=t.threadsData?.threads?.[0]?.commentsData.comments?.[0]?.author?.login||"",o="";1===r?o=`has conversation started by @${l}.`:r>1&&(o="has conversations.");let d="";1===a?d=`has conversation started by @${s}.`:a>1&&(d="has conversations.");let c="";if("LEFT"===n){let e=`${o.charAt(0).toUpperCase()}${o.slice(1)}`,t=`${d.length>1?"Modified line":""} ${d}`;c=`${e} ${t}`}else{let e=`${d.charAt(0).toUpperCase()}${d.slice(1)}`,t=`${o.length>1?"Original line":""} ${o}`;c=`${e} ${t}`}return 0===r&&0===a?null:(0,i.jsx)("div",{className:"sr-only","data-testid":"pr-diffline-summary",children:c.trimStart().trimEnd()})}try{M.displayName||(M.displayName="DiffLineSummary")}catch{}var $=n(34996),B=n(14136),U=n(48338),Z=n(75299),H=n(68100),V=n(30738),G=n(85529);let K=(0,o.createContext)(null);function z({children:e,...t}){let n=!!t.commentingImplementation,r=!!t.markerNavigationImplementation;if(t.commentingEnabled!==n&&t.commentingEnabled!==r)throw Error("commentingEnabled, commentingImplementation, and markerNavigationImplementation must be passed together");let a=t?.ghostUser??A.ghostUser,l=(0,o.useMemo)(()=>({ghostUser:a,...t}),[...Object.values(t),a]);return(0,i.jsx)(K.Provider,{value:l,children:e})}function q(){let e=(0,o.useContext)(K);if(!e)throw Error("useDiffContext must be used within a DiffContextProvider");return e}try{K.displayName||(K.displayName="DiffContext")}catch{}try{z.displayName||(z.displayName="DiffContextProvider")}catch{}var W=n(54734);function Q(e){return null!=e}let X="thread",J="annotation",Y=(0,o.createContext)(null);function ee({children:e,line:t}){let[n,r]=(0,o.useState)(!1),[a,l]=(0,o.useState)(),[s,d]=(0,o.useState)(),[c,u]=(0,o.useState)(),[m,f]=(0,o.useState)(),[h,g]=(0,o.useState)(),{ghostUser:p}=q(),{originalLineThreads:x,modifiedLineThreads:y,originalLineThreadsConnectionId:b,modifiedLineThreadsConnectionId:C}=k(),[j,N]=(0,o.useState)(),{threads:v,threadConnectionId:S}=en({line:t,side:j,originalLineThreads:x,modifiedLineThreads:y,originalLineThreadsConnectionId:b,modifiedLineThreadsConnectionId:C,ghostUser:p}),L=(0,o.useMemo)(()=>!!a||!!s||!!c||!!m,[a,c,s,m]),w=(0,o.useCallback)(()=>{r(!0)},[]),I=(0,o.useCallback)(()=>{r(!1)},[]),E=(0,o.useCallback)(e=>{e?g({id:e,kind:X}):g(void 0)},[]),D=h?.kind===X?h.id:void 0,T=h?.kind===J?h.id:void 0,R=(0,o.useCallback)(e=>{e?g({id:e,kind:J}):g(void 0)},[]),O=(0,o.useCallback)((e,t,n)=>{switch((0,W.B)(),e){case"context-menu":l(t),f(void 0),u(void 0),d(void 0);break;case"new-conversation":f({cellId:t,withSuggestedChange:n?.withSuggestedChange}),l(void 0),u(void 0),d(void 0);break;case"marker-details":u(t),l(void 0),d(void 0),f(void 0);break;case"marker-list":d(t),l(void 0),f(void 0),u(void 0)}},[]),A=(0,o.useCallback)(e=>{switch(e){case"context-menu":l(void 0);break;case"new-conversation":f(void 0);break;case"marker-details":u(void 0);break;case"marker-list":d(void 0)}},[]),_=(0,o.useCallback)(e=>(N(e),en({line:t,side:e,modifiedLineThreads:y,modifiedLineThreadsConnectionId:C,originalLineThreads:x,originalLineThreadsConnectionId:b,ghostUser:p}).threads),[t,y,C,x,b,p]),F=(0,o.useMemo)(()=>t.annotationsData?.annotations?.filter(Q)??[],[t.annotationsData?.annotations]),P=(0,o.useMemo)(()=>({annotations:F,isActionBarVisible:n,showActionBar:w,hideActionBar:I,selectThreadId:E,selectAnnotationId:R,closeDialog:A,openDialog:O,anyMenuOpen:L,selectedThreadId:D,selectedAnnotationId:T,openContextMenuCell:a,openMarkersListCell:s,openMarkerDetailsCell:c,openNewConversationCell:m,threads:v,updateVisibleThreads:_,threadConnectionId:S}),[F,n,w,I,E,R,A,O,L,D,T,a,s,c,m,v,S,_]);return(0,i.jsx)(Y.Provider,{value:P,children:e})}function et(){let e=(0,o.useContext)(Y);if(!e)throw Error("useMarkersDialogContext must be used within a MarkersDialogContextProvider");return e}function en({line:e,side:t,originalLineThreads:n,modifiedLineThreads:i,originalLineThreadsConnectionId:r,modifiedLineThreadsConnectionId:a,ghostUser:l}){switch(t){case"LEFT":return{threads:n||[],threadConnectionId:r};case"RIGHT":return{threads:i||[],threadConnectionId:a};case void 0:return{threads:w(e.threadsData,l),threadConnectionId:e.threadsData?.__id};default:return{threads:[],threadConnectionId:void 0}}}try{Y.displayName||(Y.displayName="MarkersDialogContext")}catch{}try{ee.displayName||(ee.displayName="MarkersDialogContextProvider")}catch{}var ei=n(28771),er=n(59434);function ea({cellId:e,actionBarRef:t}){let{replaceSelectedDiffRowRange:n}=(0,c.h)(),{fileAnchor:i}=k(),[r,a]=(0,o.useState)(t),{annotations:l,openDialog:s,closeDialog:d,selectedAnnotationId:u,selectAnnotationId:m,selectedThreadId:f,selectThreadId:h,openContextMenuCell:g,openNewConversationCell:p,openMarkerDetailsCell:x,openMarkersListCell:y,updateVisibleThreads:b,threads:C,threadConnectionId:j,anyMenuOpen:N}=et(),{sendAnalyticsEvent:v}=(0,er.z)(),S=(0,o.useMemo)(()=>p?.cellId===e,[e,p]),L=(0,o.useMemo)(()=>p?.withSuggestedChange,[p]),w=(0,o.useCallback)(t=>{s("new-conversation",e,t)},[e,s]),I=(0,o.useCallback)(()=>{w()},[w]),E=(0,o.useCallback)(()=>{a(t),w(),v("diff.start_new_conversation","PLUS_ICON")},[t,w,v]),D=(0,o.useCallback)(()=>{w({withSuggestedChange:!0}),v("diff.start_new_conversation_with_suggested_change","CELL_CONTEXT_MENU")},[w,v]),T=(0,o.useCallback)(()=>{a(t),w({withSuggestedChange:!0}),v("diff.start_new_conversation_with_suggested_change","ACTION_BAR_CONTEXT_MENU")},[t,w,v]),R=(0,o.useCallback)(()=>{d("new-conversation")},[d]),O=(0,o.useMemo)(()=>g===e,[e,g]),A=(0,o.useCallback)(()=>{s("context-menu",e)},[e,s]),_=(0,o.useCallback)(()=>{a(t),A()},[t,A]),F=(0,o.useCallback)(()=>{d("context-menu")},[d]),P=(0,o.useCallback)(()=>{O?F():A()},[F,O,A]),M=(0,o.useCallback)(()=>{a(t),P()},[t,P]),$=(0,o.useMemo)(()=>x===e?f:void 0,[e,x,f]),B=(0,o.useMemo)(()=>x===e?u:void 0,[e,x,u]),U=(0,o.useCallback)(()=>{s("marker-details",e)},[e,s]),Z=(0,o.useCallback)(()=>{d("marker-details")},[d]),H=(0,ei.R)((e,t={skipLineSelection:!1})=>{if(h(e),U(),t.skipLineSelection)return;let r=C.find(t=>t.id===e);if(r&&r.diffSide&&r.line){let e=r.startLine??r.line,t=r.startDiffSide??r.diffSide;n({diffAnchor:i,endLineNumber:r.line,endOrientation:"LEFT"===r.diffSide?"left":"right",startLineNumber:e,startOrientation:"LEFT"===t?"left":"right",firstSelectedLineNumber:e,firstSelectedOrientation:"LEFT"===t?"left":"right"})}}),V=(0,ei.R)((e,t={skipLineSelection:!1})=>{if(m(e),U(),t.skipLineSelection)return;let r=l.find(t=>t.id===e);r&&n({diffAnchor:i,endLineNumber:r.location.end.line,endOrientation:"right",startLineNumber:r.location.start.line,startOrientation:"right",firstSelectedLineNumber:r.location.start.line,firstSelectedOrientation:"right"})}),G=(0,o.useCallback)(()=>{s("marker-list",e)},[e,s]),K=(0,o.useCallback)(()=>{d("marker-list")},[d]),z=(0,o.useCallback)(e=>{let t=b(e);if(!t?.length&&!l.length)return;let n=t&&t[0],i=t&&1===t.length&&n&&!l.length,r=l[0],a=1===l.length&&r&&!t?.length;i?H(n.id):a?V(r.id):G()},[l,G,V,H,b]),q=(0,o.useCallback)(e=>{z(e),a(t)},[t,z]),W=(0,o.useCallback)(e=>{z(e)},[z]);return{isNewConversationDialogOpen:S,startNewConversation:I,startNewConversationFromActionBar:E,closeNewConversationDialog:R,startNewConversationWithSuggestedChange:D,startNewConversationFromActionBarWithSuggestedChange:T,shouldStartNewConversationWithSuggestedChange:L,isContextMenuOpen:O,openContextMenu:A,openContextMenuFromActionBar:_,closeContextMenu:F,toggleContextMenu:P,toggleContextMenuFromActionBar:M,optimizedSelectedThreadId:$,optimizedSelectedAnnotationId:B,selectThread:H,selectAnnotation:V,openMarkerDetailsDialog:U,closeConversationDetailsDialog:Z,isMarkerListDialogOpen:y===e,openMarkerListDialog:G,closeMarkerListDialog:K,openMarkerOrListDialogFromActionBar:q,openMarkerOrListDialog:W,annotations:l,returnFocusRef:r,threadConnectionId:j,threads:C,anyMenuOpen:N}}function el({cellRef:e}){let{showActionBar:t,hideActionBar:n,anyMenuOpen:i}=et(),[r,a]=(0,o.useState)(!1),l=(0,o.useCallback)(()=>{t()},[t]),s=(0,o.useCallback)(t=>{!i&&(e.current&&e.current.contains(t.relatedTarget)||n())},[i,e,n]),d=(0,o.useCallback)(()=>{t()},[t]),c=(0,o.useCallback)(()=>{!i&&(e.current===document.activeElement||e.current?.contains(document.activeElement)||n())},[i,e,n]),u=(0,o.useCallback)(t=>{e.current&&!i&&(e.current.contains(t.relatedTarget)?e.current===t.relatedTarget&&a(!1):(n(),a(!1)))},[i,e,n]),m=(0,o.useCallback)(e=>{i||(e.stopPropagation(),a(!0))},[i]),f=(0,o.useCallback)(e=>{!i&&_(e.key)&&e.stopPropagation()},[i]);return{isActionBarFocused:r,handleCellBlur:s,handleCellFocus:l,handleCellMouseEnter:d,handleCellMouseLeave:c,handleActionBarBlur:u,handleActionBarFocusCapture:m,handleActionBarKeydownCapture:f}}function es(){let{nextHunk:e,currentHunk:t,previousHunk:n}=k(),{addInjectedContextLines:i}=q(),r=!!t&&0!==t.startBlobLineNumber,a=!!t&&!!e;return{expandStartOfHunk:()=>{if(!r||!t)return;let e={start:Math.max(0,t.startBlobLineNumber-20),end:t.startBlobLineNumber};i(e)},expandEndOfHunk:()=>{if(!a||!t)return;let e={start:t.endBlobLineNumber+1,end:t.endBlobLineNumber+1+20};i(e)},expandEndOfPreviousHunk:()=>{if(!n)return;let e={start:n.endBlobLineNumber+1,end:n.endBlobLineNumber+1+20};i(e)},canExpandEndOfHunk:a,canExpandStartOfHunk:r}}var eo=n(85861),ed=n(31171),ec=n(33831),eu=n(50919),em=n(79804),ef=n(90836),eh=n(26004);function eg({shouldAnimateRef:e}){let{diffLine:t}=k(),{ghostUser:n}=q();(0,o.useEffect)(()=>{e?.current&&(e.current=!1)},[e]);let r=t.threadsData?.totalCommentsCount||0,a=t.annotationsData?.totalCount||0,l=r+a;if(0===l)return null;let s={},d=[];t.annotationsData?.annotations?.map(e=>{e?.annotationLevel&&d.push({id:e.id,level:e.annotationLevel})}),t.threadsData?.threads?.map(e=>e?.commentsData?.comments?.map(e=>{e?.author?s[e?.author.login]=e.author:n?.login&&(s[n.login]=n)}));let c=d.sort((e,t)=>{let n=eh.kQ[e.level]?.priority||0,i=eh.kQ[t.level]?.priority||0;return n<i?-1:1}).map(t=>e?.current?(0,i.jsx)(eh.CU,{annotationLevel:t.level},t.id):(0,i.jsx)(eh.rD,{annotationLevel:t.level},t.id)),u=Object.keys(s).map(e=>{let t=s[e]?.login,r=s[e]?.avatarUrl??(n?.avatarUrl||" ");return(0,i.jsx)(em.O,{alt:t,size:20,src:r},t)}),f=[...c,...u].slice(0,3),g=l>9?"9+":`${l}`;return(0,i.jsxs)("div",{className:(0,m.Z)("d-flex","flex-justify-between","flex-items-center","CommentIndicator-module__commentIndicatorContainer--L8lU3"),children:[(0,i.jsx)(ef.Z,{disableExpand:!0,sx:{maxWidth:"40px","--avatar-stack-three-plus-min-width":"32px"},children:f}),(0,i.jsx)(h.Z,{sx:{color:"fg.default",ml:1,fontSize:0,fontWeight:400,fontVariantNumeric:"tabular-nums",width:"2ch",textAlign:"start"},children:g})]})}try{eg.displayName||(eg.displayName="CommentIndicator")}catch{}var ep=n(14786),ex=n(74121),ey=n(96797),eb=n(44042),eC=n(93498),ej=n(40516);let eN=({queryVariables:e,selectedRange:t})=>(0,i.jsx)(ej.n,{queryVariables:e,errorFallback:(0,i.jsx)(ev,{}),suspenseFallback:(0,i.jsx)(eS,{}),componentProps:{selectedRange:t},Component:eL}),ev=()=>(0,i.jsxs)(ep.S.Item,{disabled:!0,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.AlertIcon,{})}),"Copilot failed to load"]}),eS=()=>(0,i.jsxs)(ep.S.Item,{disabled:!0,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(ex.Z,{size:"small"})}),"Copilot is loading..."]}),eL=({fileDiffReference:e,selectedRange:t})=>{let n=(0,o.useMemo)(()=>{let n={...e};return t&&(n.selectedRange={start:`${t?.startOrientation[0]?.toUpperCase()??""}${t?.startLineNumber}`,end:`${t?.endOrientation[0]?.toUpperCase()??""}${t?.endLineNumber}`}),n},[e,t]);return(0,i.jsxs)(U.R,{anchor:(0,i.jsx)(U.R.MenuItemAnchor,{leadingVisual:(0,i.jsx)(G.CopilotIcon,{}),children:"Copilot"}),children:[(0,i.jsx)(eb.u,{fileDiffReference:n,eventContext:{prx:!0}}),(0,i.jsx)(eC.m,{fileDiffReference:n,eventContext:{prx:!0}}),(0,i.jsx)(ey.l,{fileDiffReference:n,eventContext:{prx:!0}})]})};try{eN.displayName||(eN.displayName="CopilotDiffChatContextMenu")}catch{}try{ev.displayName||(ev.displayName="MenuItemError")}catch{}try{eS.displayName||(eS.displayName="MenuItemLoading")}catch{}try{eL.displayName||(eL.displayName="BaseCopilotDiffChatContextMenu")}catch{}var ek=n(96567);let ew={left:"L",right:"R"},eI="Start conversation",eE="Suggest change";function eD(e,t,n){let i=n&&!(0,u.FY)(t)?ew.left:ew.right;return`${e} on line ${i}${t.blobLineNumber}`}function eT({handleStartConversationWithSuggestedChange:e,handleStartConversation:t}){let n,r,a;let{selectedDiffRowRange:l,selectedDiffLines:s,replaceSelectedDiffRowRange:d}=(0,c.h)(),{commentingEnabled:m}=q(),{diffLine:f,isLeftSide:h,isSplit:g}=k(),p=(0,o.useMemo)(()=>s.leftLines[0],[s.leftLines]),x=(0,o.useMemo)(()=>s.leftLines[s.leftLines.length-1],[s.leftLines]),y=(0,o.useMemo)(()=>s.leftLines.every(e=>!(0,u.Ok)(e)&&"DELETION"!==e.type),[s.leftLines]),b=(0,o.useMemo)(()=>s.rightLines[0],[s.rightLines]),C=(0,o.useMemo)(()=>s.rightLines[s.rightLines.length-1],[s.rightLines]),j=(0,o.useMemo)(()=>0===s.rightLines.length,[s.rightLines]),N=(0,o.useMemo)(()=>0===s.leftLines.length,[s.leftLines]),v=(0,o.useMemo)(()=>!(s.leftLines.find(e=>!(0,u.Ok)(e)&&!(0,u.FY)(e)&&"INJECTED_CONTEXT"!==e.type)||s.rightLines.find(e=>!(0,u.Ok)(e)&&!(0,u.FY)(e)&&"INJECTED_CONTEXT"!==e.type)),[s.leftLines,s.rightLines]),S=(0,o.useCallback)((n,i)=>{if(!l||!x||!p||(0,u.Ok)(x)||(0,u.Ok)(p)||!p.left||!x.left)return;let r={diffAnchor:l.diffAnchor,endLineNumber:x.left,endOrientation:"left",startLineNumber:p.left,startOrientation:"left",firstSelectedLineNumber:p.left,firstSelectedOrientation:"left"};d(r),i?.withSuggestedChange?e():t()},[l,x,p,d,e,t]),L=(0,o.useCallback)((n,i)=>{if(!l||!C||!b||(0,u.Ok)(C)||(0,u.Ok)(b)||!b.right||!C.right)return;let r={diffAnchor:l.diffAnchor,endLineNumber:C.right,endOrientation:"right",startLineNumber:b.right,startOrientation:"right",firstSelectedLineNumber:b.right,firstSelectedOrientation:"right"};d(r),i?.withSuggestedChange?e():t()},[l,C,b,d,e,t]),w=(0,o.useMemo)(()=>!!l&&(l.startOrientation!==l.endOrientation||l.startLineNumber!==l.endLineNumber),[l]);if(!m)return null;let I=!1,E=!1;if(l&&w){let t=ew[l.startOrientation],s=ew[l.endOrientation];return a=` on lines ${t}${l.startLineNumber}-${s}${l.endLineNumber}`,!(0,u.Ok)(p)&&!(0,u.Ok)(x)&&p&&x&&(I=!0,n=function(e,t,n){let i=e.left===t.left;return i?n?` on line L${e.left}`:`, original line L${e.left}`:n?` on lines L${e.left}-L${t.right}`:`, original lines L${e.left}-L${t.left}`}(p,x,j)),!(0,u.Ok)(b)&&!(0,u.Ok)(C)&&b&&C&&(E=!0,r=function(e,t,n,i,r){let a=e.right===t.right;return a?n||i&&r?` on line R${e.right}`:`, modified line R${t.right}`:n||i&&r?` on lines R${e.right}-R${t.right}`:`, modified lines R${e.right}-R${t.right}`}(b,C,N,g,v)),(0,i.jsx)(i.Fragment,{children:g?(0,i.jsx)(i.Fragment,{children:v?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ep.S.Item,{onSelect:L,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.PlusIcon,{})}),eI+r,(0,i.jsx)(ep.S.TrailingVisual,{children:(0,i.jsx)(ek.u,{keys:"Alt+n"})})]}),(0,i.jsxs)(ep.S.Item,{onSelect:e=>L(e,{withSuggestedChange:!0}),children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.PlusCircleIcon,{})}),eE+r]})]}):(0,i.jsxs)(i.Fragment,{children:[I?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ep.S.Item,{onSelect:S,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.PlusIcon,{})}),eI+n,(0,i.jsx)(ep.S.TrailingVisual,{children:(0,i.jsx)(ek.u,{keys:j?"Alt+n":"Alt+Shift+N"})})]}),y&&(0,i.jsxs)(ep.S.Item,{onSelect:e=>S(e,{withSuggestedChange:!0}),children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.PlusCircleIcon,{})}),eE+n]})]}):null,E?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ep.S.Item,{onSelect:L,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.PlusIcon,{})}),eI+r,(0,i.jsx)(ep.S.TrailingVisual,{children:(0,i.jsx)(ek.u,{keys:"Alt+n"})})]}),(0,i.jsxs)(ep.S.Item,{onSelect:e=>L(e,{withSuggestedChange:!0}),children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.PlusCircleIcon,{})}),eE+r]})]}):null]})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(H.hj,{commandId:"pull-requests-diff-view:start-conversation-current",leadingVisual:(0,i.jsx)(G.PlusIcon,{}),children:eI+a}),"DELETION"!==f.type&&y&&(0,i.jsxs)(ep.S.Item,{onSelect:e,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.PlusCircleIcon,{})}),eE+a]})]})})}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(H.hj,{commandId:"pull-requests-diff-view:start-conversation-current",leadingVisual:(0,i.jsx)(G.PlusIcon,{}),children:eD(eI,f,h)}),"DELETION"!==f.type&&(0,i.jsxs)(ep.S.Item,{onSelect:e,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.PlusCircleIcon,{})}),eD(eE,f,h)]})]})}try{eT.displayName||(eT.displayName="StartConversationContextMenuItems")}catch{}function eR({showStartConversation:e,handleViewMarkersSelection:t,startConversationCurrentLine:n,startConversationWithSuggestedChange:r}){return(0,i.jsxs)(i.Fragment,{children:[e&&(0,i.jsx)(eT,{handleStartConversation:n,handleStartConversationWithSuggestedChange:r}),(0,i.jsx)(eF,{handleViewMarkersSelection:t}),(0,i.jsx)(eA,{}),(0,i.jsx)(eB,{}),(0,i.jsx)(e_,{}),(0,i.jsx)(H.hj,{commandId:"pull-requests-diff-view:copy-anchor-link",leadingVisual:(0,i.jsx)(G.LinkIcon,{})}),(0,i.jsx)(eU,{}),(0,i.jsx)(eZ,{})]})}function eO(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eU,{}),(0,i.jsx)(e_,{})]})}let eA=()=>{let{diffEntryId:e}=k(),{subjectId:t}=q(),{selectedDiffRowRange:n}=(0,c.h)();return e&&t?(0,i.jsx)(eN,{queryVariables:{diffEntryId:e,prId:t},selectedRange:n}):null};function e_(){let{fileAnchor:e}=k();return(0,i.jsxs)(ep.S.Item,{onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${e}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"a",code:"KeyA",ctrlKey:!0}))})},children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.MultiSelectIcon,{})}),"Select all",(0,i.jsx)(ep.S.TrailingVisual,{children:(0,i.jsx)(ek.u,{keys:"Mod+a"})})]})}function eF({handleViewMarkersSelection:e}){let{commentingEnabled:t}=q(),{isSplit:n}=k();return t?n?(0,i.jsx)(eP,{handleViewMarkersSelection:e}):(0,i.jsx)(eM,{onSelect:()=>e()}):null}function eP({handleViewMarkersSelection:e}){let{originalLineHasThreads:t,modifiedLineHasThreads:n,isLeftSide:r}=k(),{annotations:a}=et(),l=a.length>0;return r?(0,i.jsxs)(i.Fragment,{children:[t&&(0,i.jsx)(e$,{text:"View markers",onSelect:()=>e("LEFT")}),(n||l)&&(0,i.jsx)(e$,{text:"View markers, modified line",onSelect:()=>e("RIGHT")})]}):(0,i.jsxs)(i.Fragment,{children:[(n||l)&&(0,i.jsx)(e$,{text:"View markers",onSelect:()=>e("RIGHT")}),t&&(0,i.jsx)(e$,{text:"View markers, original line",onSelect:()=>e("LEFT")})]})}function eM({onSelect:e}){let{ghostUser:t}=q(),{diffLine:n}=k(),{annotations:r}=et(),a=n&&w(n.threadsData,t).length>0||r.length>0;return a?(0,i.jsx)(e$,{text:"View markers",onSelect:()=>e()}):null}function e$({onSelect:e,text:t}){return(0,i.jsxs)(ep.S.Item,{onSelect:e,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.CommentDiscussionIcon,{})}),t]})}function eB(){return(0,i.jsx)("div",{onMouseDown:e=>{window.getSelection()?.toString()!==""&&e.preventDefault()},children:(0,i.jsx)(H.hj,{commandId:"pull-requests-diff-view:copy-code",leadingVisual:(0,i.jsx)(G.CopyIcon,{})})})}function eU(){let{canExpandStartOfHunk:e,canExpandEndOfHunk:t}=es();return(0,i.jsxs)(i.Fragment,{children:[e&&(0,i.jsx)(H.hj,{commandId:"pull-requests-diff-view:expand-hunk-up",leadingVisual:(0,i.jsx)(G.FoldUpIcon,{})}),t&&(0,i.jsx)(H.hj,{commandId:"pull-requests-diff-view:expand-hunk-down",leadingVisual:(0,i.jsx)(G.FoldDownIcon,{})})]})}function eZ(){let{previousHunk:e,nextHunk:t}=k(),{fileAnchor:n}=k();return(0,i.jsxs)(i.Fragment,{children:[t?(0,i.jsxs)(ep.S.Item,{"aria-keyshortcuts":"PageDown",onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${n}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"PageDown"}))})},children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.MoveToBottomIcon,{})}),"Go to next hunk",(0,i.jsx)(ep.S.TrailingVisual,{children:"Page Down"})]}):null,e?(0,i.jsxs)(ep.S.Item,{"aria-keyshortcuts":"PageUp",onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${n}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"PageUp"}))})},children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.MoveToTopIcon,{})}),"Go to previous hunk",(0,i.jsx)(ep.S.TrailingVisual,{children:"Page Up"})]}):null]})}try{eR.displayName||(eR.displayName="CellContextMenu")}catch{}try{eO.displayName||(eO.displayName="EmptyCellContextMenu")}catch{}try{eA.displayName||(eA.displayName="CopilotListItems")}catch{}try{e_.displayName||(e_.displayName="SelectAllListItem")}catch{}try{eF.displayName||(eF.displayName="ViewMarkerListItems")}catch{}try{eP.displayName||(eP.displayName="SplitDiffMarkersListItems")}catch{}try{eM.displayName||(eM.displayName="UnifiedDiffMarkerListItem")}catch{}try{e$.displayName||(e$.displayName="MarkerListItem")}catch{}try{eB.displayName||(eB.displayName="CopyContentListItems")}catch{}try{eU.displayName||(eU.displayName="ExpandHunksListItems")}catch{}try{eZ.displayName||(eZ.displayName="JumpToHunkListItems")}catch{}var eH=n(30953);function eV({authorAvatarUrl:e,authorLogin:t,sx:n}){return(0,i.jsx)(eH.K,{altText:`${t}'s avatar image with pending indicator`,icon:G.DotFillIcon,iconColor:"var(--fgColor-attention, var(--color-attention-fg))",square:!1,src:e,backgroundSx:{backgroundColor:"var(--bgColor-default, var(--color-canvas-default))",boxShadow:"0 0 0 .1px var(--bgColor-default, var(--color-canvas-default))"},sx:{alignItems:"center",display:"flex",opacity:.5,...n}})}try{eV.displayName||(eV.displayName="InProgressCommentIndicator")}catch{}let eG={position:"absolute",right:"-16px",top:"0px",zIndex:2},eK="24px",ez="30px",eq=(0,o.forwardRef)(function({authorAvatarUrl:e,authorLogin:t,cellId:n,cellRef:r,showStartConversation:a,hasDraftComment:l},s){let d=(0,o.useRef)(null),c=(0,o.useRef)(null),{commentingEnabled:u}=q(),{diffLine:m,isRowSelected:h}=k(),g=(0,o.useRef)(null),p=d.current?d:c;(0,ed.z)(s,p);let x=m.threadsData?.totalCommentsCount||0,y=m.annotationsData?.totalCount||0,{isActionBarFocused:b,handleActionBarBlur:C,handleActionBarFocusCapture:j,handleActionBarKeydownCapture:N}=el({cellRef:r}),{annotations:v,isContextMenuOpen:S,openMarkerOrListDialogFromActionBar:L,startNewConversationFromActionBar:w,startNewConversationFromActionBarWithSuggestedChange:I,anyMenuOpen:E,threads:D,toggleContextMenu:T,toggleContextMenuFromActionBar:R}=ea({cellId:n,actionBarRef:g}),O=(0,o.useCallback)(e=>{h&&e.preventDefault()},[h]);return(0,i.jsx)("div",{"aria-hidden":!b,style:{...eG},className:"d-flex flex-row",children:(0,i.jsxs)(ec.Z,{onBlur:C,onClick:O,onFocusCapture:j,onKeyDownCapture:N,children:[u&&(0,i.jsxs)(i.Fragment,{children:[x+y>0&&(0,i.jsx)(f.r,{ref:d,"aria-expanded":E,"aria-haspopup":"true","aria-label":"View conversations",size:"small",sx:{pt:0,pb:0,px:1,height:eK},onClick:e=>{(1===D.length||1===v.length)&&e.preventDefault(),L()},children:(0,i.jsx)(eg,{})}),a&&(0,i.jsx)(i.Fragment,{children:l?(0,i.jsx)(f.r,{"aria-label":"Start conversation (comment in progress)",size:"small",sx:{pt:0,pb:0,px:1,width:ez,height:eK},onClick:w,children:(0,i.jsx)(eV,{authorAvatarUrl:e,authorLogin:t})}):(0,i.jsx)(eu.h,{"aria-label":"Start conversation",ref:c,icon:G.PlusIcon,size:"small",sx:{width:ez,height:eK,color:"fg.muted"},onClick:w})})]}),(0,i.jsx)(eu.h,{ref:g,"aria-haspopup":"true","aria-label":"More actions",icon:G.TriangleDownIcon,size:"small",sx:{width:eK,height:eK,color:"fg.muted"},onClick:R}),(0,i.jsx)(U.R,{anchor:(0,i.jsx)(i.Fragment,{}),anchorRef:g,open:S,onOpenChange:T,overlayProps:{width:"medium"},children:(0,i.jsx)(eR,{showStartConversation:a,handleViewMarkersSelection:L,startConversationCurrentLine:w,startConversationWithSuggestedChange:I})})]})})});function eW(e){let{rowId:t}=k();if(t)return(0,u.nb)(t,e)}function eQ(e,t){let{selectedDiffRowRange:n}=(0,c.h)();return(0,o.useMemo)(()=>{let i="Add a comment to",r=!!n&&n.startLineNumber!==n.endLineNumber;if(n&&r){let e={left:"L",right:"R"},t=e[n.startOrientation],r=e[n.endOrientation],a=n.startLineNumber!==n.endLineNumber;i+=a?` lines ${t}${n.startLineNumber} to ${r}${n.endLineNumber}`:` line ${t}${n.startLineNumber}`}else{let n=t&&!(0,u.FY)(e)?"L":"R";i+=` line ${n}${e.blobLineNumber}`}return i},[e,t,n])}eq.displayName="ActionBar";let eX=(0,o.forwardRef)(function({children:e,ContextMenu:t,className:n,columnIndex:r,handleDiffCellClick:a,handleDiffSideCellSelectionBlocking:l,lineAnchor:s,commentDialogOpen:d,startConversation:m,...f},h){let{diffLine:g,isRowSelected:p,isLeftSide:x,isSplit:y}=k(),b=(0,o.useRef)(null);(0,o.useImperativeHandle)(h,()=>b.current,[]);let[C,j]=(0,o.useState)(!1),{clearSelectedDiffRowRange:N,selectedDiffRowRange:v}=(0,c.h)(),{fileAnchor:S,filePath:L}=k(),{expandStartOfHunk:w,expandEndOfHunk:I,expandEndOfPreviousHunk:E}=es(),{getUnifiedDiffLineCode:D,getSplitDiffSingleLineCode:T,getSplitDiffMultiLineCode:R}=function(e){let{selectedDiffRowRange:t,selectedDiffLines:n,getDiffLinesByDiffAnchor:i}=(0,c.h)();return{getUnifiedDiffLineCode:()=>{let n=i(e);if(!n||!t)return"";let{startOrientation:r,endOrientation:a,startLineNumber:l,endLineNumber:s}=t,o=0,d=0;return n.length>1&&(o=n.findIndex(e=>"left"===r?e.left===l:e.right===l),d=n.findIndex(e=>"left"===a?e.left===s:e.right===s)),(0,u.aS)(n.slice(o,d+1))},getSplitDiffSingleLineCode:(t,n)=>{if(!t||!n)return"";let r=i(e)?.find(e=>"left"===t?e.left===n:e.right===n);return r?(0,u.aS)([r]):""},getSplitDiffMultiLineCode:e=>void 0===e?"":"left"===e?(0,u.aS)(n.leftLines):(0,u.aS)(n.rightLines)}}(S),O=(0,o.useRef)(null),A=(0,V.U)(e=>{if(!e.target)return;let t=e.target;!C||O.current?.contains(t)||b.current?.contains(t)||2!==e.button?b.current?.contains(t)&&e.target.closest("button")?.contains(t)&&j(!1):j(!1)});(0,o.useEffect)(()=>{C?document.addEventListener("mousedown",A):document.removeEventListener("mousedown",A)},[A,C]),(0,o.useEffect)(()=>()=>document.removeEventListener("mousedown",A),[]);let _=()=>!!document.getElementById("conversation-dialog"),F=()=>!(d||C||_())&&(!p&&v&&N(),j(!0),!0),P=(0,o.useCallback)(e=>{e.shiftKey&&e.preventDefault(),l?.(e)},[l]);return(0,i.jsxs)(H.FU,{as:"td",commands:{"github:open-context-menu":F,"pull-requests-diff-view:copy-code":()=>{let e=window.getSelection();if(e&&""!==e.toString()){document.execCommand("copy");return}if(y){let e=void 0===v||v?.startOrientation===v?.endOrientation&&v?.startLineNumber===v?.endLineNumber;e?(0,B.z)(T(x?"left":"right",x?g?.left:g?.right)):(0,B.z)(R(x?"left":"right"));return}(0,B.z)(D())},"pull-requests-diff-view:expand-all-hunks":()=>{let e=document.querySelector(`.js-expand-all-difflines-button[data-file-path="${L}"]`);e?.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0}))},"pull-requests-diff-view:expand-hunk-up":w,"pull-requests-diff-view:expand-hunk-down":()=>{if(g?.type==="HUNK"){E();return}I()},"pull-requests-diff-view:copy-anchor-link":()=>{let e=(0,u.K8)({line:g,range:v,fileAnchor:S});e&&(0,B.z)(e)},"pull-requests-diff-view:start-conversation-current":m},ref:b,"data-grid-cell-id":eW(r),"data-line-anchor":s,"data-selected":p,role:"gridcell",style:{userSelect:"none",position:"relative"},tabIndex:-1,valign:"top",className:n?`focusable-grid-cell ${n} ${r<3?"left-side":""}`:"focusable-grid-cell",onBlur:e=>e.target.ariaSelected="false",onClick:a,onContextMenu:e=>{F()&&e.preventDefault()},onFocus:e=>e.target.ariaSelected="true",onMouseDown:P,...f,children:[e,t&&C&&(0,i.jsx)(U.R,{anchor:(0,i.jsx)(i.Fragment,{}),anchorRef:b,open:!0,onOpenChange:j,overlayProps:{width:e?"medium":"small"},children:t})]})});function eJ(){return(0,i.jsx)("div",{className:"hunk-kebab-icon pr-2 pb-1",children:(0,i.jsx)(G.KebabHorizontalIcon,{})})}function eY({columnIndex:e,lineAnchor:t,handleDiffCellClick:n,handleDiffSideCellSelectionBlocking:r,filePath:l,tabSize:s,diffLineSummary:d}){let{diffLine:f,fileAnchor:h,isLeftSide:g}=k(),{getTextIndent:p,getPaddingLeft:x}=(0,o.useMemo)(()=>(0,a.pE)(f.text,s),[f,s]),[y,b]=(0,u.Tb)(f.html,f.type),C=b&&["+","-"].includes(b),{isActionBarVisible:j}=et(),{selectedDiffRowRange:N,selectedDiffLines:v}=(0,c.h)(),{commentBatchPending:S,commentingEnabled:L,commentingImplementation:w,markerNavigationImplementation:I,repositoryId:E,subjectId:D,subject:T,viewerData:R}=q(),{hasPersistedComment:O}=(0,$.uN)({diffSide:g?"LEFT":"RIGHT",filePath:l,line:f.blobLineNumber,subjectId:D,fileLevelComment:!1}),A=(0,o.useMemo)(()=>{var e;return e=R.viewerCanComment,L&&e&&(0,u.$D)(f,v)},[L,R,f,v]),_=(0,o.useRef)(null),F=(0,o.useRef)(null),P=(0,u.uJ)({shouldAlignRight:O||!A}),M=!!f.threadsData?.threads?.length||!!f.annotationsData?.annotations?.length,B=(0,u.FE)({hasThreads:M}),U=eQ(f,!!g),H=eW(e),{handleCellBlur:V,handleCellFocus:G,handleCellMouseEnter:K,handleCellMouseLeave:z}=el({cellRef:F}),{annotations:W,isNewConversationDialogOpen:Q,shouldStartNewConversationWithSuggestedChange:X,startNewConversation:J,startNewConversationWithSuggestedChange:Y,openMarkerOrListDialog:ee,selectAnnotation:en,selectThread:ei,isMarkerListDialogOpen:er,closeNewConversationDialog:es,closeMarkerListDialog:ed,closeConversationDetailsDialog:ec,returnFocusRef:eu,optimizedSelectedAnnotationId:em,optimizedSelectedThreadId:ef,threadConnectionId:eh,threads:ep}=ea({cellId:H,actionBarRef:_});(0,o.useEffect)(()=>{if(!I)return;let{activeGlobalMarkerID:e,onActivateGlobalMarkerNavigation:t}=I;if(e){let n=ep.map(e=>e.id),i=W.map(e=>e.id);n.includes(e)?(ei(e,{skipLineSelection:!0}),t()):i.includes(e)&&(en(e,{skipLineSelection:!0}),t())}},[ei,ep,I,W,en]);let ex=(0,eo.C)(w?.suggestedChangesEnabled,f,X),ey=(0,o.useRef)(!0),{ghostUser:eb}=q();return(0,i.jsxs)(eX,{ref:F,columnIndex:e,commentDialogOpen:Q,handleDiffCellClick:n,handleDiffSideCellSelectionBlocking:r,lineAnchor:t,startConversation:J,ContextMenu:(0,i.jsx)(eR,{showStartConversation:A,handleViewMarkersSelection:ee,startConversationCurrentLine:J,startConversationWithSuggestedChange:Y}),className:(0,m.W)(`diff-text-cell ${g?"left-side-diff-cell":"right-side-diff-cell"}`,{"border-right":g&&"HUNK"!==f.type}),style:{backgroundColor:e8(f.type,!1),paddingRight:B},onBlur:V,onFocus:G,onMouseEnter:K,onMouseLeave:z,children:[(0,i.jsxs)("code",{className:(0,m.W)("diff-text syntax-highlighted-line",{addition:"ADDITION"===f.type,deletion:"DELETION"===f.type}),children:[C&&(0,i.jsx)("span",{className:"diff-text-marker",children:b}),(0,i.jsx)(Z.sF,{html:y,className:(0,m.W)("diff-text-inner",{"color-fg-muted":"HUNK"===f.type}),style:{paddingLeft:x(),textIndent:p()}})]}),j&&(0,i.jsx)(eq,{authorAvatarUrl:R.avatarUrl,authorLogin:R.login,ref:_,cellId:H,cellRef:F,hasDraftComment:O,showStartConversation:A}),w&&I&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)($.sR,{annotations:W,batchPending:S,batchingEnabled:w.batchingEnabled,commentingImplementation:{...w,deleteComment:({onCompleted:e,...t})=>{w&&f&&w.deleteComment({...t,onCompleted:()=>{e?.(),ep.length<=1&&(ec(),setTimeout(()=>F.current?.focus()))},filePath:l})}},conversationAnchorRef:F,conversationListAnchorRef:eu,conversationListThreads:ep,fileAnchor:h,filePath:l,isMarkerListOpen:er,repositoryId:E,returnFocusRef:eu,selectedAnnotationId:em,selectedThreadId:ef,subjectId:D,subject:T,suggestedChangesConfig:ex,threadsConnectionId:eh,onCloseConversationDialog:ec,onCloseConversationList:ed,onAnnotationSelected:en,onThreadSelected:ei,markerNavigationImplementation:I,viewerData:R,ghostUser:eb}),(0,i.jsx)($.VM,{addCommentDialogTitle:U,anchorRef:F,batchPending:S,batchingEnabled:w.batchingEnabled,commentBoxConfig:w.commentBoxConfig,filePath:l,isLeftSide:!!g,isOpen:Q,lineNumber:f.blobLineNumber,repositoryId:E,returnFocusRef:eu,subjectId:D,suggestedChangesConfig:ex,threadsConnectionId:eh,viewerData:R,onAddComment:({onCompleted:e,threadsConnectionId:t,...n})=>{if(!w||!f)return;let{leftLines:i,rightLines:r}=v;if(N){let e="left"===N.endOrientation?i:r,n=e[e.length-1];n&&(0,u.R8)(n)&&n.threadsData?.__id&&(t=n.threadsData?.__id)}w.addThread({...n,diffLine:f,isLeftSide:g,selectedDiffRowRange:N,threadsConnectionId:t,onCompleted:(t,n)=>{e?.(t,n),ei(t)}})},onCloseCommentDialog:es})]}),!j&&(0,i.jsxs)("div",{"aria-hidden":"true",style:{right:P},className:"position-absolute top-0 d-flex user-select-none",children:[(0,i.jsx)(eg,{shouldAnimateRef:ey}),O&&(0,i.jsx)(eV,{authorAvatarUrl:R.avatarUrl,authorLogin:R.login,sx:{ml:"9px",mt:"2px",height:"20px"}})]}),d]})}function e0({children:e,columnIndex:t,handleDiffCellClick:n,handleDiffSideCellSelectionBlocking:r,filePath:a,...l}){let s=(0,o.useRef)(null),d=eW(t),{commentBatchPending:m,commentingEnabled:f,commentingImplementation:h,repositoryId:g,subject:p,subjectId:x,markerNavigationImplementation:y,viewerData:b}=q(),{diffLine:C,fileAnchor:j,isLeftSide:N}=k(),{selectedDiffRowRange:v,selectedDiffLines:S}=(0,c.h)(),L=eQ(C,!!N),w=(0,o.useMemo)(()=>{var e;return e=b.viewerCanComment,f&&e&&(0,u.$D)(C,S)},[f,b,C,S]),{handleCellBlur:I,handleCellFocus:E,handleCellMouseEnter:D,handleCellMouseLeave:T}=el({cellRef:s}),{ghostUser:R}=q(),{annotations:O,isNewConversationDialogOpen:A,shouldStartNewConversationWithSuggestedChange:_,startNewConversation:F,startNewConversationWithSuggestedChange:P,openMarkerOrListDialog:M,isMarkerListDialogOpen:B,closeConversationDetailsDialog:U,closeMarkerListDialog:Z,selectAnnotation:H,selectThread:V,closeNewConversationDialog:G,returnFocusRef:K,optimizedSelectedThreadId:z,optimizedSelectedAnnotationId:W,threadConnectionId:Q,threads:X}=ea({cellId:d,actionBarRef:s}),J=(0,eo.C)(h?.suggestedChangesEnabled,C,_);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eX,{ref:s,className:"diff-line-number",columnIndex:t,commentDialogOpen:A,handleDiffCellClick:n,handleDiffSideCellSelectionBlocking:r,startConversation:F,style:{backgroundColor:e8(C.type,!0),textAlign:"center"},ContextMenu:(0,i.jsx)(eR,{showStartConversation:w,handleViewMarkersSelection:M,startConversationCurrentLine:F,startConversationWithSuggestedChange:P}),onBlur:I,onFocus:E,onMouseEnter:D,onMouseLeave:T,...l,children:(0,i.jsx)("code",{children:e})}),h&&y&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)($.sR,{annotations:O,batchPending:m,batchingEnabled:h.batchingEnabled,commentingImplementation:{...h,deleteComment:({onCompleted:e,...t})=>{h&&C&&h.deleteComment({...t,onCompleted:()=>{e?.(),X.length<=1&&(U(),setTimeout(()=>s.current?.focus()))},filePath:a})}},conversationAnchorRef:s,conversationListAnchorRef:K,conversationListThreads:X,fileAnchor:j,filePath:a,isMarkerListOpen:B,repositoryId:g,returnFocusRef:K,selectedAnnotationId:W,selectedThreadId:z,subjectId:x,subject:p,suggestedChangesConfig:J,threadsConnectionId:Q,markerNavigationImplementation:y,onCloseConversationDialog:U,onCloseConversationList:Z,onThreadSelected:V,onAnnotationSelected:H,viewerData:b,ghostUser:R}),(0,i.jsx)($.VM,{addCommentDialogTitle:L,align:"start",anchorRef:s,batchPending:m,batchingEnabled:h.batchingEnabled,commentBoxConfig:h.commentBoxConfig,filePath:a,isLeftSide:!!N,isOpen:A,lineNumber:C.blobLineNumber,repositoryId:g,returnFocusRef:K,subjectId:x,suggestedChangesConfig:J,threadsConnectionId:Q,viewerData:b,onAddComment:({onCompleted:e,threadsConnectionId:t,...n})=>{if(!h||!C)return;let{leftLines:i,rightLines:r}=S;if(v){let e="left"===v.endOrientation?i:r,n=e[e.length-1];n&&(0,u.R8)(n)&&n.threadsData?.__id&&(t=n.threadsData?.__id)}h.addThread({...n,diffLine:C,selectedDiffRowRange:v,threadsConnectionId:t,onCompleted:(t,n)=>{e?.(t,n),V(t)}})},onCloseCommentDialog:G})]})]})}function e1({ContextMenu:e,renderHunkButton:t}){let n=(0,o.useRef)(null),[r,a]=function(e){let[t,n]=(0,o.useState)(!1),[i,r]=(0,o.useState)(!1),a=(0,o.useCallback)(t=>{e.current&&e.current.contains(t.relatedTarget)||n(!1)},[e]),l=(0,o.useCallback)(()=>{e.current===document.activeElement&&n(!0)},[e]),s=(0,o.useCallback)(t=>{e.current&&!e.current.contains(t.relatedTarget)&&n(!1),r(!1)},[e]),d=(0,o.useCallback)(e=>{e.stopPropagation(),r(!0)},[]),c=(0,o.useCallback)(e=>{_(e.key)&&e.stopPropagation()},[]);return[{onFocus:l,onBlur:a},{"aria-hidden":!i,tabIndex:t?0:-1,onBlur:s,onFocusCapture:d,onKeyDownCapture:c}]}(n),{diffLine:l}=k();return(0,i.jsx)(eX,{ref:n,ContextMenu:e,colSpan:4,columnIndex:0,style:{backgroundColor:"var(--bgColor-accent-muted, var(--color-accent-subtle))",flexGrow:1},...r,children:(0,i.jsxs)("div",{className:"d-flex flex-row",children:[t?.(a)??(0,i.jsx)(eJ,{}),(0,i.jsx)("code",{className:"diff-text-cell hunk",children:(0,i.jsx)(Z.sF,{className:"diff-text-inner color-fg-muted",html:l.html})})]})})}function e2({columnIndex:e,showRightBorder:t}){return(0,i.jsx)(eX,{ContextMenu:(0,i.jsx)(eO,{}),className:(0,m.W)("empty-diff-line",{"border-right":t}),columnIndex:e})}function e8(e,t=!1){switch(e){case"ADDITION":return t?"var(--diffBlob-addition-bgColor-num, var(--color-diff-blob-addition-num-bg))":"var(--diffBlob-addition-bgColor-line, var(--color-diff-blob-addition-line-bg))";case"DELETION":return t?"var(--diffBlob-deletion-bgColor-num, var(--color-diff-blob-deletion-num-bg))":"var(--diffBlob-deletion-bgColor-line, var(--color-diff-blob-deletion-line-bg))";case"HUNK":case"EMPTY":return t?"var(--diffBlob-hunk-bgColor-num, var(--color-diff-blob-hunk-num-bg))":"var(--bgColor-accent-muted, var(--color-accent-subtle))";default:return}}try{eX.displayName||(eX.displayName="Cell")}catch{}try{eJ.displayName||(eJ.displayName="HunkKebabIcon")}catch{}try{eY.displayName||(eY.displayName="ContentCell")}catch{}try{e0.displayName||(e0.displayName="LineNumberCell")}catch{}try{e1.displayName||(e1.displayName="HunkCell")}catch{}try{e2.displayName||(e2.displayName="EmptyCell")}catch{}let e4=({handleDiffSideCellSelectionBlocking:e,handleDiffRowClick:t,lineAnchor:n,diffLineSummary:r,filePath:a})=>{let{diffLine:l,isLeftSide:s,isSplit:d}=k(),{viewerData:c}=q(),{tabSizePreference:u}=c,m="ADDITION"!==l.type,f=!d||s,h="DELETION"!==l.type,g=!d||!s,p=(0,o.useCallback)(e=>{l.left&&t(e,l.left,"left",e.shiftKey)},[t,l.left]),x=(0,o.useCallback)(e=>{l.right&&t(e,l.right,"right",e.shiftKey)},[t,l.right]),y=(0,o.useCallback)(()=>{e&&e("left")},[e]),b=(0,o.useCallback)(()=>{e&&e("right")},[e]);return(0,i.jsxs)(ee,{line:l,children:[f&&(0,i.jsx)(e0,{columnIndex:0,filePath:a,handleDiffCellClick:f&&!m?x:p,handleDiffSideCellSelectionBlocking:b,children:m&&l.left}),g&&(0,i.jsx)(e0,{columnIndex:d?2:1,filePath:a,handleDiffCellClick:g&&!h?p:x,handleDiffSideCellSelectionBlocking:y,children:h&&l.right}),(0,i.jsx)(eY,{columnIndex:d?s?1:3:2,diffLineSummary:r,filePath:a,handleDiffCellClick:s?p:x,lineAnchor:n,tabSize:u,handleDiffSideCellSelectionBlocking:s?b:y})]})},e9=({fileAnchor:e,filePath:t,handleDiffRowClick:n,handleDiffSideCellSelectionBlocking:r,diffLineSummary:a})=>{let{diffLine:s,isLeftSide:o}=k();if((0,u.Ok)(s))return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e2,{columnIndex:o?0:2}),(0,i.jsx)(e2,{columnIndex:o?1:3,showRightBorder:o})]});let d=o?"left":(0,l.Jn)(s.type),c="left"===d?s.left:s.right,m=(0,l._N)(e,d,c??0);switch(s.type){case"HUNK":return null;case"ADDITION":case"DELETION":case"CONTEXT":case"INJECTED_CONTEXT":return(0,i.jsx)(e4,{diffLineSummary:a,filePath:t,handleDiffRowClick:n,handleDiffSideCellSelectionBlocking:r,lineAnchor:m});default:throw Error(`cannot handle type ${s.type}`)}};try{e4.displayName||(e4.displayName="CodeDiffLine")}catch{}try{e9.displayName||(e9.displayName="DiffLineSide")}catch{}var e5=n(45677);let e6={height:"20px",py:1};function e3({direction:e,icon:t,label:n,onClick:r,sx:a,...l}){let{sendAnalyticsEvent:s}=(0,er.z)();return(0,i.jsx)(eu.h,{...l,"aria-label":l["aria-label"]??n,"data-direction":e,icon:t,sx:{bg:"var(--diffBlob-hunk-bgColor-num, var(--color-diff-blob-hunk-num-bg))",color:"fg.default",border:"none",borderRadius:0,boxShadow:"none",lineHeight:"30px",width:"var(--line-number-cell-width)",outline:"none",py:0,":hover:not([disabled])":{bg:"accent.emphasis",color:"fg.onEmphasis"},...a},onClick:()=>{r(),s("file_entry.expand_hunk","FILE_EXPANDER_BUTTON")}})}function e7({nextLine:e,prevLine:t}){let{fileLineCount:n,diffLine:r}=k(),{expandStartOfHunk:a,expandEndOfPreviousHunk:l}=es(),s=!t,d=!e,c=0===r.blobLineNumber,m=s||d,f=d&&r.blobLineNumber===n,h=(0,o.useMemo)(()=>!m&&!(r.blobLineNumber<=0)&&(r.blobLineNumber-t.blobLineNumber<=20||e.blobLineNumber-r.blobLineNumber>=20),[m,r,e,t]),g=(0,o.useMemo)(()=>!m&&!f&&r.blobLineNumber-t.blobLineNumber>20,[m,f,r,t]),p=(0,o.useMemo)(()=>!(r.blobLineNumber<=0)&&!c&&!!s,[s,c,r]),x=(0,o.useMemo)(()=>!s&&!f&&!!d,[s,d,f]),y=(0,o.useMemo)(()=>{switch(!0){case h:return"expand-all";case g:return"expand-up-and-down";case p:return"expand-up";case x:return"expand-down"}},[h,g,p,x]),b=()=>a(),C=()=>l(),j=()=>a();return(0,i.jsx)(e1,{renderHunkButton:n=>{switch(y){case"expand-all":return(0,i.jsx)(e3,{...n,direction:"all",icon:G.UnfoldIcon,label:`Expand file from line ${t?.blobLineNumber||""} to line ${e?.blobLineNumber||""}`,onClick:j});case"expand-up-and-down":return(0,i.jsxs)("div",{className:"d-flex flex-column",children:[(0,i.jsx)(e3,{...n,direction:"down",icon:G.FoldDownIcon,label:`Expand file down from line ${t?.blobLineNumber||""}`,sx:e6,onClick:C}),(0,i.jsx)(e3,{...n,direction:"up",icon:G.FoldUpIcon,label:`Expand file up from line ${e?.blobLineNumber||""}`,sx:e6,onClick:b})]});case"expand-up":return(0,i.jsx)(e3,{...n,direction:"up",icon:G.FoldUpIcon,label:`Expand file up from line ${e?.blobLineNumber||""}`,onClick:b});case"expand-down":return(0,i.jsx)(e3,{...n,direction:"down",icon:G.FoldDownIcon,label:`Expand file down from line ${t?.blobLineNumber||""}`,onClick:C});default:return null}},ContextMenu:(0,i.jsx)(te,{handleCopyContent:()=>{let[e]=(0,u.Tb)((0,u.dW)(r.html),r.type);(0,B.z)(e)},handleExpandAbove:b,handleExpandAll:j,handleExpandBelow:C,shouldCopyContent:!!r.html,shouldExpandAbove:g||p,shouldExpandBelow:g||x})})}function te({shouldExpandBelow:e,shouldExpandAbove:t,shouldCopyContent:n,handleExpandAll:r,handleExpandBelow:a,handleExpandAbove:l,handleCopyContent:s}){let o={includeShiftKey:!0,key:"["},d={key:"]"},c={key:"["},m={key:"C"};return(0,i.jsx)(e5.P.Overlay,{width:"medium",children:(0,i.jsxs)(ep.S,{children:[(0,i.jsxs)(ep.S.Item,{"aria-keyshortcuts":(0,u.EH)(o),onSelect:r,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.UnfoldIcon,{})}),"Expand all",(0,i.jsx)(ep.S.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,u._k)(o)}`})})]}),t?(0,i.jsxs)(ep.S.Item,{"aria-keyshortcuts":(0,u.EH)(d),onSelect:l,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.FoldUpIcon,{})}),"Expand above",(0,i.jsx)(ep.S.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,u._k)(d)}`})})]}):null,e?(0,i.jsxs)(ep.S.Item,{"aria-keyshortcuts":(0,u.EH)(c),onSelect:a,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.FoldDownIcon,{})}),"Expand below",(0,i.jsx)(ep.S.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,u._k)(c)}`})})]}):null,(0,i.jsx)(eZ,{}),n?(0,i.jsxs)(ep.S.Item,{"aria-keyshortcuts":(0,u.EH)(m),onSelect:s,children:[(0,i.jsx)(ep.S.LeadingVisual,{children:(0,i.jsx)(G.CopyIcon,{})}),"Copy",(0,i.jsx)(ep.S.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,u._k)(m)}`})})]}):null]})})}try{e3.displayName||(e3.displayName="ExpandButtonLine")}catch{}try{e7.displayName||(e7.displayName="ExpandableHunkHeaderDiffLine")}catch{}try{te.displayName||(te.displayName="HunkContextMenu")}catch{}let tt=(0,o.memo)(function({clearSelectedDiffRowRange:e,diffEntryId:t,diffLines:n,fileAnchor:r,fileLineCount:a,filePath:l,handleDiffRowClick:s,handleDiffSideCellSelectionBlocking:d,replaceSelectedDiffRowRangeFromGridCells:c,selectedDiffRowRange:m,tableRef:f,updateDiffLines:h,updateSelectedDiffRowRange:g}){let{leftLines:p,rightLines:x}=(0,o.useMemo)(()=>(function(e){let t=[],n=[],i=()=>{for(;t.length<n.length;)t.push(P.s);for(;n.length<t.length;)n.push(P.s)};for(let r of e)switch(r.type){case"ADDITION":n.push(r);break;case"DELETION":t.push(r);break;case"CONTEXT":case"INJECTED_CONTEXT":i();let[e,a]=function(e){let t=e.threadsData?.threads?.filter(e=>e?.diffSide==="LEFT")??null,n={...e,threadsData:{...e.threadsData,threads:t,totalCommentsCount:t?.reduce((e,t)=>e+(t?.commentsData?.totalCount??0),0)??0,totalCount:t?.length??0},annotationsData:{totalCount:0,annotations:[]}},i=e.threadsData?.threads?.filter(e=>e?.diffSide==="RIGHT")??null,r={...e,threadsData:{...e.threadsData,threads:i,totalCommentsCount:i?.reduce((e,t)=>e+(t?.commentsData?.totalCount??0),0)??0,totalCount:i?.length??0}};return[n,r]}(r);t.push(e),n.push(a);break;case"HUNK":i(),t.push(r),n.push(r)}return i(),{leftLines:t,rightLines:n}})(n),[n]),{ghostUser:C}=q();F({clearSelectedDiffRowRange:e,containerRef:f,fileAnchor:r,isSplitDiff:!0,leftLines:p,replaceSelectedDiffRowRangeFromGridCells:c,rightLines:x,selectedDiffRowRange:m,updateSelectedDiffRowRange:g});let j=(0,o.useMemo)(()=>{if(m)return(0,I.Z)({selectedDiffRowRange:m,leftLines:p,rightLines:x})},[m,p,x]);(0,o.useEffect)(()=>{h(r,n)},[n,r,h]);let N=(0,o.useMemo)(()=>b(p),[p]),v=[];for(let e=0;e<p.length;e++){let n=p[e],c=x[e],m=p[e-1],f=(0,u.Ok)(p[e+1])?x[e+1]:p[e+1],h=(0,u.R8)(n)&&"HUNK"===n.type,g=(0,u.Re)(r,n,c),b=(0,u.Ok)(n)?(0,u.Ok)(c)?void 0:c:n;if(!b)continue;let S=(0,u.Ok)(n)?void 0:n.threadsData,k=(0,u.Ok)(c)?void 0:c.threadsData,{currentHunk:I,nextHunk:E,previousHunk:D}=y(b,N),T={currentHunk:I,diffEntryId:t,fileAnchor:r,fileLineCount:a,filePath:l,isRowSelected:j?.isRowSelected(n)||j?.isRowSelected(c),modifiedLineThreads:w(k,C),modifiedLineThreadsConnectionId:k?.__id,nextHunk:E,originalLineThreads:w(S,C),originalLineThreadsConnectionId:S?.__id,previousHunk:D,rowId:g,isSplit:!0};v.push((0,i.jsx)(o.Fragment,{children:(0,i.jsx)("tr",{className:"diff-line-row",children:h?(0,i.jsx)(L,{...T,diffLine:b,children:(0,i.jsx)(e7,{nextLine:f,prevLine:m})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(L,{...T,diffLine:n,isLeftSide:!0,children:(0,i.jsx)(e9,{fileAnchor:r,filePath:l,handleDiffRowClick:s,handleDiffSideCellSelectionBlocking:d,diffLineSummary:(0,i.jsx)(M,{currentSide:"LEFT",leftLine:n,rightLine:c})})}),(0,i.jsx)(L,{...T,diffLine:c,children:(0,i.jsx)(e9,{fileAnchor:r,filePath:l,handleDiffRowClick:s,handleDiffSideCellSelectionBlocking:d,diffLineSummary:(0,i.jsx)(M,{currentSide:"RIGHT",leftLine:n,rightLine:c})})})]})})},g))}return(0,i.jsx)(i.Fragment,{children:v})});try{tt.displayName||(tt.displayName="SplitDiffLines")}catch{}let tn=(0,o.memo)(function({clearSelectedDiffRowRange:e,diffEntryId:t,diffLines:n,fileLineCount:r,fileAnchor:a,filePath:s,tableRef:d,selectedDiffRowRange:c,handleDiffRowClick:m,updateDiffLines:f,updateSelectedDiffRowRange:h,replaceSelectedDiffRowRangeFromGridCells:g}){F({clearSelectedDiffRowRange:e,containerRef:d,fileAnchor:a,isSplitDiff:!1,leftLines:n,replaceSelectedDiffRowRangeFromGridCells:g,selectedDiffRowRange:c,updateSelectedDiffRowRange:h});let p=(0,o.useMemo)(()=>{if(c)return(0,I.Z)({selectedDiffRowRange:c,leftLines:n})},[c,n]),x=(0,o.useMemo)(()=>b(n.map(e=>e)),[n]);(0,o.useEffect)(()=>{f(a,n)},[n,a,f]);let C=n.map((e,d)=>{let c=n[d+1],f=n[d-1],h="HUNK"===e.type,g=(0,l._N)(a,(0,l.Jn)(e.type),e.blobLineNumber),{currentHunk:b,nextHunk:C,previousHunk:j}=y(e,x),N={diffEntryId:t,diffLine:e,currentHunk:b,fileAnchor:a,fileLineCount:r,filePath:s,isLeftSide:"DELETION"===e.type,isRowSelected:p?.isRowSelected(e),isSplit:!1,nextHunk:C,previousHunk:j,rowId:(0,u.Re)(a,e,e)};return(0,i.jsx)(o.Fragment,{children:(0,i.jsx)("tr",{className:"diff-line-row",children:(0,i.jsx)(L,{...N,children:h?(0,i.jsx)(e7,{nextLine:c,prevLine:f},d):(0,i.jsx)(e4,{diffLineSummary:(0,i.jsx)("div",{}),filePath:s,handleDiffRowClick:m,lineAnchor:g},d)})})},d)});return(0,i.jsx)(i.Fragment,{children:C})});try{tn.displayName||(tn.displayName="UnifiedDiffLines")}catch{}let ti={tableLayoutFixed:"DiffLines-module__tableLayoutFixed--YZcIJ"};function tr({diffAnchor:e,children:t}){return(0,i.jsx)("div",{className:"fgColor-muted p-2","data-diff-anchor":e,children:t})}let ta=(0,o.memo)(function({diffEntryData:e,diffLinesManuallyUnhidden:t,baseHelpUrl:n,onHandleLoadDiff:f,...h}){let x=(0,o.useRef)(null),[y,b]=(0,o.useState)(null),C=e.newTreeEntry?.lineCount??e.oldTreeEntry?.lineCount??0,j=(0,o.useMemo)(()=>{let t=e.diffLines[e.diffLines.length-1];return t?.blobLineNumber&&t.blobLineNumber<C?e.diffLines.concat({__id:p.finalLineId,blobLineNumber:t.blobLineNumber+1,left:null,right:null,type:"HUNK",html:"",text:""}):e.diffLines},[e.diffLines,C]),{diffViewPreference:N,tabSizePreference:S}=h.viewerData,{selectedDiffRowRange:L,replaceSelectedDiffRowRange:k,replaceSelectedDiffRowRangeFromGridCells:w,clearSelectedDiffRowRange:I,updateDiffLines:E,updateSelectedDiffRowRange:D}=(0,c.h)(),T=`diff-${e.pathDigest}`,R=T===L?.diffAnchor;(0,o.useEffect)(()=>{if(!R)return;let e=(0,u.VB)(L,j),t=!e||e===L;t||k(e)},[j,L,R,k]);let{search:O}=(0,d.TH)(),A=(0,o.useMemo)(()=>{let e=new URLSearchParams(O),t=e.get("diff");return"split"===t||"split"===N},[O,N]),_=(0,l.Gi)(j),F=(0,o.useCallback)(e=>{b(e)},[b]),P=(0,o.useCallback)((e,t,n,i)=>{!function(e){let t=document.getElementById("__primerPortalRoot__");return!!t&&!!e&&t.contains(e)}(e.target)&&(e.defaultPrevented||D(T,t,n,i))},[T,D]);if(e.isBinary)return(0,i.jsx)(tr,{diffAnchor:T,children:"Binary file not shown."});if((0,r.PW)(e))return(0,i.jsx)(tr,{diffAnchor:T,children:"File renamed without changes."});if((0,r.vY)(e))return(0,i.jsx)(tr,{diffAnchor:T,children:"File copied without changes."});if((0,r.DC)(e.status,e.oldTreeEntry?.mode,e.newTreeEntry?.mode))return(0,i.jsx)(tr,{diffAnchor:T,children:"File mode changed."});if((0,r.V_)(e))return(0,i.jsx)(tr,{diffAnchor:T,children:(0,r.zR)(e.truncatedReason)});if((0,r._R)(e))return(0,i.jsx)(tr,{diffAnchor:T,children:"Whitespace-only changes."});if(!t&&(0,r.eb)(e))return(0,i.jsx)(g,{onLoadDiff:f,children:"This file was deleted."});if(!t&&(0,r.l3)(e))return(0,i.jsxs)(g,{helpText:"customizing how changed files appear on GitHub.",helpUrl:`${n}/github/administering-a-repository/customizing-how-changed-files-appear-on-github`,onLoadDiff:f,children:["Some generated files are not rendered by default. Learn more about"," "]});if(!t&&e.isTooBig)return e.diffLines.length>0?(0,i.jsx)(g,{onLoadDiff:f,children:"Large diffs are not rendered by default."}):(0,i.jsxs)(tr,{diffAnchor:T,children:["Diff is too big to render. To view,"," ",(0,i.jsx)(s.Z,{inline:!0,href:`${n}/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally`,children:"check out this pull request locally."})]});let M={clearSelectedDiffRowRange:I,diffEntryId:e.objectId,diffLines:j,fileAnchor:T,fileLineCount:C,filePath:e.path,handleDiffRowClick:P,handleDiffSideCellSelectionBlocking:F,replaceSelectedDiffRowRangeFromGridCells:w,selectedDiffRowRange:R?L:null,tableRef:x,updateDiffLines:E,updateSelectedDiffRowRange:D};return e.diffLines?(0,i.jsxs)(z,{...h,children:[R&&(0,i.jsx)(v,{selectedLineRange:L,tableRef:x}),(0,i.jsx)("table",{ref:x,className:(0,m.Z)("tab-size","width-full",ti.tableLayoutFixed),"data-block-diff-cell-selection":y,"data-diff-anchor":T,"data-tab-size":S,"data-testid":"diff-content","data-paste-markdown-skip":!0,role:"grid",style:{"--line-number-cell-width":`${_}px`},children:A?(0,i.jsx)(a.iZ,{lineWidth:_,children:(0,i.jsx)(tt,{...M})}):(0,i.jsx)(a.wj,{lineWidth:_,children:(0,i.jsx)(tn,{...M})})})]}):null});try{tr.displayName||(tr.displayName="PlainTextStatus")}catch{}try{ta.displayName||(ta.displayName="DiffLines")}catch{}var tl=n(59889)},8358:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(46455),r=n(92086);function a({selectedDiffRowRange:e,leftLines:t,rightLines:n}){let a=!!n,{startOrientation:l,endOrientation:s}=e;if(e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation)return{isRowSelected:()=>!1,selectedRightLines:[],selectedLeftLines:[]};let o=m(l).findIndex(t=>(0,r.nI)(t,e.startLineNumber,e.startOrientation)),d=m(s).findIndex(t=>(0,r.nI)(t,e.endLineNumber,e.endOrientation)),c=o>=0&&d>=0;function u(e){if(!c||(0,r.Ok)(e))return!1;let t=m((0,i.Jn)(e.type)).indexOf(e);return t>=o&&t<=d}function m(e){return!a||function(e){let t="string"==typeof e?e:(0,i.Jn)(e.type);return"left"===t}(e)?t:n}let f=m("left").filter(e=>u(e)),h=m("right").filter(e=>u(e));return{isRowSelected:u,selectedRightLines:h,selectedLeftLines:f}}},59889:(e,t,n)=>{function i(e,t){return`${"left"===t?"L":"R"}${e}`}function r(e){let t=e.match(/^#?(diff-[a-f0-9]+)/);return t?.[1]}function a(e){let t=e.match(/^#?(r\d+)/),n=t?.[1];return n?parseInt(n.slice(1)):void 0}function l(e){let t=e.match(/^#annotation_(\d+)/),n=t?.[1];return n?parseInt(n):void 0}function s(e){let t=function(e){let t=e.match(/^#?(diff-[a-f0-9]+)(L|R)(\d+)(?:-(L|R)(\d+))?$/i);if(null!=t&&6===t.length)return t;let n=e.match(/^#?(discussion-diff-[0-9]+)(L|R)(\d+)(?:-(L|R)(\d+))?$/i);return null!=n&&6===n.length?n:null}(e);if(t){let e=t[1],n=t[2]?"L"===t[2]?"left":"right":void 0,i=t[3]?parseInt(t[3]):void 0;if(!e||!n||void 0===i)return;let r=t[4]?"L"===t[4]?"left":"right":void 0,a=t[5]?parseInt(t[5]):void 0;return{diffAnchor:e,startOrientation:n,startLineNumber:i,endOrientation:r??n,endLineNumber:a??i,firstSelectedLineNumber:i,firstSelectedOrientation:n}}}function o(e){let t=d(e);c(t)}function d(e){let t=i(e.startLineNumber,e.startOrientation),n=`${e.diffAnchor}${t}`;if(e.endLineNumber!==e.startLineNumber||e.endOrientation!==e.startOrientation){let t=i(e.endLineNumber,e.endOrientation);n+=`-${t}`}return n}function c(e){let t=`#${e}`;if(t===window.location.hash)return;let n=window.location.href;history.replaceState({...history.state},"",t),window.dispatchEvent(new HashChangeEvent("hashchange",{newURL:window.location.href,oldURL:n}))}n.d(t,{Es:()=>a,LA:()=>r,Lh:()=>d,Ze:()=>c,fI:()=>o,qV:()=>l,rn:()=>s})},92086:(e,t,n)=>{n.d(t,{$D:()=>v,EH:()=>j,Ek:()=>g,FE:()=>b,FY:()=>f,K8:()=>x,Ok:()=>u,R8:()=>m,Re:()=>d,Tb:()=>h,VB:()=>o,_k:()=>y,aS:()=>S,dW:()=>p,nI:()=>s,nb:()=>c,uJ:()=>C});var i=n(46455),r=n(51505),a=n(10764),l=n(59889);function s(e,t,n){return"left"===n?!u(e)&&e.left===t:!u(e)&&(0,i.Jn)(e.type)===n&&e.right===t}function o(e,t){if(!e)return;if(!t)return e;let n=!1,i=!1,r=!1;for(let a of t)if(a&&(i||(i=s(a,e.startLineNumber,e.startOrientation)),r||(r=s(a,e.endLineNumber,e.endOrientation)),(n=r&&!i)||i&&r))break;return n?{...e,startLineNumber:e.endLineNumber,startOrientation:e.endOrientation,endLineNumber:e.startLineNumber,endOrientation:e.startOrientation,firstSelectedLineNumber:e.endLineNumber}:e}function d(e,t,n){let i=`-${u(t)||"number"!=typeof t.left?"empty":t.left}`,r=n?`-${u(n)||"number"!=typeof n.right?"empty":n.right}`:"";return`${e}${i}${r}`}function c(e,t){return`${e}-${t}`}function u(e){return!!e&&e===a.s}function m(e){return!!e&&e!==a.s}function f(e){return"CONTEXT"===e.type}function h(e,t){let n;switch(t){case"ADDITION":n="+";break;case"DELETION":n="-";break;case"CONTEXT":case"INJECTED_CONTEXT":n=" "}if(!n||!e.startsWith(n))return[e,void 0];let i=e[0],r=e.substring(1);return[r,i]}function g(e){let t=[],n=[],i=()=>{for(;t.length<n.length;)t.push(a.s);for(;n.length<t.length;)n.push(a.s)};for(let r of e)switch(r.type){case"ADDITION":n.push(r);break;case"DELETION":t.push(r);break;case"CONTEXT":case"INJECTED_CONTEXT":case"HUNK":i(),t.push(r),n.push(r)}return i(),{leftLines:t,rightLines:n}}function p(e){return new DOMParser().parseFromString(e,"text/html").documentElement.textContent||""}function x({line:e,range:t,fileAnchor:n}){let i;let{origin:r,pathname:a}=window.location;if(t?i=(0,l.Lh)(t):e&&(i=function(e,t){let n=["HUNK","CONTEXT","INJECTED_CONTEXT","DELETION"].includes(e.type),i=n?e.left:e.right,r=n?"left":"right";if(null!==i)return(0,l.Lh)({diffAnchor:t,endLineNumber:i,endOrientation:r,startLineNumber:i,startOrientation:r,firstSelectedLineNumber:i,firstSelectedOrientation:r})}(e,n)),i)return`${r}${a}#${i}`}function y({includeControlKey:e=!0,includeShiftKey:t,includeOptionKey:n,key:i}){let a=e?`${(0,r.eE)()?"\u2318":"Ctrl + "}`:"";return n&&(a+=`${(0,r.eE)()?"\u2325":"Alt + "}`),t&&(a+=`${(0,r.eE)()?"\u21E7":"Shift + "}`),a+=i}function b({hasThreads:e}){return e?"96px":"30px"}function C({shouldAlignRight:e}){return e?"11px":"40px"}function j({includeControlKey:e=!0,includeShiftKey:t,includeOptionKey:n,key:i}){let a="";return e&&(a+=(0,r.eE)()?"Command+":"Control+"),n&&(a+=(0,r.eE)()?"Option+":"Alt+"),t&&(a+="Shift+"),a+=i}let N=["ADDITION","DELETION","CONTEXT"],v=(e,t)=>{if(!e)return!1;let n=t.leftLines.concat(t.rightLines);return n.length>0&&n.includes(e)?n.every(e=>!u(e)&&N.includes(e.type)):!u(e)&&N.includes(e.type)},S=e=>{if(!e)return"";let t=e.filter(e=>!u(e)).map(e=>{let t=p(e.html),[n]=h(t,e.type);return n});return t.join("\n")}},28771:(e,t,n)=>{n.d(t,{R:()=>a});var i=n(63451),r=n(67294);let a=e=>{let t=(0,r.useRef)(e);return(0,i.b)(()=>(t.current=e,()=>t.current=null),[e]),(0,r.useCallback)((...e)=>t.current?.(...e),[])}},85861:(e,t,n)=>{n.d(t,{C:()=>c,w:()=>d});var i=n(67294),r=n(18655),a=n(92086),l=n(59434),s=n(28771),o=n(79295);function d(e){let t=(0,o.aF)(e),n=(e.subject?.diffLines??[]).filter(e=>t?e.left&&e.left>=t.startLineNumber&&e.left<=t.endLineNumber||e.right&&e.right>=t.startLineNumber&&e.right<=t.endLineNumber:[]),i=n.every(e=>"DELETION"!==e.type),r=n?.map(e=>a.Tb(e.text,e.type)[0]).join("\n");return{isValidSuggestionRange:n.length>0&&!!i,showSuggestChangesButton:!1,sourceContentFromDiffLines:r,onInsertSuggestedChange:()=>{},shouldInsertSuggestedChange:!1}}function c(e,t,n){let{sendAnalyticsEvent:o}=(0,l.z)(),{getDiffLinesFromLineRange:d,selectedDiffRowRange:c}=(0,r.h)(),u=(0,s.R)(function(n,i){if(!e)return;let r=function(e){if(!e)return"DELETION"!==t.type;let n="right"===e.startOrientation&&"right"===e.endOrientation;if(n)return!0;let i=e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation;if(i)return"DELETION"!==t.type;let r=d(e)?.selectedLeftLines;return!!r?.every(e=>"empty-diff-line"!==e&&"DELETION"!==e.type)}(n);return{isValidSuggestionRange:r,showSuggestChangesButton:r,sourceContentFromDiffLines:r?function(e){let n=d(e)?.selectedRightLines;if(e&&n&&n.length>1)return(0,a.aS)(n);if(!t)return"";let[i]=(0,a.Tb)(t.text,t.type);return i}(n):void 0,onInsertSuggestedChange:()=>{o("diff.add_suggested_change","ADD_SUGGESTED_CHANGE_BUTTON")},shouldInsertSuggestedChange:i}});return(0,i.useMemo)(()=>({selectedDiffRowRange:c,configureSuggestedChangesFromLineRange:u,shouldStartNewConversationWithSuggestedChange:n}),[c,u,n])}},10764:(e,t,n)=>{n.d(t,{s:()=>i});let i="empty-diff-line"},87274:(e,t,n)=>{n.d(t,{C:()=>a,x:()=>r});var i=n(71207);let r=i.n4?.readyState==="interactive"||i.n4?.readyState==="complete"?Promise.resolve():new Promise(e=>{i.n4?.addEventListener("DOMContentLoaded",()=>{e()})}),a=i.n4?.readyState==="complete"?Promise.resolve():new Promise(e=>{i.iG?.addEventListener("load",e)})},18515:(e,t,n)=>{n.d(t,{$:()=>d,c:()=>o});var i=n(15205),r=n(40578),a=n(71207);function l(){let e=(0,r.dU)().featureFlags,t=e.map(e=>e.toUpperCase());return new Set(t)}let s=a.W6?l:(0,i.Z)(l);function o(e){return s().has(e.toUpperCase())}let d={isFeatureEnabled:o}},40940:(e,t,n)=>{n.d(t,{I:()=>r});var i=n(67294);let r=(0,i.createContext)(null)},7533:(e,t,n)=>{n.d(t,{l:()=>r});var i=n(12599);function r(e={}){let t;let n=(0,i.lX)({...e,v5Compat:!0}),r=[],a=!1;function l(e){if(r.length>0)for(let t of r)t({retry(){e()}});else e()}return n.listen(e=>{if(a){a=!1;return}if(e.action===i.aU.Pop&&r.length&&null!==e.delta&&r.length>0){let t=e.delta;for(let e of(a=!0,n.go(-1*t),r))e({retry(){n.go(t)}})}else t?.(e)}),{get action(){return n.action},get location(){return n.location},createHref:e=>n.createHref(e),createURL:e=>n.createURL(e),encodeLocation:e=>n.encodeLocation(e),push(e,t){l(()=>n.push(e,t))},replace(e,t){l(()=>n.replace(e,t))},go(e){l(()=>n.go(e))},listen(e){if(t)throw Error("A history only accepts one active listener");return t=e,()=>{t=void 0}},block:e=>(r.push(e),()=>{r=r.filter(t=>t!==e)})}}},18448:(e,t,n)=>{n.d(t,{t:()=>i});let i={"Workers not ready":"Alloy is warming its workers. This is expected during deploys and should resolve shortly."}},76888:(e,t,n)=>{let i;n.d(t,{Z:()=>s});var r=n(67294);let a=globalThis.document;function l(e){let t=e.colorMode;return{colorMode:function(e){switch(e){case"light":return"day";case"dark":return"night";default:return"auto"}}(t),dayScheme:e.lightTheme,nightScheme:e.darkTheme}}let s=a?function(){let{documentElement:e}=a,[t,n]=(0,r.useState)(()=>l(e.dataset));return(0,r.useEffect)(()=>{let t=new MutationObserver(()=>n(l(e.dataset)));return t.observe(e,{attributes:!0,attributeFilter:["data-color-mode","data-light-theme","data-dark-theme"]}),()=>t.disconnect()},[e]),t}:function(){return l(i||{})}},54508:(e,t,n)=>{n.d(t,{A:()=>s,k:()=>l});var i=n(15205),r=n(71207);let a=(0,i.Z)(function(){return r.n4?.head?.querySelector('meta[name="runtime-environment"]')?.content||""}),l=(0,i.Z)(function(){return"enterprise"===a()}),s="webpack"},56363:(e,t,n)=>{n.d(t,{Z:()=>l,_:()=>s});var i=n(71207),r=n(43786);let a=class NoOpStorage{getItem(){return null}setItem(){}removeItem(){}clear(){}key(){return null}get length(){return 0}};function l(e,t={throwQuotaErrorsOnSet:!1},n=i.iG,l=e=>e,s=e=>e){let o;try{if(!n)throw Error();o=n[e]||new a}catch{o=new a}let{throwQuotaErrorsOnSet:d}=t;function c(e){t.sendCacheStats&&(0,r.b)({incrementKey:e})}function u(e){try{if(o.removeItem(e),t.ttl){let t=`${e}:expiry`;o.removeItem(t)}}catch(e){}}return{getItem:function(e,t=new Date().getTime()){try{let n=o.getItem(e);if(!n)return null;let i=`${e}:expiry`,r=Number(o.getItem(i));if(r&&t>r)return u(e),u(i),c("SAFE_STORAGE_VALUE_EXPIRED"),null;return c("SAFE_STORAGE_VALUE_WITHIN_TTL"),l(n)}catch(e){return null}},setItem:function(e,n,i=new Date().getTime()){try{if(o.setItem(e,s(n)),t.ttl){let n=`${e}:expiry`,r=i+t.ttl;o.setItem(n,r.toString())}}catch(e){if(d&&e instanceof Error&&e.message.toLowerCase().includes("quota"))throw e}},removeItem:u,clear:o.clear,key:o.key,get length(){return o.length}}}function s(e){return l(e,{throwQuotaErrorsOnSet:!1},i.iG,JSON.parse,JSON.stringify)}},71207:(e,t,n)=>{n.d(t,{Qg:()=>i.Qg,W6:()=>i.W6,cF:()=>i.cF,iG:()=>r.iG,n4:()=>r.n4,ssrSafeLocation:()=>r.jX,zu:()=>r.zu});var i=n(60327),r=n(66199)},66199:(e,t,n)=>{n.d(t,{iG:()=>r,jX:()=>l,n4:()=>i,zu:()=>a});let i="undefined"==typeof document?void 0:document,r="undefined"==typeof window?void 0:window,a="undefined"==typeof history?void 0:history,l="undefined"==typeof location?{pathname:"",origin:"",search:"",hash:""}:location},60327:(e,t,n)=>{n.d(t,{Qg:()=>a,W6:()=>r,cF:()=>l});var i=n(66199);let r=void 0===i.n4,a=!r;function l(){return!!r||!!i.n4.querySelector('react-app[data-ssr="true"]')}},43786:(e,t,n)=>{n.d(t,{B:()=>m,b:()=>o});var i=n(71207),r=n(87274),a=n(54508),l=n(18515);let s=[];function o(e,t=!1,n=1){if(!0!==(0,l.c)("BROWSER_STATS_DISABLED")){if(n<0||n>1)throw RangeError("Sampling probability must be between 0 and 1");void 0===e.timestamp&&(e.timestamp=new Date().getTime()),e.loggedIn=!!i.n4?.head?.querySelector('meta[name="user-login"]')?.content,e.staff=m(),e.bundler=a.A,Math.random()<n&&s.push(e),t?u():c()}}let d=null;async function c(){await r.C,null==d&&(d=window.requestIdleCallback(u))}function u(){if(d=null,!s.length)return;let e=i.n4?.head?.querySelector('meta[name="browser-stats-url"]')?.content;if(!e)return;let t=function(e){let t=[],n=e.map(e=>JSON.stringify(e));for(;n.length>0;)t.push(function(e){let t=e.shift(),n=[t],i=t.length;for(;e.length>0&&i<=65536;){let t=e[0].length;if(i+t<=65536){let r=e.shift();n.push(r),i+=t}else break}return n}(n));return t}(s);for(let n of t)!function(e,t){try{navigator.sendBeacon&&navigator.sendBeacon(e,t)}catch{}}(e,`{"stats": [${n.join(",")}] }`);s=[]}function m(){return!!i.n4?.head?.querySelector('meta[name="user-staff"]')?.content}i.n4?.addEventListener("pagehide",u),i.n4?.addEventListener("visibilitychange",u)},63987:(e,t,n)=>{n.d(t,{L:()=>a});var i=n(85893),r=n(20756);function a({status:e,oid:t,repo:n,badgeProps:a={},descriptionString:l=""}){let[s,o]=(0,r.fQ)(t,n);return e?(0,i.jsx)(r.vC,{disablePopover:!1,size:"small",statusRollup:e,buttonSx:{height:"18px",color:"fg.muted",p:0},combinedStatus:s,descriptionText:l,onWillOpenPopup:o,...a}):null}try{a.displayName||(a.displayName="AsyncChecksStatusBadge")}catch{}},47422:(e,t,n)=>{n.d(t,{C:()=>l});var i=n(85893),r=n(53924),a=n(91863);function l({commit:e,repo:t,children:n,settings:l}){return(0,i.jsxs)(r.C,{authors:e.authors,committer:e.committer,committerAttribution:e.committerAttribution,repo:t,includeVerbs:!0,authorSettings:{fontWeight:"normal",fontColor:"fg.muted",avatarSize:16,...l},children:[(0,i.jsx)(a.Z,{sx:{pl:1},datetime:e.committedDate,tense:"past"}),n]})}try{l.displayName||(l.displayName="CommitAttribution")}catch{}},20748:(e,t,n)=>{n.d(t,{c:()=>f});var i=n(85893),r=n(85529),a=n(98833),l=n(92582),s=n(75308);let o={none:{},bottom:{pb:0},top:{pt:0}},d=()=>(0,i.jsx)(a.Z,{icon:r.GitCommitIcon}),c={height:"16px",mt:2};function u({children:e,leadingVisual:t,clipTimeline:n="none",sx:r={}}){let a=o[n],s=t||["bottom","top"].includes(n)?{}:c;return(0,i.jsxs)(l.Z.Item,{sx:{ml:5,py:"12px",...a,...r},children:[(0,i.jsx)(l.Z.Badge,{sx:{backgroundColor:"canvas.default",mr:0,...s},children:t??(0,i.jsx)(d,{})}),(0,i.jsx)(l.Z.Body,{sx:{mt:0},children:e})]})}function m({title:e,as:t,...n}){return(0,i.jsx)(s.Z,{as:t,sx:{fontWeight:"normal",fontSize:1,px:2,py:1},...n,children:e})}let f=Object.assign(u,{Heading:m});try{d.displayName||(d.displayName="DefaultLeadingVisual")}catch{}try{u.displayName||(u.displayName="TimelineRowComponent")}catch{}try{m.displayName||(m.displayName="TimelineRowHeading")}catch{}try{f.displayName||(f.displayName="TimelineRow")}catch{}},99318:(e,t,n)=>{n.d(t,{s:()=>r});var i=n(85893);function r({children:e,className:t=""}){return(0,i.jsx)("div",{className:`border rounded-2 color-border-muted d-flex flex-column ${t}`,children:e})}try{r.displayName||(r.displayName="Panel")}catch{}},21449:(e,t,n)=>{n.d(t,{E3:()=>u,EZ:()=>d,Hp:()=>o,Mh:()=>a,NN:()=>c,wI:()=>l});var i=n(85893),r=n(67294);let a={deferredCommits:[],renameHistory:null,loading:!0},l={deferredCommits:[],renameHistory:null,loading:!1},s=(0,r.createContext)(a);function o({children:e,deferredData:t}){return(0,i.jsx)(s.Provider,{value:t,children:e})}function d(e){let t=(0,r.useContext)(s);return t.deferredCommits?.find(t=>t.oid===e)}function c(){let e=(0,r.useContext)(s);return e.loading}function u(){let e=(0,r.useContext)(s);return e.renameHistory}try{s.displayName||(s.displayName="DeferredCommitDataContext")}catch{}try{o.displayName||(o.displayName="DeferredCommitDataProvider")}catch{}},10227:(e,t,n)=>{n.d(t,{h:()=>Z});var i=n(85893),r=n(12461),a=n(67294),l=n(99318),s=n(80810),o=n(20756),d=n(22326),c=n(75299),u=n(21449),m=n(47422),f=n(77461),h=n(7949),g=n(85529),p=n(65379),x=n(88216),y=n(24167);let b=a.memo(C);function C({repo:e,oid:t}){let n=`browse-repo-${(0,y.Q)(t)}`;return(0,i.jsx)(p.Z,{"aria-label":"Browse repository at this point",id:n,direction:"sw",children:(0,i.jsx)("a",{"aria-labelledby":n,href:(0,d.Qi)({repo:e,action:"tree",commitish:t}),className:"Button Button--iconOnly Button--invisible Button--small","data-testid":"commit-row-browse-repo",children:(0,i.jsx)(g.CodeIcon,{})})})}let j=a.memo(N);function N({repo:e,oid:t,path:n}){if(!n)return null;let r=`view-code-${(0,y.Q)(t)}`;return(0,i.jsx)(p.Z,{"aria-label":"View code at this point",id:r,direction:"sw",children:(0,i.jsx)("a",{"aria-labelledby":r,href:(0,d.C9)({owner:e.ownerLogin,repo:e.name,commitish:t,filePath:n}),className:"Button Button--iconOnly Button--invisible Button--small","data-testid":"commit-row-view-code",children:(0,i.jsx)(g.FileCodeIcon,{})})})}function v({buildCommitPath:e=d.jP,repo:t,oid:n}){let r=(0,h.y)("diff_ux_refresh"),a=e({owner:t.ownerLogin,repo:t.name,commitish:n}),l={variant:"invisible",size:"small",sx:{fontFamily:"var(--fontStack-monospace)",color:"fg.muted"}};return(0,i.jsx)(p.Z,{"aria-label":"View commit details",direction:"s",children:r?(0,i.jsx)(x.r,{as:f.r,to:a,...l,children:(0,y.Q)(n)}):(0,i.jsx)("a",{className:"Button--invisible Button--small Button text-mono",href:a,...l,children:(0,i.jsx)("span",{className:"Button-content",children:(0,i.jsx)("span",{className:"Button-label color-fg-muted",children:(0,y.Q)(n)})})})})}function S({showDescription:e,setShowDescription:t,oid:n}){let r=(0,y.Q)(n),a=`show-description-${r}`;return(0,i.jsx)(p.Z,{"aria-label":`${e?"Hide":"Show"} description for ${r}`,id:a,direction:"se",className:"ml-1",children:(0,i.jsx)("button",{className:"Button Button--iconOnly Button--invisible Button--small","data-testid":"commit-row-show-description-button","aria-labelledby":a,"aria-pressed":e,"aria-expanded":e,onClick:n=>{n.preventDefault(),t(!e)},children:(0,i.jsx)(g.EllipsisIcon,{})})})}function L({count:e,repo:t,oid:n}){let r=`comment-count-${(0,y.Q)(n)}`;return e?(0,i.jsx)(p.Z,{"aria-label":`View ${e} commit comment${e>1?"s":""}`,id:r,direction:"sw",children:(0,i.jsx)("a",{"aria-labelledby":r,href:`${(0,d.jP)({owner:t.ownerLogin,repo:t.name,commitish:n})}#comments`,className:"Button Button--invisible Button--small","data-testid":"commit-row-comments",children:(0,i.jsxs)("span",{className:"Button-content color-fg-muted",children:[(0,i.jsx)(g.CommentIcon,{}),(0,i.jsx)("span",{className:"Button-label",children:e})]})})}):null}try{b.displayName||(b.displayName="BrowseRepositoryAtThisPoint")}catch{}try{C.displayName||(C.displayName="WrappedBrowseRepositoryAtThisPoint")}catch{}try{j.displayName||(j.displayName="ViewCodeAtThisPoint")}catch{}try{N.displayName||(N.displayName="WrappedViewCodeAtThisPoint")}catch{}try{v.displayName||(v.displayName="ViewCommitDetails")}catch{}try{S.displayName||(S.displayName="ToggleCommitDescription")}catch{}try{L.displayName||(L.displayName="CommitCommentCount")}catch{}var k=n(54421),w=n(46008),I=n(42483),E=n(8152),D=n(63987);let T="62px";function R({deferredData:e}){let{helpUrl:t}=(0,E.J)(),n=(0,u.NN)();return(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsx)(w.o,{variant:"rounded",sx:{display:["none","flex"],width:T}}),!n&&e&&(0,i.jsx)(k.G,{commitOid:e.oid,hasSignature:!0,verificationStatus:e.verifiedStatus,signature:{helpUrl:t,...e.signatureInformation}})]})}function O({deferredData:e,oid:t,repository:n}){let r=(0,u.NN)(),a="";try{a=e?.statusCheckStatus?.short_text?.split("checks")[0]?.trim()||""}catch{}return(0,i.jsxs)(i.Fragment,{children:[r&&(0,i.jsx)(w.o,{variant:"rounded",sx:{display:["none","flex"],width:"20px"}}),!r&&e?.statusCheckStatus&&(0,i.jsx)(I.Z,{sx:{display:["none","inherit"],ml:1},children:"\xb7"}),(0,i.jsx)(I.Z,{sx:{display:["none","inherit"]},children:(0,i.jsx)(D.L,{oid:t,status:e?.statusCheckStatus?.state,descriptionString:a,repo:n})})]})}try{R.displayName||(R.displayName="SignedCommitBadge")}catch{}try{O.displayName||(O.displayName="CommitChecksStatusBadge")}catch{}var A=n(14136),_=n(24815);function F({message:e,id:t,contentRef:n,clearMessage:r,portalTooltipProps:a}){return e?(0,i.jsx)(_.u,{id:t,contentRef:n,"aria-label":e,open:!!e,onMouseLeave:r,"aria-live":"assertive",...a}):null}try{F.displayName||(F.displayName="AlertTooltip")}catch{}function P({sha:e}){let t=`Copy full SHA for ${(0,y.Q)(e)}`,[n,r]=(0,a.useState)(!1),l=(0,a.useRef)(null),[s,o,d]=function(e,t,n){let[r,l]=(0,a.useState)(""),s=(0,a.useCallback)(()=>{l("")},[]),o=(0,a.useCallback)(e=>{l(e)},[]);return[o,s,(0,i.jsx)(F,{message:r,id:e,contentRef:t,clearMessage:s,portalTooltipProps:n},e)]}("copy-sha-tooltip",l,{direction:"s",anchorSide:"outside-bottom"}),c=(0,a.useCallback)(()=>{(0,A.z)(e),r(!0),s("Copied SHA!"),setTimeout(()=>{r(!1),o()},2e3)},[e,s,o]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{className:"Button Button--iconOnly Button--invisible Button--small","aria-label":t,onClick:c,ref:l,onFocus:()=>s(t),onMouseEnter:()=>s(t),onMouseLeave:o,onBlur:o,"data-testid":"copy-full-sha-button",children:n?(0,i.jsx)(g.CheckIcon,{}):(0,i.jsx)(g.CopyIcon,{})}),d]})}try{P.displayName||(P.displayName="CopySHA")}catch{}let M=(0,a.lazy)(()=>n.e("ui_packages_commits_components_Commits_CommitActionBar_tsx").then(n.bind(n,5703)).then(e=>({default:e.CommitActionBar})));function $({buildCommitPath:e,commit:t,repo:n,path:l}){let[f,h]=(0,a.useState)(!1),g=(0,a.useRef)(null),p=(0,d.jP)({owner:n.ownerLogin,repo:n.name,commitish:t.oid}),[x,y]=(0,o.fQ)(t.oid,n),[C,N]=(0,a.useState)(!1),k=(0,u.EZ)(t.oid);return(0,a.useEffect)(()=>{f&&g.current&&g.current.textContent&&(0,s.x)(g.current.textContent)},[g,f]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.HC,{"data-testid":"commit-row-item",sx:{":first-child":{borderTopLeftRadius:2,borderTopRightRadius:2},":last-child":{borderBottomLeftRadius:2,borderBottomRightRadius:2}},title:(0,i.jsx)(r.HC.Title,{value:t.shortMessage,markdownValue:t.shortMessageMarkdownLink,href:p,containerSx:{display:"inline"},headerSx:{display:"inline"},children:t.bodyMessageHtml&&(0,i.jsx)(S,{showDescription:f,setShowDescription:h,oid:t.oid})}),metadata:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.HC.Metadata,{children:(0,i.jsx)(L,{oid:t.oid,repo:n,count:k?.commentCount??0})}),(0,i.jsx)(r.HC.Metadata,{sx:{minWidth:T},children:(0,i.jsx)(R,{deferredData:k})}),(0,i.jsxs)(r.HC.Metadata,{variant:"primary",sx:{px:0,display:["none","flex"],gap:2},children:[(0,i.jsxs)("div",{className:"d-flex",children:[(0,i.jsx)(v,{buildCommitPath:e,oid:t.oid,repo:n}),(0,i.jsx)(P,{sha:t.oid})]}),(0,i.jsx)(j,{repo:n,oid:t.oid,path:l}),(0,i.jsx)(b,{repo:n,oid:t.oid})]})]}),secondaryActions:(0,i.jsx)(a.Suspense,{children:(0,i.jsx)(M,{buildCommitPath:e,commit:t,repo:n,path:l,setDialogOpen:N,fetchCheckDetails:y,deferredData:k})}),children:[(0,i.jsx)("div",{className:"px-2"}),(0,i.jsxs)(r.HC.MainContent,{children:[f&&t.bodyMessageHtml&&(0,i.jsx)(r.HC.Description,{children:(0,i.jsx)(c.WZ,{ref:g,html:t.bodyMessageHtml,className:"ws-pre-wrap extended-commit-description-container",sx:{pb:2,wordBreak:"break-word",fontFamily:"var(--fontStack-monospace)"}})}),(0,i.jsx)(r.HC.Description,{children:(0,i.jsx)(m.C,{commit:t,repo:n,children:(0,i.jsx)(O,{repository:n,deferredData:k,oid:t.oid})})})]})]}),k?.statusCheckStatus&&C&&(0,i.jsx)(o.AF,{combinedStatus:x,isOpen:C,onDismiss:()=>{N(!1)}})]})}try{M.displayName||(M.displayName="CommitActionBar")}catch{}try{$.displayName||($.displayName="CommitRow")}catch{}var B=n(20748);function U({buildCommitPath:e,commits:t,title:n,shouldClipTimeline:s,repo:o,currentBlobPath:d=""}){let c=(0,a.useId)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(B.c,{clipTimeline:s?"top":"none",children:(0,i.jsx)(B.c.Heading,{as:"h3",id:c,title:`Commits on ${n}`,"data-testid":"commit-group-title"})}),(0,i.jsx)(l.s,{children:(0,i.jsx)(r.Bv,{title:n,titleHeaderTag:"h3",ariaLabelledBy:c,children:t.map(t=>(0,i.jsx)($,{buildCommitPath:e,commit:t,repo:o,path:d},t.oid))},n)})]})}try{U.displayName||(U.displayName="CommitGroup")}catch{}function Z({buildCommitPath:e,leadingContent:t,commitGroups:n,trailingContent:r,deferredCommitData:a=u.wI,repository:l,currentBlobPath:s,shouldClipTimeline:o=!0}){return(0,i.jsxs)(u.Hp,{deferredData:a,children:[t,n.map((t,n)=>(0,i.jsx)(U,{title:t.title,buildCommitPath:e,commits:t.commits,shouldClipTimeline:o&&0===n,currentBlobPath:s,repo:l},t.title)),r]})}try{Z.displayName||(Z.displayName="Commits")}catch{}},98399:(e,t,n)=>{n.d(t,{q:()=>g});var i=n(85893),r=n(12159),a=n(79804),l=n(85529),s=n(98833),o=n(42483),d=n(97011),c=n(79902),u=n(88216),m=n(43360),f=n(26004);let h={[m.A.Failure]:(0,i.jsx)(s.Z,{icon:l.StopIcon,sx:{fill:"danger.fg"}}),[m.A.Warning]:(0,i.jsx)(s.Z,{icon:l.AlertIcon,sx:{fill:"attention.fg"}}),[m.A.Notice]:(0,i.jsx)(s.Z,{icon:l.InfoIcon,sx:{fill:"fg.muted"}})};function g({annotation:e,ghostUser:t=r.H.ghostUser}){let n=e.checkSuite.app;return(0,i.jsxs)(o.Z,{sx:{borderLeft:"6px solid",borderColor:f.kQ[e.annotationLevel].primaryColor,p:4},children:[(0,i.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",mb:2},children:[h[e.annotationLevel],(0,i.jsx)(d.Z,{sx:{fontWeight:600,color:"fg.muted",fontSize:0,pl:2},children:f.kQ[e.annotationLevel].ariaLabel})]}),(0,i.jsx)(d.Z,{sx:{color:f.kQ[e.annotationLevel].primaryColor,fontWeight:600,fontSize:1},children:e.title}),(0,i.jsx)(o.Z,{sx:{mb:3,mt:1},children:e.message&&(0,i.jsx)(d.Z,{sx:{fontFamily:"var(--fontStack-monospace)",fontSize:0,display:"-webkit-box",overflow:"hidden","-webkit-box-orient":"vertical","-webkit-line-clamp":"8",maxWidth:"unset"},children:e.message})}),(0,i.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsxs)(o.Z,{sx:{flexGrow:2},children:[(0,i.jsx)(a.O,{src:n?.logoUrl??t.avatarUrl,alt:`${n?.name??t.login} avatar image`,"data-testid":"check-suite-app-avatar"}),(0,i.jsxs)(c.Z,{sx:{ml:2,maxWidth:"300px"},inline:!0,title:`${e.checkSuite.name} / ${e.checkRun.name}`,children:[(0,i.jsx)(d.Z,{sx:{fontWeight:600,fontSize:0},children:e.checkSuite.name})," /"," ",(0,i.jsx)(d.Z,{sx:{fontSize:0},children:e.checkRun.name})]})]}),e.checkRun.detailsUrl&&(0,i.jsx)(u.r,{as:"a",href:e.checkRun.detailsUrl,size:"small",children:"View details"})]})]})}try{g.displayName||(g.displayName="Annotation")}catch{}},26004:(e,t,n)=>{n.d(t,{CU:()=>o,kQ:()=>d,rD:()=>l});var i=n(85893),r=n(15388),a=n(43360);function l({annotationLevel:e,...t}){let{icon:n,...r}=d[e];return function({fill:e,stroke:t,ariaLabel:n,svgHtml:r,className:a}){return(0,i.jsx)("svg",{"aria-label":n,className:a,fill:e,height:"24",stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",style:{boxShadow:"none"},viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:r})}({...n,...r,...t})}let s=(0,r.F4)`
  0% {opacity: 0;}
  100% {opacity: 1;}
`,o=(0,r.ZP)(l).withConfig({displayName:"AnnotationIcon__AnimatedAnnotationIcon",componentId:"sc-306ab24a-0"})`
  animation: ${s} 0.1s ease-in;
`,d={[a.A.Failure]:{priority:1,ariaLabel:"Check failure",primaryColor:"danger.fg",icon:{fill:"var(--bgColor-danger-emphasis, var(--color-danger-emphasis))",stroke:"var(--fgColor-onEmphasis, var(--color-fg-on-emphasis))",svgHtml:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("line",{x1:"15",x2:"9",y1:"9",y2:"15"}),(0,i.jsx)("line",{x1:"9",x2:"15",y1:"9",y2:"15"})]})}},[a.A.Warning]:{priority:2,ariaLabel:"Check warning",primaryColor:"attention.fg",icon:{fill:"var(--bgColor-attention-emphasis, var(--color-attention-emphasis))",stroke:"var(--fgColor-onEmphasis, var(--color-fg-on-emphasis))",svgHtml:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("line",{x1:"12",x2:"12",y1:"8",y2:"12"}),(0,i.jsx)("line",{x1:"12",x2:"12",y1:"16",y2:"16"})]})}},[a.A.Notice]:{priority:3,ariaLabel:"Check notice",primaryColor:"fg.muted",icon:{fill:"var(--bgColor-neutral-emphasis, var(--color-neutral-emphasis))",stroke:"var(--fgColor-onEmphasis, var(--color-fg-on-emphasis))",svgHtml:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("line",{x1:"12",x2:"12",y1:"16",y2:"12"}),(0,i.jsx)("line",{x1:"12",x2:"12",y1:"8",y2:"8"})]})}}};try{l.displayName||(l.displayName="AnnotationIcon")}catch{}try{o.displayName||(o.displayName="AnimatedAnnotationIcon")}catch{}},40516:(e,t,n)=>{n.d(t,{n:()=>h});var i=n(85893),r=n(80855),a=n(96463),l=n(67294),s=n(22578),o=n(75170);let d=n(16790),c=n(93212),u=n(19236),m=e=>{let{viewer:t}=(0,s.useLazyLoadQuery)(d,{});return t.isCopilotDotcomChatEnabled?(0,i.jsx)(f,{...e}):null},f=({Component:e,componentProps:t,queryVariables:n})=>{let{pullRequest:a}=(0,s.useLazyLoadQuery)(c,n),{diffEntry:l}=(0,s.useLazyLoadQuery)(u,n);(0,r.q)(a?.comparison),(0,r.q)(l);let d=(0,o.U)(a.comparison,l);return d?(0,i.jsx)(e,{fileDiffReference:d,...t}):null},h=({Component:e,componentProps:t,queryVariables:n,errorFallback:r=null,suspenseFallback:s=null})=>(0,i.jsx)(a.S,{fallback:r,children:(0,i.jsx)(l.Suspense,{fallback:s,children:(0,i.jsx)(m,{Component:e,componentProps:t,queryVariables:n})})});try{f.displayName||(f.displayName="CopilotCodeChatReferenceLoader")}catch{}try{h.displayName||(h.displayName="DiffChatWrapper")}catch{}},96797:(e,t,n)=>{n.d(t,{l:()=>o});var i=n(85893),r=n(51927),a=n(79697),l=n(88049),s=n(14786);let o=({fileDiffReference:e,eventContext:t,afterSelect:n})=>{let{addToast:o}=(0,l.V6)();return(0,i.jsx)(s.S.Item,{onSelect:()=>{(0,r.cw)(e),o({message:"Reference added to thread",type:"success"}),(0,a.qP)("copilot.file-diff.add",t),n?.()},children:"Attach to current thread"})};try{o.displayName||(o.displayName="DiffLinesAttachMenuItem")}catch{}},44042:(e,t,n)=>{n.d(t,{u:()=>d});var i=n(85893),r=n(51927),a=n(85355),l=n(18515),s=n(79697),o=n(14786);let d=({fileDiffReference:e,leadingVisual:t,eventContext:n,afterSelect:d})=>(0,i.jsxs)(o.S.Item,{onSelect:()=>{(0,r.L4)({intent:(0,l.c)("copilot_chat_remove_file_diff_intent")?a.A9.conversation:a.A9.discussFileDiff,references:[e]}),(0,s.qP)("copilot.file-diff.discuss",n),d?.()},children:[t&&(0,i.jsx)(o.S.LeadingVisual,{children:t}),"Ask about this diff"]});try{d.displayName||(d.displayName="DiffLinesDiscussMenuItem")}catch{}},93498:(e,t,n)=>{n.d(t,{m:()=>o});var i=n(85893),r=n(51927),a=n(85355),l=n(79697),s=n(14786);let o=({fileDiffReference:e,eventContext:t,afterSelect:n})=>(0,i.jsx)(s.S.Item,{onSelect:()=>{(0,r.L4)({content:"Explain",intent:a.A9.explainFileDiff,references:[e]}),(0,l.qP)("copilot.file-diff.explain",t),n?.()},children:"Explain"});try{o.displayName||(o.displayName="DiffLinesExplainMenuItem")}catch{}},25803:(e,t,n)=>{n.d(t,{Fh:()=>h,LG:()=>g,ir:()=>f});var i=n(85893),r=n(85529),a=n(51526),l=n(45677),s=n(50919),o=n(74121),d=n(14786),c=n(67294),u=n(86010);let m={filterLoadingHeight:"FileFilter-module__filterLoadingHeight--cW8BP"},f="No extension";function h({filterText:e,onFilterTextChange:t}){return(0,i.jsxs)("div",{className:"d-flex flex-nowrap gap-2",children:[(0,i.jsx)(a.Z,{block:!0,"aria-label":"Filter files\u2026",leadingVisual:r.SearchIcon,placeholder:"Filter files\u2026",value:e,onChange:e=>t?.(e.target.value)}),(0,i.jsxs)(l.P,{children:[(0,i.jsx)(l.P.Anchor,{children:(0,i.jsx)(s.h,{"aria-label":"Filter",icon:r.SlidersIcon,className:"flex-shrink-0"})}),(0,i.jsx)(l.P.Overlay,{className:(0,u.Z)(m.filterLoadingHeight),children:(0,i.jsx)("div",{className:(0,u.Z)("d-flex","flex-column","flex-justify-center","flex-items-center",m.filterLoadingHeight),children:(0,i.jsx)(o.Z,{size:"medium"})})})]})]})}function g({filterText:e,onFilterTextChange:t,fileExtensions:n,unselectedFileExtensions:o,onFilterChange:u,additionalFilterGroups:m}){let[h,g]=(0,c.useState)(e),p=(e,t)=>{u?.(e?"selectFileExtension":"unselectFileExtension",{extension:t})},x=Array.from(n||[]).filter(e=>e!==f).sort(),y=e=>!o?.has(e),b=n?.has(f);return(0,i.jsxs)("div",{className:"d-flex flex-nowrap gap-2",children:[(0,i.jsx)(a.Z,{block:!0,"aria-label":"Filter files\u2026",leadingVisual:r.SearchIcon,placeholder:"Filter files\u2026",value:h,onChange:e=>{g(e.target.value),t?.(e.target.value)}}),(0,i.jsxs)(l.P,{children:[(0,i.jsx)(l.P.Anchor,{children:(0,i.jsx)(s.h,{"aria-label":"Filter",icon:r.SlidersIcon,className:"flex-shrink-0"})}),(0,i.jsx)(l.P.Overlay,{children:(0,i.jsxs)(d.S,{children:[(0,i.jsxs)(d.S.Group,{selectionVariant:"multiple",title:"File extensions",children:[x.map(e=>{let t=y(e);return(0,i.jsx)(d.S.Item,{selected:t,onSelect:()=>p(!t,e),children:`${e}`},e)}),b&&(0,i.jsx)(d.S.Item,{selected:y(f),onSelect:()=>p(!y(f),f),children:f},f)]}),m]})})]})]})}try{h.displayName||(h.displayName="FileFilterLoading")}catch{}try{g.displayName||(g.displayName="FileFilterShared")}catch{}},18655:(e,t,n)=>{n.d(t,{h:()=>m,j:()=>h});var i=n(85893),r=n(80810),a=n(71207),l=n(67294),s=n(8358),o=n(59889),d=n(28771),c=n(92086);let u=(0,l.createContext)(null);function m(){let e=(0,l.useContext)(u);if(!e)throw Error("useSelectedDiffRowRange must be used within a SelectedDiffRowRangeContext");return e}function f(e){let t=e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation;t?(0,r.x)(`${"left"===e.startOrientation?"L":"R"}${e.startLineNumber} selected.`):(0,r.x)(`${"left"===e.startOrientation?"L":"R"}${e.startLineNumber} to ${"left"===e.endOrientation?"L":"R"}${e.endLineNumber} selected.`)}function h({children:e}){let t=(0,l.useRef)(new Map),n=(0,d.R)(e=>{if(!e)return;let n=e.diffAnchor,i=t.current.get(n);if(!i)return;let{leftLines:r,rightLines:a}=(0,c.Ek)(i);return(0,s.Z)({selectedDiffRowRange:e,leftLines:r,rightLines:a})}),[m,h]=(0,l.useState)(()=>(0,o.rn)(a.ssrSafeLocation.hash)),[g,p]=(0,l.useState)(()=>{if(m){let e=n(m);if(e)return{leftLines:e.selectedLeftLines,rightLines:e.selectedRightLines||[]}}return{leftLines:[],rightLines:[]}}),x=(0,d.R)(e=>{let t=n(e),i=t?{leftLines:t.selectedLeftLines,rightLines:t.selectedRightLines||[]}:{leftLines:[],rightLines:[]};p(i)}),y=(0,d.R)((e,t,n,i)=>{if(!t||!n)return;let r=i&&m&&m.diffAnchor===e?t<=m.firstSelectedLineNumber?{...m,startLineNumber:t,startOrientation:n,endLineNumber:m.firstSelectedLineNumber,endOrientation:m.firstSelectedOrientation}:{...m,startLineNumber:m.firstSelectedLineNumber,startOrientation:m.firstSelectedOrientation,endLineNumber:t,endOrientation:n}:{diffAnchor:e,endLineNumber:t,endOrientation:n,startLineNumber:t,startOrientation:n,firstSelectedLineNumber:t,firstSelectedOrientation:n};f(r),h(r),x(r),(0,o.fI)(r)}),b=(0,d.R)(e=>{f(e),h(e),x(e),(0,o.fI)(e)}),C=(0,d.R)(({diffAnchor:e,startGridCell:t,endGridCell:n,focusedGridCell:i})=>{b({diffAnchor:e,endLineNumber:n.lineNumber,endOrientation:n.orientation,firstSelectedLineNumber:i.lineNumber,firstSelectedOrientation:i.orientation,startLineNumber:t.lineNumber,startOrientation:t.orientation})}),j=(0,d.R)(()=>{m&&(h(void 0),x(void 0),(0,r.x)("Selection Cleared"),history.replaceState({},"",window.location.pathname+window.location.search))}),N=(0,d.R)((e,n)=>{t.current.set(e,n),m?.diffAnchor===e&&x(m)}),v=(0,d.R)(e=>t.current.get(e)),S=(0,l.useMemo)(()=>({selectedDiffRowRange:m,updateSelectedDiffRowRange:y,clearSelectedDiffRowRange:j,replaceSelectedDiffRowRange:b,replaceSelectedDiffRowRangeFromGridCells:C,updateDiffLines:N,selectedDiffLines:g,getDiffLinesFromLineRange:n,getDiffLinesByDiffAnchor:v}),[m,y,j,b,C,g,N,n,v]);return(0,i.jsx)(u.Provider,{value:S,children:e})}try{u.displayName||(u.displayName="SelectedDiffRowRange")}catch{}try{h.displayName||(h.displayName="SelectedDiffRowRangeContextProvider")}catch{}},73216:(e,t,n)=>{n.d(t,{i:()=>l});var i=n(85893),r=n(67294),a=n(40940);function l({routes:e,history:t,children:n}){let l=(0,r.useMemo)(()=>({routes:e,history:t}),[e,t]);return(0,i.jsx)(a.I.Provider,{value:l,children:n})}try{l.displayName||(l.displayName="AppContextProvider")}catch{}},66629:(e,t,n)=>{n.d(t,{R:()=>c});var i=n(85893),r=n(18),a=n(8386),l=n(76888),s=n(88049),o=n(47658);let d={};function c({appName:e,children:t,wasServerRendered:n}){let{colorMode:c,dayScheme:u,nightScheme:m}=(0,l.Z)();return(0,i.jsx)(r.DJ,{wasServerRendered:n,children:(0,i.jsx)(o.n,{appName:e,category:"",metadata:d,children:(0,i.jsx)(a.f6,{colorMode:c,dayScheme:u,nightScheme:m,preventSSRMismatch:!0,children:(0,i.jsx)(s.sS,{children:t})})})})}try{c.displayName||(c.displayName="BaseProviders")}catch{}},80491:(e,t,n)=>{n.d(t,{P:()=>g});var i=n(85893),r=n(67294),a=n(88049),l=n(85529),s=n(70697),o=n(41905);let d={info:"",success:"Toast--success",error:"Toast--error"},c={info:(0,i.jsx)(l.InfoIcon,{}),success:(0,i.jsx)(l.CheckIcon,{}),error:(0,i.jsx)(l.StopIcon,{})},u=({message:e,timeToLive:t,icon:n,type:a="info",role:l="log"})=>{let[u,m]=r.useState(!0),{safeSetTimeout:f}=(0,s.Z)();return(0,r.useEffect)(()=>{t&&f(()=>m(!1),t-300)},[f,t]),(0,i.jsx)(o.h,{children:(0,i.jsx)("div",{className:"p-1 position-fixed bottom-0 left-0 mb-3 ml-3",children:(0,i.jsxs)("div",{className:`Toast ${d[a]} ${u?"Toast--animateIn":"Toast--animateOut"}`,id:"ui-app-toast","data-testid":`ui-app-toast-${a}`,role:l,children:[(0,i.jsx)("span",{className:"Toast-icon",children:n||c[a]}),(0,i.jsx)("span",{className:"Toast-content",children:e})]})})})};try{u.displayName||(u.displayName="Toast")}catch{}function m(){let{toasts:e,persistedToast:t}=(0,r.useContext)(a.Ww);return(0,i.jsxs)(i.Fragment,{children:[e.map((e,t)=>(0,i.jsx)(u,{message:e.message,icon:e.icon,timeToLive:a.hw,type:e.type,role:e.role},t)),t&&(0,i.jsx)(u,{message:t.message,icon:t.icon,type:t.type,role:t.role})]})}try{m.displayName||(m.displayName="Toasts")}catch{}var f=n(18448);function h({ssrError:e}){let{addToast:t}=(0,a.V6)(),n=f.t[e.textContent||""];return(0,r.useEffect)(()=>{n||t({type:"error",message:"SSR failed, see console for error details (Staff Only)"})},[]),null}try{h.displayName||(h.displayName="SSRErrorToast")}catch{}function g({ssrError:e}){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m,{}),e&&(0,i.jsx)(h,{ssrError:e})]})}try{g.displayName||(g.displayName="CommonElements")}catch{}},18:(e,t,n)=>{n.d(t,{DJ:()=>d,i$:()=>i,kb:()=>o});var i,r=n(85893),a=n(67294),l=n(71207),s=n(22877);!function(e){e.ServerRender="ServerRender",e.ClientHydrate="ClientHydrate",e.ClientRender="ClientRender"}(i||(i={}));let o=(0,a.createContext)("ClientRender");function d({wasServerRendered:e,children:t}){let[n,i]=(0,a.useState)(()=>l.W6?"ServerRender":e?"ClientHydrate":"ClientRender");return(0,s.g)(()=>{"ClientRender"!==n&&i("ClientRender")},[n]),(0,r.jsx)(o.Provider,{value:n,children:t})}try{o.displayName||(o.displayName="RenderPhaseContext")}catch{}try{d.displayName||(d.displayName="RenderPhaseProvider")}catch{}}}]);
//# sourceMappingURL=ui_packages_diff-file-header_diff-file-header_ts-ui_packages_diff-file-tree_diff-file-tree_ts-f395a8-30e75abfc183.js.map